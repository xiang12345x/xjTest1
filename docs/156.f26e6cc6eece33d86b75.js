"use strict";(self.webpackChunkmini_program=self.webpackChunkmini_program||[]).push([[156],{5329:(A,E,l)=>{l.d(E,{Dz:()=>f,Rt:()=>r});var g=l(7582),v=l(521),t=l(7716),z=l(2729),M=l(6182),C=l(946),m=l(8583),p=l(464);const y=["textEl"];function h(o,c){if(1&o&&t._UZ(0,"i",3),2&o){const n=t.oxw();t.Q6J("nzType",n.nzIcon)}}function O(o,c){if(1&o){const n=t.EpF();t.TgZ(0,"img",4),t.NdJ("error",function(e){return t.CHM(n),t.oxw().imgError(e)}),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("src",n.nzSrc,t.LSH),t.uIk("srcset",n.nzSrcSet,t.LSH)("alt",n.nzAlt)}}function x(o,c){if(1&o&&(t.TgZ(0,"span",5,6),t._uU(2),t.qZA()),2&o){const n=t.oxw();t.Q6J("ngStyle",n.textStyles),t.xp6(2),t.Oqu(n.nzText)}}let f=(()=>{class o{constructor(n,s,e,a){this.nzConfigService=n,this.elementRef=s,this.cdr=e,this.platform=a,this._nzModuleName="avatar",this.nzShape="circle",this.nzSize="default",this.nzGap=4,this.nzError=new t.vpe,this.hasText=!1,this.hasSrc=!0,this.hasIcon=!1,this.textStyles={},this.classMap={},this.customSize=null,this.el=this.elementRef.nativeElement,this.elementRef.nativeElement.classList.add("ant-avatar")}imgError(n){this.nzError.emit(n),n.defaultPrevented||(this.hasSrc=!1,this.hasIcon=!1,this.hasText=!1,this.nzIcon?this.hasIcon=!0:this.nzText&&(this.hasText=!0),this.cdr.detectChanges(),this.setSizeStyle(),this.notifyCalc())}ngOnChanges(){this.hasText=!this.nzSrc&&!!this.nzText,this.hasIcon=!this.nzSrc&&!!this.nzIcon,this.hasSrc=!!this.nzSrc,this.setSizeStyle(),this.notifyCalc()}calcStringSize(){if(!this.hasText)return;const n=this.textEl.nativeElement.offsetWidth,s=this.el.getBoundingClientRect().width,e=2*this.nzGap<s?2*this.nzGap:8;this.textStyles={transform:`scale(${s-e<n?(s-e)/n:1}) translateX(-50%)`},this.customSize&&Object.assign(this.textStyles,{lineHeight:this.customSize}),this.cdr.detectChanges()}notifyCalc(){this.platform.isBrowser&&setTimeout(()=>{this.calcStringSize()})}setSizeStyle(){this.customSize="number"==typeof this.nzSize?`${this.nzSize}px`:null,this.cdr.markForCheck()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(z.jY),t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(v.t4))},o.\u0275cmp=t.Xpm({type:o,selectors:[["nz-avatar"]],viewQuery:function(n,s){if(1&n&&t.Gf(y,5),2&n){let e;t.iGM(e=t.CRH())&&(s.textEl=e.first)}},hostVars:20,hostBindings:function(n,s){2&n&&(t.Udp("width",s.customSize)("height",s.customSize)("line-height",s.customSize)("font-size",s.hasIcon&&s.customSize?s.nzSize/2:null,"px"),t.ekj("ant-avatar-lg","large"===s.nzSize)("ant-avatar-sm","small"===s.nzSize)("ant-avatar-square","square"===s.nzShape)("ant-avatar-circle","circle"===s.nzShape)("ant-avatar-icon",s.nzIcon)("ant-avatar-image",s.hasSrc))},inputs:{nzShape:"nzShape",nzSize:"nzSize",nzGap:"nzGap",nzText:"nzText",nzSrc:"nzSrc",nzSrcSet:"nzSrcSet",nzAlt:"nzAlt",nzIcon:"nzIcon"},outputs:{nzError:"nzError"},exportAs:["nzAvatar"],features:[t.TTD],decls:3,vars:3,consts:[["nz-icon","",3,"nzType",4,"ngIf"],[3,"src","error",4,"ngIf"],["class","ant-avatar-string",3,"ngStyle",4,"ngIf"],["nz-icon","",3,"nzType"],[3,"src","error"],[1,"ant-avatar-string",3,"ngStyle"],["textEl",""]],template:function(n,s){1&n&&(t.YNc(0,h,1,1,"i",0),t.YNc(1,O,1,3,"img",1),t.YNc(2,x,3,2,"span",2)),2&n&&(t.Q6J("ngIf",s.nzIcon&&s.hasIcon),t.xp6(1),t.Q6J("ngIf",s.nzSrc&&s.hasSrc),t.xp6(1),t.Q6J("ngIf",s.nzText&&s.hasText))},directives:[m.O5,p.Ls,m.PC],encapsulation:2,changeDetection:0}),(0,g.gn)([(0,z.oS)()],o.prototype,"nzShape",void 0),(0,g.gn)([(0,z.oS)()],o.prototype,"nzSize",void 0),(0,g.gn)([(0,z.oS)(),(0,M.Rn)()],o.prototype,"nzGap",void 0),o})(),r=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[C.vT,m.ez,p.PV,v.ud]]}),o})()},6704:(A,E,l)=>{l.d(E,{t3:()=>x,Jb:()=>T,SK:()=>O});var g=l(946),v=l(5072),t=l(521),z=l(2298),M=l(9765),C=l(6782),m=l(6102),p=l(6182),y=l(8583),h=l(7716);let O=(()=>{class u{constructor(i,r,o,c,n,s,e){this.elementRef=i,this.renderer=r,this.mediaMatcher=o,this.ngZone=c,this.platform=n,this.breakpointService=s,this.directionality=e,this.nzAlign=null,this.nzJustify=null,this.nzGutter=null,this.actualGutter$=new z.t(1),this.dir="ltr",this.destroy$=new M.xQ,this.elementRef.nativeElement.classList.add("ant-row")}getGutter(){const i=[null,null],r=this.nzGutter||0;return(Array.isArray(r)?r:[r,null]).forEach((c,n)=>{"object"==typeof c&&null!==c?(i[n]=null,Object.keys(m.WV).map(s=>{const e=s;this.mediaMatcher.matchMedia(m.WV[e]).matches&&c[e]&&(i[n]=c[e])})):i[n]=Number(c)||null}),i}setGutterStyle(){const[i,r]=this.getGutter();this.actualGutter$.next([i,r]);const o=(c,n)=>{null!==n&&this.renderer.setStyle(this.elementRef.nativeElement,c,`-${n/2}px`)};o("margin-left",i),o("margin-right",i),o("margin-top",r),o("margin-bottom",r)}ngOnInit(){var i;this.dir=this.directionality.value,null===(i=this.directionality.change)||void 0===i||i.pipe((0,C.R)(this.destroy$)).subscribe(r=>{this.dir=r}),this.setGutterStyle()}ngOnChanges(i){i.nzGutter&&this.setGutterStyle()}ngAfterViewInit(){this.platform.isBrowser&&this.breakpointService.subscribe(m.WV).pipe((0,C.R)(this.destroy$)).subscribe(()=>{this.setGutterStyle()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return u.\u0275fac=function(i){return new(i||u)(h.Y36(h.SBq),h.Y36(h.Qsj),h.Y36(v.vx),h.Y36(h.R0b),h.Y36(t.t4),h.Y36(m.r3),h.Y36(g.Is,8))},u.\u0275dir=h.lG2({type:u,selectors:[["","nz-row",""],["nz-row"],["nz-form-item"]],hostVars:18,hostBindings:function(i,r){2&i&&h.ekj("ant-row-top","top"===r.nzAlign)("ant-row-middle","middle"===r.nzAlign)("ant-row-bottom","bottom"===r.nzAlign)("ant-row-start","start"===r.nzJustify)("ant-row-end","end"===r.nzJustify)("ant-row-center","center"===r.nzJustify)("ant-row-space-around","space-around"===r.nzJustify)("ant-row-space-between","space-between"===r.nzJustify)("ant-row-rtl","rtl"===r.dir)},inputs:{nzAlign:"nzAlign",nzJustify:"nzJustify",nzGutter:"nzGutter"},exportAs:["nzRow"],features:[h.TTD]}),u})(),x=(()=>{class u{constructor(i,r,o,c){this.elementRef=i,this.nzRowDirective=r,this.renderer=o,this.directionality=c,this.classMap={},this.destroy$=new M.xQ,this.hostFlexStyle=null,this.dir="ltr",this.nzFlex=null,this.nzSpan=null,this.nzOrder=null,this.nzOffset=null,this.nzPush=null,this.nzPull=null,this.nzXs=null,this.nzSm=null,this.nzMd=null,this.nzLg=null,this.nzXl=null,this.nzXXl=null}setHostClassMap(){const i=Object.assign({"ant-col":!0,[`ant-col-${this.nzSpan}`]:(0,p.DX)(this.nzSpan),[`ant-col-order-${this.nzOrder}`]:(0,p.DX)(this.nzOrder),[`ant-col-offset-${this.nzOffset}`]:(0,p.DX)(this.nzOffset),[`ant-col-pull-${this.nzPull}`]:(0,p.DX)(this.nzPull),[`ant-col-push-${this.nzPush}`]:(0,p.DX)(this.nzPush),"ant-col-rtl":"rtl"===this.dir},this.generateClass());for(const r in this.classMap)this.classMap.hasOwnProperty(r)&&this.renderer.removeClass(this.elementRef.nativeElement,r);this.classMap=Object.assign({},i);for(const r in this.classMap)this.classMap.hasOwnProperty(r)&&this.classMap[r]&&this.renderer.addClass(this.elementRef.nativeElement,r)}setHostFlexStyle(){this.hostFlexStyle=this.parseFlex(this.nzFlex)}parseFlex(i){return"number"==typeof i?`${i} ${i} auto`:"string"==typeof i&&/^\d+(\.\d+)?(px|em|rem|%)$/.test(i)?`0 0 ${i}`:i}generateClass(){const r={};return["nzXs","nzSm","nzMd","nzLg","nzXl","nzXXl"].forEach(o=>{const c=o.replace("nz","").toLowerCase();if((0,p.DX)(this[o]))if("number"==typeof this[o]||"string"==typeof this[o])r[`ant-col-${c}-${this[o]}`]=!0;else{const n=this[o];["span","pull","push","offset","order"].forEach(e=>{r[`ant-col-${c}${"span"===e?"-":`-${e}-`}${n[e]}`]=n&&(0,p.DX)(n[e])})}}),r}ngOnInit(){this.dir=this.directionality.value,this.directionality.change.pipe((0,C.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.setHostClassMap()}),this.setHostClassMap(),this.setHostFlexStyle()}ngOnChanges(i){this.setHostClassMap();const{nzFlex:r}=i;r&&this.setHostFlexStyle()}ngAfterViewInit(){this.nzRowDirective&&this.nzRowDirective.actualGutter$.pipe((0,C.R)(this.destroy$)).subscribe(([i,r])=>{const o=(c,n)=>{null!==n&&this.renderer.setStyle(this.elementRef.nativeElement,c,n/2+"px")};o("padding-left",i),o("padding-right",i),o("padding-top",r),o("padding-bottom",r)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return u.\u0275fac=function(i){return new(i||u)(h.Y36(h.SBq),h.Y36(O,9),h.Y36(h.Qsj),h.Y36(g.Is,8))},u.\u0275dir=h.lG2({type:u,selectors:[["","nz-col",""],["nz-col"],["nz-form-control"],["nz-form-label"]],hostVars:2,hostBindings:function(i,r){2&i&&h.Udp("flex",r.hostFlexStyle)},inputs:{nzFlex:"nzFlex",nzSpan:"nzSpan",nzOrder:"nzOrder",nzOffset:"nzOffset",nzPush:"nzPush",nzPull:"nzPull",nzXs:"nzXs",nzSm:"nzSm",nzMd:"nzMd",nzLg:"nzLg",nzXl:"nzXl",nzXXl:"nzXXl"},exportAs:["nzCol"],features:[h.TTD]}),u})(),T=(()=>{class u{}return u.\u0275fac=function(i){return new(i||u)},u.\u0275mod=h.oAB({type:u}),u.\u0275inj=h.cJS({imports:[[g.vT,y.ez,v.xu,t.ud]]}),u})()},169:(A,E,l)=>{l.r(E),l.d(E,{BookModule:()=>c});var g=l(8583),v=l(8239),t=l(7716),z=l(3197),M=l(4453),C=l(9374),m=l(4514),p=l(1241),y=l(665),h=l(7018),O=l(1594);function x(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nz-list-item",17),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().selectBook(_)}),t._UZ(1,"nz-list-item-meta",18),t.qZA()}if(2&n){const e=s.$implicit;t.xp6(1),t.Q6J("nzTitle",e.title+"(\u70b9\u51fb\u4e66\u540d\uff0c\u9690\u85cf/\u663e\u793a\u76ee\u5f55)")("nzAvatar",e.cover)}}function T(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"nz-list-item",21),t.NdJ("click",function(){const _=t.CHM(e).index;return t.oxw(2).jumpToChapter(_)}),t.TgZ(1,"div",22),t._uU(2),t.qZA(),t.qZA()}if(2&n){const e=s.$implicit,a=s.index,d=t.oxw(2);t.ekj("bg-blue-100",a===d.currentChapterIndex),t.xp6(2),t.Oqu(e.title)}}function u(n,s){if(1&n&&(t.TgZ(0,"div",19),t.TgZ(1,"nz-list"),t.YNc(2,T,3,3,"nz-list-item",20),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.chapters)}}let f=(()=>{class n{constructor(){this.books=[{title:"\u5723\u589f",content:"",cover:"assets/books/\u5723\u589f.jpg",path:"assets/books/\u5723\u589f.txt"}],this.selectedBook=null,this.bgColor="#ffffff",this.fontSize=16,this.chapters=[],this.currentChapterIndex=0,this.loading=!1,this.loadingText="\u4e66\u7c4d\u5185\u5bb9\u52a0\u8f7d\u4e2d...",this.sidebarVisible=!0}ngOnInit(){this.loadLocalBooks()}loadLocalBooks(){var e=this;return(0,v.Z)(function*(){e.loading=!0;try{const d=yield(yield fetch("assets/books/book-list.json")).json();e.books=yield Promise.all(d.map(function(){var _=(0,v.Z)(function*(P){const S=yield e.loadBookContent(P.path);return{title:P.title,content:S,cover:P.cover||"assets/background/7.jpeg"}});return function(P){return _.apply(this,arguments)}}())),e.selectedBook=e.books[0],e.selectedBook&&e.jumpToChapter(0)}catch(a){console.error("\u52a0\u8f7d\u4e66\u7c4d\u5931\u8d25:",a)}e.loading=!1})()}loadBookContent(e){var a=this;return(0,v.Z)(function*(){const _=yield(yield fetch(`assets/books/${e}`)).text();return a.parseChapters(_),_})()}parseChapters(e){this.chapters=[];const a=/^(\u7b2c[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u96f6]+\u7ae0|\d+\.\d+|\d+\u3001)[^\n]+/gm;let d,_=0;for(;null!==(d=a.exec(e));)this.chapters.push({title:d[0].trim(),position:d.index,content:""}),_=d.index+d[0].length}jumpToChapter(e){this.currentChapterIndex=e,!this.chapters[e].content&&this.selectedBook&&(this.chapters[e].content=this.getChapterContent(e))}getChapterContent(e){return!this.selectedBook||e>=this.chapters.length-1?this.chapters[e].content||"":this.selectedBook.content.substring(this.chapters[e].position,this.chapters[e+1].position)}prevChapter(){this.currentChapterIndex>0&&this.jumpToChapter(this.currentChapterIndex-1)}nextChapter(){if(this.currentChapterIndex<this.chapters.length-1){this.jumpToChapter(this.currentChapterIndex+1);const e=document.querySelector(".right nz-card");e&&(e.scrollTop=0)}}toggleSidebar(){this.sidebarVisible=!this.sidebarVisible}selectBook(e){this.selectedBook=this.selectedBook!==e?e:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["xj-book"]],decls:26,vars:15,consts:[[1,"content"],[1,"left"],[1,"text-xl","font-bold","mb-4","text-gray-800"],["class","hover:bg-gray-100 cursor-pointer rounded-md mb-2",3,"click",4,"ngFor","ngForOf"],[1,"text-xl","font-bold","mb-4"],["class","chapter-list mb-4",4,"ngIf"],[1,"right"],[1,"book-title"],["nz-button","","nzType","default",2,"margin-right","10px",3,"click"],[1,"ml-2","text-gray-700"],[1,"w-48",3,"ngModel","nzMin","nzMax","ngModelChange"],[1,"shadow-lg","overflow-y-auto"],[1,"prose","max-w-none"],[1,"whitespace-pre-wrap","font-sans"],[1,"flex","justify-between","mt-4"],["nz-button","",3,"disabled","click"],[3,"loading","loadingText"],[1,"hover:bg-gray-100","cursor-pointer","rounded-md","mb-2",3,"click"],[3,"nzTitle","nzAvatar"],[1,"chapter-list","mb-4"],["class","hover:bg-gray-100 cursor-pointer py-2 px-4 border-b",3,"bg-blue-100","click",4,"ngFor","ngForOf"],[1,"hover:bg-gray-100","cursor-pointer","py-2","px-4","border-b",3,"click"],[1,"truncate"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h2",2),t._uU(3,"\u4e66\u67b6"),t.qZA(),t.TgZ(4,"nz-list"),t.YNc(5,x,2,2,"nz-list-item",3),t.qZA(),t.TgZ(6,"h2",4),t._uU(7,"\u76ee\u5f55"),t.qZA(),t.YNc(8,u,3,1,"div",5),t.qZA(),t.TgZ(9,"div",6),t.TgZ(10,"div",7),t.TgZ(11,"button",8),t.NdJ("click",function(){return a.toggleSidebar()}),t._uU(12),t.qZA(),t.TgZ(13,"label",9),t._uU(14,"\u5b57\u4f53\u5927\u5c0f:"),t.qZA(),t.TgZ(15,"nz-slider",10),t.NdJ("ngModelChange",function(_){return a.fontSize=_}),t.qZA(),t.qZA(),t.TgZ(16,"nz-card",11),t.TgZ(17,"div",12),t.TgZ(18,"pre",13),t._uU(19),t.qZA(),t.qZA(),t.TgZ(20,"div",14),t.TgZ(21,"button",15),t.NdJ("click",function(){return a.prevChapter()}),t._uU(22," \u4e0a\u4e00\u7ae0 "),t.qZA(),t.TgZ(23,"button",15),t.NdJ("click",function(){return a.nextChapter()}),t._uU(24," \u4e0b\u4e00\u7ae0 "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(25,"xj-loading",16)),2&e&&(t.xp6(1),t.ekj("hidden",!a.sidebarVisible),t.xp6(4),t.Q6J("ngForOf",a.books),t.xp6(3),t.Q6J("ngIf",a.selectedBook),t.xp6(4),t.hij(" ",a.sidebarVisible?"\u9690\u85cf\u4e66\u67b6":"\u663e\u793a\u4e66\u67b6"," "),t.xp6(3),t.Q6J("ngModel",a.fontSize)("nzMin",12)("nzMax",32),t.xp6(2),t.Udp("font-size",a.fontSize,"px"),t.xp6(2),t.hij("    ",null==a.chapters[a.currentChapterIndex]?null:a.chapters[a.currentChapterIndex].content,"\n                "),t.xp6(2),t.Q6J("disabled",a.currentChapterIndex<=0),t.xp6(2),t.Q6J("disabled",a.currentChapterIndex>=a.chapters.length-1),t.xp6(2),t.Q6J("loading",a.loading)("loadingText",a.loadingText))},directives:[z.n_,g.sg,g.O5,M.ix,C.dQ,m.w,p.jS,y.JJ,y.On,h.bd,O.N,z.AA,z.yi],styles:["@media (max-width: 768px){.content[_ngcontent-%COMP%]{width:100%;height:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{height:150px;transition:all .3s;z-index:99}.content[_ngcontent-%COMP%]   .left.hidden[_ngcontent-%COMP%]{height:0;overflow:hidden;opacity:0}.content[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .chapter-list[_ngcontent-%COMP%]{height:550px;overflow-y:auto;background-color:#fff}.content[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{flex:1;overflow:hidden}.content[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   nz-card[_ngcontent-%COMP%]{height:450px;overflow-y:auto}}@media (min-width: 769px){.content[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 126px);overflow:hidden}.content[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:300px;height:100%;overflow-y:auto;padding:16px}.content[_ngcontent-%COMP%]   .left.hidden[_ngcontent-%COMP%]{width:0;overflow:hidden;opacity:0}.content[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .chapter-list[_ngcontent-%COMP%]{height:500px;overflow-y:auto}.content[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{flex:1;height:100%;overflow:hidden;display:flex;flex-direction:column;padding:10px}.content[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .book-title[_ngcontent-%COMP%]{padding:0 16px}.content[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   nz-card[_ngcontent-%COMP%]{flex:1;overflow-y:auto;margin:16px}.content[_ngcontent-%COMP%]   .prose[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;line-height:1.6}.content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{font-family:inherit;white-space:pre-wrap}}"]}),n})();var i=l(4655),r=l(9017);const o=[{path:"",component:f}];let c=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.ez,i.Bz.forChild(o),y.u5,z.Ph,h.vh,p.N3,M.sL,r.I]]}),n})()}}]);