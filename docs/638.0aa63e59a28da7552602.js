"use strict";(self.webpackChunkmini_program=self.webpackChunkmini_program||[]).push([[638],{2638:(E,f,r)=>{r.r(f),r.d(f,{AccountModule:()=>x});var p=r(8583),t=r(7716),A=r(1841);let F=(()=>{class o{constructor(e){this.http=e}save(e){return this.http.post("http://localhost:3000/api/account/save",e)}getList(e){let n="http://localhost:3000/api/account/getList";if((null==e?void 0:e.startDate)||(null==e?void 0:e.endDate)){const i=new URLSearchParams;e.startDate&&i.append("startDate",e.startDate),e.endDate&&i.append("endDate",e.endDate),n+="?"+i.toString()}return this.http.get(n)}delete(e){return this.http.delete(`http://localhost:3000/api/account/delete/${e}`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(A.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var b=r(7018),l=r(665),c=r(5887),M=r(6704),y=r(7582),v=r(946),m=r(6461),D=r(9765),C=r(6782),h=r(6182),N=r(464),_=r(9238);const S=["inputElement"];let P=(()=>{class o{constructor(e,n,i,s){this.elementRef=e,this.cdr=n,this.focusMonitor=i,this.directionality=s,this.destroy$=new D.xQ,this.isFocused=!1,this.disabledUp=!1,this.disabledDown=!1,this.dir="ltr",this.onChange=()=>{},this.onTouched=()=>{},this.nzBlur=new t.vpe,this.nzFocus=new t.vpe,this.nzSize="default",this.nzMin=-1/0,this.nzMax=1/0,this.nzParser=u=>u.trim().replace(/\u3002/g,".").replace(/[^\w\.-]+/g,""),this.nzPrecisionMode="toFixed",this.nzPlaceHolder="",this.nzStep=1,this.nzInputMode="decimal",this.nzId=null,this.nzDisabled=!1,this.nzAutoFocus=!1,this.nzFormatter=u=>u,this.elementRef.nativeElement.classList.add("ant-input-number")}onModelChange(e){this.parsedValue=this.nzParser(e),this.inputElement.nativeElement.value=`${this.parsedValue}`;const n=this.getCurrentValidValue(this.parsedValue);this.setValue(n)}getCurrentValidValue(e){let n=e;return n=""===n?"":this.isNotCompleteNumber(n)?this.value:`${this.getValidValue(n)}`,this.toNumber(n)}isNotCompleteNumber(e){return isNaN(e)||""===e||null===e||!(!e||e.toString().indexOf(".")!==e.toString().length-1)}getValidValue(e){let n=parseFloat(e);return isNaN(n)?e:(n<this.nzMin&&(n=this.nzMin),n>this.nzMax&&(n=this.nzMax),n)}toNumber(e){if(this.isNotCompleteNumber(e))return e;const n=String(e);if(n.indexOf(".")>=0&&(0,h.DX)(this.nzPrecision)){if("function"==typeof this.nzPrecisionMode)return this.nzPrecisionMode(e,this.nzPrecision);if("cut"===this.nzPrecisionMode){const i=n.split(".");return i[1]=i[1].slice(0,this.nzPrecision),Number(i.join("."))}return Number(Number(e).toFixed(this.nzPrecision))}return Number(e)}getRatio(e){let n=1;return e.metaKey||e.ctrlKey?n=.1:e.shiftKey&&(n=10),n}down(e,n){this.isFocused||this.focus(),this.step("down",e,n)}up(e,n){this.isFocused||this.focus(),this.step("up",e,n)}getPrecision(e){const n=e.toString();if(n.indexOf("e-")>=0)return parseInt(n.slice(n.indexOf("e-")+2),10);let i=0;return n.indexOf(".")>=0&&(i=n.length-n.indexOf(".")-1),i}getMaxPrecision(e,n){if((0,h.DX)(this.nzPrecision))return this.nzPrecision;const i=this.getPrecision(n),s=this.getPrecision(this.nzStep),u=this.getPrecision(e);return e?Math.max(u,i+s):i+s}getPrecisionFactor(e,n){const i=this.getMaxPrecision(e,n);return Math.pow(10,i)}upStep(e,n){const i=this.getPrecisionFactor(e,n),s=Math.abs(this.getMaxPrecision(e,n));let u;return u="number"==typeof e?((i*e+i*this.nzStep*n)/i).toFixed(s):this.nzMin===-1/0?this.nzStep:this.nzMin,this.toNumber(u)}downStep(e,n){const i=this.getPrecisionFactor(e,n),s=Math.abs(this.getMaxPrecision(e,n));let u;return u="number"==typeof e?((i*e-i*this.nzStep*n)/i).toFixed(s):this.nzMin===-1/0?-this.nzStep:this.nzMin,this.toNumber(u)}step(e,n,i=1){if(this.stop(),n.preventDefault(),this.nzDisabled)return;const s=this.getCurrentValidValue(this.parsedValue)||0;let u=0;"up"===e?u=this.upStep(s,i):"down"===e&&(u=this.downStep(s,i));const L=u>this.nzMax||u<this.nzMin;u>this.nzMax?u=this.nzMax:u<this.nzMin&&(u=this.nzMin),this.setValue(u),this.updateDisplayValue(u),this.isFocused=!0,!L&&(this.autoStepTimer=setTimeout(()=>{this[e](n,i)},300))}stop(){this.autoStepTimer&&clearTimeout(this.autoStepTimer)}setValue(e){if(`${this.value}`!=`${e}`&&this.onChange(e),this.value=e,this.parsedValue=e,this.disabledUp=this.disabledDown=!1,e||0===e){const n=Number(e);n>=this.nzMax&&(this.disabledUp=!0),n<=this.nzMin&&(this.disabledDown=!0)}}updateDisplayValue(e){const n=(0,h.DX)(this.nzFormatter(e))?this.nzFormatter(e):"";this.displayValue=n,this.inputElement.nativeElement.value=`${n}`}onKeyDown(e){if(e.keyCode===m.LH){const n=this.getRatio(e);this.up(e,n),this.stop()}else if(e.keyCode===m.JH){const n=this.getRatio(e);this.down(e,n),this.stop()}else e.keyCode===m.K5&&this.updateDisplayValue(this.value)}writeValue(e){this.value=e,this.setValue(e),this.updateDisplayValue(e),this.cdr.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.nzDisabled=e,this.cdr.markForCheck()}focus(){this.focusMonitor.focusVia(this.inputElement,"keyboard")}blur(){this.inputElement.nativeElement.blur()}ngOnInit(){var e;this.focusMonitor.monitor(this.elementRef,!0).pipe((0,C.R)(this.destroy$)).subscribe(n=>{n?(this.isFocused=!0,this.nzFocus.emit()):(this.isFocused=!1,this.updateDisplayValue(this.value),this.nzBlur.emit(),Promise.resolve().then(()=>this.onTouched()))}),this.dir=this.directionality.value,null===(e=this.directionality.change)||void 0===e||e.pipe((0,C.R)(this.destroy$)).subscribe(n=>{this.dir=n})}ngOnChanges(e){if(e.nzFormatter&&!e.nzFormatter.isFirstChange()){const n=this.getCurrentValidValue(this.parsedValue);this.setValue(n),this.updateDisplayValue(n)}}ngAfterViewInit(){this.nzAutoFocus&&this.focus()}ngOnDestroy(){this.focusMonitor.stopMonitoring(this.elementRef),this.destroy$.next(),this.destroy$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(_.tE),t.Y36(v.Is,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["nz-input-number"]],viewQuery:function(e,n){if(1&e&&t.Gf(S,7),2&e){let i;t.iGM(i=t.CRH())&&(n.inputElement=i.first)}},hostVars:10,hostBindings:function(e,n){2&e&&t.ekj("ant-input-number-focused",n.isFocused)("ant-input-number-lg","large"===n.nzSize)("ant-input-number-sm","small"===n.nzSize)("ant-input-number-disabled",n.nzDisabled)("ant-input-number-rtl","rtl"===n.dir)},inputs:{nzSize:"nzSize",nzMin:"nzMin",nzMax:"nzMax",nzParser:"nzParser",nzPrecisionMode:"nzPrecisionMode",nzPlaceHolder:"nzPlaceHolder",nzStep:"nzStep",nzInputMode:"nzInputMode",nzId:"nzId",nzDisabled:"nzDisabled",nzAutoFocus:"nzAutoFocus",nzFormatter:"nzFormatter",nzPrecision:"nzPrecision"},outputs:{nzBlur:"nzBlur",nzFocus:"nzFocus"},exportAs:["nzInputNumber"],features:[t._Bn([{provide:l.JU,useExisting:(0,t.Gpc)(()=>o),multi:!0}]),t.TTD],decls:8,vars:13,consts:[[1,"ant-input-number-handler-wrap"],["unselectable","unselectable",1,"ant-input-number-handler","ant-input-number-handler-up",3,"mousedown","mouseup","mouseleave"],["nz-icon","","nzType","up",1,"ant-input-number-handler-up-inner"],["unselectable","unselectable",1,"ant-input-number-handler","ant-input-number-handler-down",3,"mousedown","mouseup","mouseleave"],["nz-icon","","nzType","down",1,"ant-input-number-handler-down-inner"],[1,"ant-input-number-input-wrap"],["autocomplete","off",1,"ant-input-number-input",3,"disabled","placeholder","ngModel","keydown","keyup","ngModelChange"],["inputElement",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"span",1),t.NdJ("mousedown",function(s){return n.up(s)})("mouseup",function(){return n.stop()})("mouseleave",function(){return n.stop()}),t._UZ(2,"i",2),t.qZA(),t.TgZ(3,"span",3),t.NdJ("mousedown",function(s){return n.down(s)})("mouseup",function(){return n.stop()})("mouseleave",function(){return n.stop()}),t._UZ(4,"i",4),t.qZA(),t.qZA(),t.TgZ(5,"div",5),t.TgZ(6,"input",6,7),t.NdJ("keydown",function(s){return n.onKeyDown(s)})("keyup",function(){return n.stop()})("ngModelChange",function(s){return n.onModelChange(s)}),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.ekj("ant-input-number-handler-up-disabled",n.disabledUp),t.xp6(2),t.ekj("ant-input-number-handler-down-disabled",n.disabledDown),t.xp6(3),t.Q6J("disabled",n.nzDisabled)("placeholder",n.nzPlaceHolder)("ngModel",n.displayValue),t.uIk("id",n.nzId)("autofocus",n.nzAutoFocus?"autofocus":null)("min",n.nzMin)("max",n.nzMax)("step",n.nzStep)("inputmode",n.nzInputMode))},directives:[N.Ls,l.Fj,l.JJ,l.On],encapsulation:2,changeDetection:0}),(0,y.gn)([(0,h.yF)()],o.prototype,"nzDisabled",void 0),(0,y.gn)([(0,h.yF)()],o.prototype,"nzAutoFocus",void 0),o})(),V=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[v.vT,p.ez,l.u5,N.PV]]}),o})();var z=r(269),T=r(7674),Z=r(4453),I=r(9374),w=r(4514),g=r(7966),d=r(3197);function J(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"nz-list-item"),t._UZ(1,"nz-list-item-meta",19),t.TgZ(2,"ul",20),t.TgZ(3,"nz-list-item-action"),t.TgZ(4,"button",21),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().deleteRecord(s)}),t._uU(5," \u5220\u9664 "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=a.$implicit;t.xp6(1),t.Q6J("nzTitle",e.amount+"\u5143")("nzDescription",e.category+" - "+e.description+" - "+e.date)}}let R=(()=>{class o{constructor(e,n){this.service=e,this.datePipe=n,this.records=[],this.newRecord={amount:0,category:"food",description:""},this.date=null}ngOnInit(){this.getList()}dateChange(e){const n={startDate:this.datePipe.transform(e[0],"yyyy-MM-dd"),endDate:this.datePipe.transform(e[1],"yyyy-MM-dd")};this.getList(n)}formatDate(e){return this.datePipe.transform(e,"yyyy-MM-dd HH:mm")||""}getList(e){this.service.getList(e).subscribe(n=>{this.records=n.data.map(i=>Object.assign(Object.assign({},i),{date:this.formatDate(new Date(i.date))}))})}addRecord(){this.service.save(Object.assign(Object.assign({},this.newRecord),{date:this.formatDate(new Date)})).subscribe(e=>{e&&(this.records.unshift(Object.assign(Object.assign({},this.newRecord),{date:this.formatDate(new Date)})),this.newRecord={amount:0,category:"food",description:""})})}deleteRecord(e){this.service.delete(e._id).subscribe(n=>{this.records=this.records.filter(i=>i!==e)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(F),t.Y36(p.uU))},o.\u0275cmp=t.Xpm({type:o,selectors:[["xj-account"]],features:[t._Bn([p.uU])],decls:32,vars:11,consts:[[1,"content"],["nzTitle","\u8bb0\u8d26\u672c",3,"nzBordered","nzHoverable"],["nz-form","",3,"ngSubmit"],["nzFor","amount","nzRequired",""],["id","amount","name","amount","nzRequired","","nzPrefix","\xa5",3,"ngModel","nzMin","nzStep","ngModelChange"],["nzFor","category","nzRequired",""],["id","category","name","category","nzRequired","",3,"ngModel","ngModelChange"],["nzValue","food","nzLabel","\u9910\u996e"],["nzValue","transport","nzLabel","\u4ea4\u901a"],["nzValue","shopping","nzLabel","\u8d2d\u7269"],["nzValue","other","nzLabel","\u5176\u4ed6"],["nzFor","description"],["nz-input","","type","text","id","description","name","description",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","type","submit"],["nzTitle","\u8bb0\u5f55\u5217\u8868",3,"nzBordered","nzHoverable"],["nzSize","small",2,"width","200px",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","small",2,"margin-left","10px",3,"click"],[2,"overflow","auto","height","300px"],[4,"ngFor","ngForOf"],[3,"nzTitle","nzDescription"],["nz-list-item-actions",""],["nz-button","","nzType","primary","nzSize","small",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"nz-card",1),t.TgZ(2,"form",2),t.NdJ("ngSubmit",function(){return n.addRecord()}),t.TgZ(3,"nz-form-item"),t.TgZ(4,"nz-form-label",3),t._uU(5,"\u91d1\u989d"),t.qZA(),t.TgZ(6,"nz-form-control"),t.TgZ(7,"nz-input-number",4),t.NdJ("ngModelChange",function(s){return n.newRecord.amount=s}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"nz-form-item"),t.TgZ(9,"nz-form-label",5),t._uU(10,"\u7c7b\u522b"),t.qZA(),t.TgZ(11,"nz-form-control"),t.TgZ(12,"nz-select",6),t.NdJ("ngModelChange",function(s){return n.newRecord.category=s}),t._UZ(13,"nz-option",7),t._UZ(14,"nz-option",8),t._UZ(15,"nz-option",9),t._UZ(16,"nz-option",10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"nz-form-item"),t.TgZ(18,"nz-form-label",11),t._uU(19,"\u63cf\u8ff0"),t.qZA(),t.TgZ(20,"nz-form-control"),t.TgZ(21,"input",12),t.NdJ("ngModelChange",function(s){return n.newRecord.description=s}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"button",13),t._uU(23,"\u6dfb\u52a0\u8bb0\u5f55"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"nz-card",14),t.TgZ(25,"div"),t.TgZ(26,"nz-range-picker",15),t.NdJ("ngModelChange",function(s){return n.date=s}),t.qZA(),t.TgZ(27,"button",16),t.NdJ("click",function(){return n.dateChange(n.date)}),t._uU(28," \u7b5b\u9009 "),t.qZA(),t.qZA(),t.TgZ(29,"div",17),t.TgZ(30,"nz-list"),t.YNc(31,J,6,2,"nz-list-item",18),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("nzBordered",!0)("nzHoverable",!0),t.xp6(6),t.Q6J("ngModel",n.newRecord.amount)("nzMin",0)("nzStep",1),t.xp6(5),t.Q6J("ngModel",n.newRecord.category),t.xp6(9),t.Q6J("ngModel",n.newRecord.description),t.xp6(3),t.Q6J("nzBordered",!0)("nzHoverable",!0),t.xp6(2),t.Q6J("ngModel",n.date),t.xp6(5),t.Q6J("ngForOf",n.records))},directives:[b.bd,l._Y,l.JL,l.F,c.Lr,M.SK,c.Nx,M.t3,c.iK,c.Fd,P,l.JJ,l.On,z.Vq,z.Ip,T.Zp,l.Fj,Z.ix,I.dQ,w.w,g.uw,g.wS,d.n_,p.sg,d.AA,d.yi,d.nk,d.KC],styles:[".content[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-rows:1fr 1fr 1fr;grid-gap:10px}"]}),o})();var B=r(4655),O=r(3385);const U=[{path:"",component:R}];let x=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,B.Bz.forChild(U),l.u5,c.U5,b.vh,z.LV,V,O.S,d.Ph,T.o7,Z.sL,g.Hb]]}),o})()}}]);