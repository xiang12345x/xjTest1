"use strict";(self.webpackChunkmini_program=self.webpackChunkmini_program||[]).push([[41],{5041:(j,f,r)=>{r.r(f),r.d(f,{LoginModule:()=>S});var u=r(8583),a=r(665),n=r(7716),T=r(9075),z=r(8058),_=r(4655),C=r(1841);let Z=(()=>{class o{constructor(t){this.http=t}login(t){return this.http.post("http://localhost:3000/api/login",t)}register(t){return this.http.post("http://localhost:3000/api/register",t)}}return o.\u0275fac=function(t){return new(t||o)(n.LFG(C.eN))},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var c=r(5887),h=r(6704),p=r(7674),v=r(4514),x=r(4453),b=r(9374);function y(o,i){if(1&o&&(n.TgZ(0,"div",1),n._UZ(1,"div",2),n.TgZ(2,"span",3),n._uU(3),n.qZA(),n.qZA()),2&o){const t=n.oxw();n.xp6(3),n.Oqu(t.loadingText)}}let F=(()=>{class o{constructor(){this.loading=!1,this.loadingText="\u62fc\u547d\u52a0\u8f7d\u4e2d..."}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=n.Xpm({type:o,selectors:[["xj-loading"]],inputs:{loading:"loading",loadingText:"loadingText"},decls:1,vars:1,consts:[["class","loading-box",4,"ngIf"],[1,"loading-box"],[1,"loading-spinner"],[1,"loading-text"]],template:function(t,e){1&t&&n.YNc(0,y,4,1,"div",0),2&t&&n.Q6J("ngIf",e.loading)},directives:[u.O5],styles:[".loading-box[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;position:fixed;top:0;z-index:9999;background-color:#00000080}.loading-box[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:60px;height:60px;font-size:large;border:5px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#6973b8;animation:spin 1s ease-in-out infinite}.loading-box[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:#fff;margin-top:10px;font-size:18px}@keyframes spin{to{transform:rotate(360deg)}}"]}),o})();var m=r(8542);function L(o,i){1&o&&(n.ynx(0),n._uU(1," \u8bf7\u8f93\u5165\u7528\u6237\u540d "),n.BQk())}function I(o,i){1&o&&n.YNc(0,L,2,0,"ng-container",17),2&o&&n.Q6J("ngIf",i.$implicit.hasError("required"))}function A(o,i){1&o&&(n.ynx(0),n._uU(1," \u8bf7\u8f93\u5165\u5bc6\u7801 "),n.BQk())}function M(o,i){1&o&&n.YNc(0,A,2,0,"ng-container",17),2&o&&n.Q6J("ngIf",i.$implicit.hasError("required"))}function B(o,i){1&o&&(n.ynx(0),n._uU(1," \u8bf7\u8f93\u5165\u7528\u6237\u540d "),n.BQk())}function O(o,i){1&o&&n.YNc(0,B,2,0,"ng-container",17),2&o&&n.Q6J("ngIf",i.$implicit.hasError("required"))}function J(o,i){1&o&&(n.ynx(0),n._uU(1," \u8bf7\u8f93\u5165\u5bc6\u7801 "),n.BQk())}function Q(o,i){1&o&&n.YNc(0,J,2,0,"ng-container",17),2&o&&n.Q6J("ngIf",i.$implicit.hasError("required"))}function E(o,i){1&o&&(n.ynx(0),n._uU(1," \u8bf7\u786e\u8ba4\u5bc6\u7801 "),n.BQk())}function w(o,i){1&o&&(n.ynx(0),n._uU(1," \u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4 "),n.BQk())}function N(o,i){if(1&o&&(n.YNc(0,E,2,0,"ng-container",17),n.YNc(1,w,2,0,"ng-container",17)),2&o){const t=i.$implicit;n.Q6J("ngIf",t.hasError("required")),n.xp6(1),n.Q6J("ngIf",t.hasError("notSame"))}}function P(o,i){if(1&o&&(n.ynx(0),n.TgZ(1,"form",18),n.TgZ(2,"nz-form-item"),n.TgZ(3,"nz-form-control",4),n.TgZ(4,"nz-input-group",5),n._UZ(5,"input",6),n.qZA(),n.YNc(6,O,1,1,"ng-template",null,19,n.W1O),n.qZA(),n.qZA(),n.TgZ(8,"nz-form-item"),n.TgZ(9,"nz-form-control",4),n.TgZ(10,"nz-input-group",8),n._UZ(11,"input",9),n.qZA(),n.YNc(12,Q,1,1,"ng-template",null,20,n.W1O),n.qZA(),n.qZA(),n.TgZ(14,"nz-form-item"),n.TgZ(15,"nz-form-control",4),n.TgZ(16,"nz-input-group",21),n._UZ(17,"input",22),n.qZA(),n.YNc(18,N,2,2,"ng-template",null,23,n.W1O),n.qZA(),n.qZA(),n.qZA(),n.BQk()),2&o){const t=n.MAs(7),e=n.MAs(13),g=n.MAs(19),l=n.oxw();n.xp6(1),n.Q6J("formGroup",l.registerIfy.registerForm),n.xp6(2),n.Q6J("nzErrorTip",t),n.xp6(6),n.Q6J("nzErrorTip",e),n.xp6(6),n.Q6J("nzErrorTip",g)}}function k(o,i){if(1&o){const t=n.EpF();n.TgZ(0,"button",24),n.NdJ("click",function(){return n.CHM(t),n.oxw().registerIfy.close()}),n._uU(1,"\u53d6\u6d88"),n.qZA(),n.TgZ(2,"button",25),n.NdJ("click",function(){return n.CHM(t),n.oxw().registerIfy.save()}),n._uU(3," \u6ce8\u518c "),n.qZA()}if(2&o){const t=n.oxw();n.xp6(2),n.Q6J("disabled",!t.registerIfy.registerForm.valid)}}let q=(()=>{class o{constructor(t,e,g,l,s){this.fb=t,this.titleService=e,this.message=g,this.router=l,this.loginService=s,this.loading=!1,this.loadingText="\u767b\u5f55\u4e2d...",this.registerIfy={visible:!1,title:"\u7528\u6237\u6ce8\u518c",registerForm:this.fb.group({username:["",a.kI.required],password:["",a.kI.required],confirmPassword:["",[a.kI.required,this.passwordMatchValidator]]}),open:()=>{this.registerIfy.visible=!0,this.loadingText="\u6ce8\u518c\u4e2d...",this.registerIfy.registerForm.reset({})},close:()=>{this.loadingText="\u767b\u5f55\u4e2d...",this.registerIfy.visible=!1},save:()=>{if(this.registerIfy.registerForm.valid){this.loading=!0;const{username:D,password:V}=this.registerIfy.registerForm.value;this.loginService.register({username:D,password:V}).subscribe(d=>{this.loading=!1,d.success?(this.message.success(d.message),this.registerIfy.close()):this.message.error(d.message)})}}},this.loginForm=this.fb.group({username:["",a.kI.required],password:["",a.kI.required]})}passwordMatchValidator(t){var e,g;return(null===(g=null===(e=t.parent)||void 0===e?void 0:e.get("password"))||void 0===g?void 0:g.value)===t.value?null:{notSame:!0}}onSubmit(){if(this.loading=!0,this.loginForm.valid){const t=this.loginForm.getRawValue();this.loginService.login(t).subscribe(e=>{this.loading=!1,e.success?(localStorage.setItem("token",e.token),this.router.navigate(["/welcome"]).then(g=>{g||console.error("\u5bfc\u822a\u5230/welcome\u5931\u8d25")})):this.message.error(e.message)})}}ngOnInit(){this.titleService.setTitle("\u767b\u5f55\u9875\u9762-\u6b22\u8fce\u8bbf\u95ee")}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(a.qu),n.Y36(T.Dx),n.Y36(z.dD),n.Y36(_.F0),n.Y36(Z))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-login"]],decls:26,vars:9,consts:[[1,"login-container"],[1,"login-title"],[1,"login-form"],["nz-form","",3,"formGroup","ngSubmit"],[3,"nzErrorTip"],["nzPrefixIcon","user"],["type","text","nz-input","","formControlName","username","placeholder","\u7528\u6237\u540d"],["usernameErrorTpl",""],["nzPrefixIcon","lock"],["type","password","nz-input","","formControlName","password","placeholder","\u5bc6\u7801"],["passwordErrorTpl",""],["nz-button","","nzType","default","nzBlock","",1,"login-button",3,"disabled"],["nz-button","","nzType","default","nzBlock","",1,"login-button",2,"margin-top","10px",3,"click"],[3,"loading","loadingText"],[3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[4,"nzModalContent"],["modalFooter",""],[4,"ngIf"],["nz-form","",3,"formGroup"],["registerUsernameError",""],["registerPasswordError",""],["nzPrefixIcon","safety"],["type","password","nz-input","","formControlName","confirmPassword","placeholder","\u786e\u8ba4\u5bc6\u7801"],["confirmPasswordError",""],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"h2",1),n._uU(2,"\u7528\u6237\u767b\u5f55"),n.qZA(),n.TgZ(3,"div",2),n.TgZ(4,"form",3),n.NdJ("ngSubmit",function(){return e.onSubmit()}),n.TgZ(5,"nz-form-item"),n.TgZ(6,"nz-form-control",4),n.TgZ(7,"nz-input-group",5),n._UZ(8,"input",6),n.qZA(),n.YNc(9,I,1,1,"ng-template",null,7,n.W1O),n.qZA(),n.qZA(),n.TgZ(11,"nz-form-item"),n.TgZ(12,"nz-form-control",4),n.TgZ(13,"nz-input-group",8),n._UZ(14,"input",9),n.qZA(),n.YNc(15,M,1,1,"ng-template",null,10,n.W1O),n.qZA(),n.qZA(),n.TgZ(17,"button",11),n._uU(18," \u767b\u5f55 "),n.qZA(),n.qZA(),n.TgZ(19,"button",12),n.NdJ("click",function(){return e.registerIfy.open()}),n._uU(20," \u6ca1\u6709\u8d26\u53f7\uff1f\u70b9\u51fb\u6ce8\u518c "),n.qZA(),n.qZA(),n.qZA(),n._UZ(21,"xj-loading",13),n.TgZ(22,"nz-modal",14),n.NdJ("nzVisibleChange",function(l){return e.registerIfy.visible=l})("nzOnCancel",function(){return e.registerIfy.close()}),n.YNc(23,P,20,4,"ng-container",15),n.YNc(24,k,4,1,"ng-template",null,16,n.W1O),n.qZA()),2&t){const g=n.MAs(10),l=n.MAs(16),s=n.MAs(25);n.xp6(4),n.Q6J("formGroup",e.loginForm),n.xp6(2),n.Q6J("nzErrorTip",g),n.xp6(6),n.Q6J("nzErrorTip",l),n.xp6(5),n.Q6J("disabled",!e.loginForm.valid),n.xp6(4),n.Q6J("loading",e.loading)("loadingText",e.loadingText),n.xp6(1),n.Q6J("nzVisible",e.registerIfy.visible)("nzTitle",e.registerIfy.title)("nzFooter",s)}},directives:[a._Y,a.JL,c.Lr,a.sg,h.SK,c.Nx,h.t3,c.Fd,p.gB,v.w,p.Zp,a.Fj,a.JJ,a.u,x.ix,b.dQ,F,m.du,m.Hf,u.O5],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column;background-image:url(7.1.f744c753c5b23f13aa4c.jpeg);background-size:cover;background-position:center;background-repeat:no-repeat}.login-container[_ngcontent-%COMP%]   .login-title[_ngcontent-%COMP%]{font-size:36px;font-weight:bold;color:#6973b8;margin-bottom:24px}.login-container[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]{width:400px;padding:24px;background:#6974b885;color:#6974b885;border-radius:8px;box-shadow:0 2px 8px #00000026}.login-container[_ngcontent-%COMP%]   .login-form-forgot[_ngcontent-%COMP%]{float:right}.login-container[_ngcontent-%COMP%]   .login-form-button[_ngcontent-%COMP%]{width:100%}.login-container[_ngcontent-%COMP%]   .login-button[_ngcontent-%COMP%]{background-color:#6973b8;color:#fff}"]}),o})();var U=r(2746);const Y=[{path:"",component:q}];let S=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[[u.ez,_.Bz.forChild(Y),a.UX,c.U5,p.o7,x.sL,U.wm,m.Qp]]}),o})()}}]);