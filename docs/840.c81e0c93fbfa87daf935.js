var lr=Object.defineProperty,cr=Object.defineProperties,ur=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,hr=Object.prototype.hasOwnProperty,dr=Object.prototype.propertyIsEnumerable,ge=(At,k,U)=>k in At?lr(At,k,{enumerable:!0,configurable:!0,writable:!0,value:U}):At[k]=U,zt=(At,k)=>{for(var U in k||(k={}))hr.call(k,U)&&ge(At,U,k[U]);if(me)for(var U of me(k))dr.call(k,U)&&ge(At,U,k[U]);return At},$t=(At,k)=>cr(At,ur(k));(self.webpackChunkmini_program=self.webpackChunkmini_program||[]).push([[840],{7586:At=>{At.exports=function k(U,N,f){function p(S,P){if(!N[S]){if(!U[S]){if(o)return o(S,!0);var C=new Error("Cannot find module '"+S+"'");throw C.code="MODULE_NOT_FOUND",C}var u=N[S]={exports:{}};U[S][0].call(u.exports,function(v){return p(U[S][1][v]||v)},u,u.exports,k,U,N,f)}return N[S].exports}for(var o=void 0,m=0;m<f.length;m++)p(f[m]);return p}({1:[function(k,U,N){"use strict";var f=k("./utils"),p=k("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";N.encode=function(m){for(var S,P,y,u,v,c,g=[],h=0,_=m.length,E=_,z="string"!==f.getTypeOf(m);h<m.length;)E=_-h,y=z?(S=m[h++],P=h<_?m[h++]:0,h<_?m[h++]:0):(S=m.charCodeAt(h++),P=h<_?m.charCodeAt(h++):0,h<_?m.charCodeAt(h++):0),u=(3&S)<<4|P>>4,v=1<E?(15&P)<<2|y>>6:64,c=2<E?63&y:64,g.push(o.charAt(S>>2)+o.charAt(u)+o.charAt(v)+o.charAt(c));return g.join("")},N.decode=function(m){var S,P,y,C,u,v,c=0,g=0,h="data:";if(m.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var _,E=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===o.charAt(64)&&E--,m.charAt(m.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=p.uint8array?new Uint8Array(0|E):new Array(0|E);c<m.length;)S=o.indexOf(m.charAt(c++))<<2|(C=o.indexOf(m.charAt(c++)))>>4,P=(15&C)<<4|(u=o.indexOf(m.charAt(c++)))>>2,y=(3&u)<<6|(v=o.indexOf(m.charAt(c++))),_[g++]=S,64!==u&&(_[g++]=P),64!==v&&(_[g++]=y);return _}},{"./support":30,"./utils":32}],2:[function(k,U,N){"use strict";var f=k("./external"),p=k("./stream/DataWorker"),o=k("./stream/Crc32Probe"),m=k("./stream/DataLengthProbe");function S(P,y,C,u,v){this.compressedSize=P,this.uncompressedSize=y,this.crc32=C,this.compression=u,this.compressedContent=v}S.prototype={getContentWorker:function(){var P=new p(f.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),y=this;return P.on("end",function(){if(this.streamInfo.data_length!==y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),P},getCompressedWorker:function(){return new p(f.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},S.createWorkerFrom=function(P,y,C){return P.pipe(new o).pipe(new m("uncompressedSize")).pipe(y.compressWorker(C)).pipe(new m("compressedSize")).withStreamInfo("compression",y)},U.exports=S},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(k,U,N){"use strict";var f=k("./stream/GenericWorker");N.STORE={magic:"\0\0",compressWorker:function(){return new f("STORE compression")},uncompressWorker:function(){return new f("STORE decompression")}},N.DEFLATE=k("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(k,U,N){"use strict";var f=k("./utils"),p=function(){for(var o,m=[],S=0;S<256;S++){o=S;for(var P=0;P<8;P++)o=1&o?3988292384^o>>>1:o>>>1;m[S]=o}return m}();U.exports=function(o,m){return void 0!==o&&o.length?"string"!==f.getTypeOf(o)?function(S,P,y,C){var u=p,v=0+y;S^=-1;for(var c=0;c<v;c++)S=S>>>8^u[255&(S^P[c])];return-1^S}(0|m,o,o.length):function(S,P,y,C){var u=p,v=0+y;S^=-1;for(var c=0;c<v;c++)S=S>>>8^u[255&(S^P.charCodeAt(c))];return-1^S}(0|m,o,o.length):0}},{"./utils":32}],5:[function(k,U,N){"use strict";N.base64=!1,N.binary=!1,N.dir=!1,N.createFolders=!0,N.date=null,N.compression=null,N.compressionOptions=null,N.comment=null,N.unixPermissions=null,N.dosPermissions=null},{}],6:[function(k,U,N){"use strict";var f;f="undefined"!=typeof Promise?Promise:k("lie"),U.exports={Promise:f}},{lie:37}],7:[function(k,U,N){"use strict";var f="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,p=k("pako"),o=k("./utils"),m=k("./stream/GenericWorker"),S=f?"uint8array":"array";function P(y,C){m.call(this,"FlateWorker/"+y),this._pako=null,this._pakoAction=y,this._pakoOptions=C,this.meta={}}N.magic="\b\0",o.inherits(P,m),P.prototype.processChunk=function(y){this.meta=y.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(S,y.data),!1)},P.prototype.flush=function(){m.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},P.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},P.prototype._createPako=function(){this._pako=new p[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var y=this;this._pako.onData=function(C){y.push({data:C,meta:y.meta})}},N.compressWorker=function(y){return new P("Deflate",y)},N.uncompressWorker=function(){return new P("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(k,U,N){"use strict";function f(u,v){var c,g="";for(c=0;c<v;c++)g+=String.fromCharCode(255&u),u>>>=8;return g}function p(u,v,c,g,h,_){var E,z,A=u.file,W=u.compression,j=_!==S.utf8encode,G=o.transformTo("string",_(A.name)),I=o.transformTo("string",S.utf8encode(A.name)),K=A.comment,st=o.transformTo("string",_(K)),w=o.transformTo("string",S.utf8encode(K)),L=I.length!==A.name.length,n=w.length!==K.length,D="",ot="",V="",ct=A.dir,X=A.date,it={crc32:0,compressedSize:0,uncompressedSize:0};v&&!c||(it.crc32=u.crc32,it.compressedSize=u.compressedSize,it.uncompressedSize=u.uncompressedSize);var T=0;v&&(T|=8),j||!L&&!n||(T|=2048);var Q,Ct,B=0,at=0;ct&&(B|=16),"UNIX"===h?(at=798,B|=(Ct=Q=A.unixPermissions,Q||(Ct=ct?16893:33204),(65535&Ct)<<16)):(at=20,B|=function(Q){return 63&(Q||0)}(A.dosPermissions)),E=X.getUTCHours(),E<<=6,E|=X.getUTCMinutes(),E<<=5,E|=X.getUTCSeconds()/2,z=X.getUTCFullYear()-1980,z<<=4,z|=X.getUTCMonth()+1,z<<=5,z|=X.getUTCDate(),L&&(ot=f(1,1)+f(P(G),4)+I,D+="up"+f(ot.length,2)+ot),n&&(V=f(1,1)+f(P(st),4)+w,D+="uc"+f(V.length,2)+V);var tt="";return tt+="\n\0",tt+=f(T,2),tt+=W.magic,tt+=f(E,2),tt+=f(z,2),tt+=f(it.crc32,4),tt+=f(it.compressedSize,4),tt+=f(it.uncompressedSize,4),tt+=f(G.length,2),tt+=f(D.length,2),{fileRecord:y.LOCAL_FILE_HEADER+tt+G+D,dirRecord:y.CENTRAL_FILE_HEADER+f(at,2)+tt+f(st.length,2)+"\0\0\0\0"+f(B,4)+f(g,4)+G+D+st}}var o=k("../utils"),m=k("../stream/GenericWorker"),S=k("../utf8"),P=k("../crc32"),y=k("../signature");function C(u,v,c,g){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=c,this.encodeFileName=g,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(C,m),C.prototype.push=function(u){var v=u.meta.percent||0,c=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,m.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:c?(v+100*(c-g-1))/c:100}}))},C.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var v=this.streamFiles&&!u.file.dir;if(v){var c=p(u,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},C.prototype.closedSource=function(u){this.accumulate=!1;var g,v=this.streamFiles&&!u.file.dir,c=p(u,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),v)this.push({data:(g=u,y.DATA_DESCRIPTOR+f(g.crc32,4)+f(g.compressedSize,4)+f(g.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},C.prototype.flush=function(){for(var u=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var h,_,E,W,g=(h=this.dirRecords.length,_=this.bytesWritten-u,E=u,W=o.transformTo("string",(0,this.encodeFileName)(this.zipComment)),y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(h,2)+f(h,2)+f(_,4)+f(E,4)+f(W.length,2)+W);this.push({data:g,meta:{percent:100}})},C.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},C.prototype.registerPrevious=function(u){this._sources.push(u);var v=this;return u.on("data",function(c){v.processChunk(c)}),u.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),u.on("error",function(c){v.error(c)}),this},C.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},C.prototype.error=function(u){var v=this._sources;if(!m.prototype.error.call(this,u))return!1;for(var c=0;c<v.length;c++)try{v[c].error(u)}catch(g){}return!0},C.prototype.lock=function(){m.prototype.lock.call(this);for(var u=this._sources,v=0;v<u.length;v++)u[v].lock()},U.exports=C},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(k,U,N){"use strict";var f=k("../compressions"),p=k("./ZipFileWorker");N.generateWorker=function(o,m,S){var P=new p(m.streamFiles,S,m.platform,m.encodeFileName),y=0;try{o.forEach(function(C,u){y++;var v=function(_,E){var z=_||E,A=f[z];if(!A)throw new Error(z+" is not a valid compression method !");return A}(u.options.compression,m.compression),g=u.dir,h=u.date;u._compressWorker(v,u.options.compressionOptions||m.compressionOptions||{}).withStreamInfo("file",{name:C,dir:g,date:h,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(P)}),P.entriesCount=y}catch(C){P.error(C)}return P}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(k,U,N){"use strict";function f(){if(!(this instanceof f))return new f;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var p=new f;for(var o in this)"function"!=typeof this[o]&&(p[o]=this[o]);return p}}(f.prototype=k("./object")).loadAsync=k("./load"),f.support=k("./support"),f.defaults=k("./defaults"),f.version="3.10.1",f.loadAsync=function(p,o){return(new f).loadAsync(p,o)},f.external=k("./external"),U.exports=f},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(k,U,N){"use strict";var f=k("./utils"),p=k("./external"),o=k("./utf8"),m=k("./zipEntries"),S=k("./stream/Crc32Probe"),P=k("./nodejsUtils");function y(C){return new p.Promise(function(u,v){var c=C.decompressed.getContentWorker().pipe(new S);c.on("error",function(g){v(g)}).on("end",function(){c.streamInfo.crc32!==C.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}U.exports=function(C,u){var v=this;return u=f.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),P.isNode&&P.isStream(C)?p.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):f.prepareContent("the loaded zip file",C,!0,u.optimizedBinaryString,u.base64).then(function(c){var g=new m(u);return g.load(c),g}).then(function(c){var g=[p.Promise.resolve(c)],h=c.files;if(u.checkCRC32)for(var _=0;_<h.length;_++)g.push(y(h[_]));return p.Promise.all(g)}).then(function(c){for(var g=c.shift(),h=g.files,_=0;_<h.length;_++){var E=h[_],z=E.fileNameStr,A=f.resolve(E.fileNameStr);v.file(A,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:u.createFolders}),E.dir||(v.file(A).unsafeOriginalName=z)}return g.zipComment.length&&(v.comment=g.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(k,U,N){"use strict";var f=k("../utils"),p=k("../stream/GenericWorker");function o(m,S){p.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(S)}f.inherits(o,p),o.prototype._bindStream=function(m){var S=this;(this._stream=m).pause(),m.on("data",function(P){S.push({data:P,meta:{percent:0}})}).on("error",function(P){S.isPaused?this.generatedError=P:S.error(P)}).on("end",function(){S.isPaused?S._upstreamEnded=!0:S.end()})},o.prototype.pause=function(){return!!p.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},U.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(k,U,N){"use strict";var f=k("readable-stream").Readable;function p(o,m,S){f.call(this,m),this._helper=o;var P=this;o.on("data",function(y,C){P.push(y)||P._helper.pause(),S&&S(C)}).on("error",function(y){P.emit("error",y)}).on("end",function(){P.push(null)})}k("../utils").inherits(p,f),p.prototype._read=function(){this._helper.resume()},U.exports=p},{"../utils":32,"readable-stream":16}],14:[function(k,U,N){"use strict";U.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(f,p){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(f,p);if("number"==typeof f)throw new Error('The "data" argument must not be a number');return new Buffer(f,p)},allocBuffer:function(f){if(Buffer.alloc)return Buffer.alloc(f);var p=new Buffer(f);return p.fill(0),p},isBuffer:function(f){return Buffer.isBuffer(f)},isStream:function(f){return f&&"function"==typeof f.on&&"function"==typeof f.pause&&"function"==typeof f.resume}}},{}],15:[function(k,U,N){"use strict";function f(A,W,j){var G,I=o.getTypeOf(W),K=o.extend(j||{},P);K.date=K.date||new Date,null!==K.compression&&(K.compression=K.compression.toUpperCase()),"string"==typeof K.unixPermissions&&(K.unixPermissions=parseInt(K.unixPermissions,8)),K.unixPermissions&&16384&K.unixPermissions&&(K.dir=!0),K.dosPermissions&&16&K.dosPermissions&&(K.dir=!0),K.dir&&(A=h(A)),K.createFolders&&(G=g(A))&&_.call(this,G,!0),j&&void 0!==j.binary||(K.binary=!("string"===I&&!1===K.binary&&!1===K.base64)),(W instanceof y&&0===W.uncompressedSize||K.dir||!W||0===W.length)&&(K.base64=!1,K.binary=!0,W="",K.compression="STORE",I="string");var w;w=W instanceof y||W instanceof m?W:v.isNode&&v.isStream(W)?new c(A,W):o.prepareContent(A,W,K.binary,K.optimizedBinaryString,K.base64);var L=new C(A,w,K);this.files[A]=L}var p=k("./utf8"),o=k("./utils"),m=k("./stream/GenericWorker"),S=k("./stream/StreamHelper"),P=k("./defaults"),y=k("./compressedObject"),C=k("./zipObject"),u=k("./generate"),v=k("./nodejsUtils"),c=k("./nodejs/NodejsStreamInputAdapter"),g=function(A){"/"===A.slice(-1)&&(A=A.substring(0,A.length-1));var W=A.lastIndexOf("/");return 0<W?A.substring(0,W):""},h=function(A){return"/"!==A.slice(-1)&&(A+="/"),A},_=function(A,W){return W=void 0!==W?W:P.createFolders,A=h(A),this.files[A]||f.call(this,A,null,{dir:!0,createFolders:W}),this.files[A]};function E(A){return"[object RegExp]"===Object.prototype.toString.call(A)}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var W,j,G;for(W in this.files)G=this.files[W],(j=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&A(j,G)},filter:function(A){var W=[];return this.forEach(function(j,G){A(j,G)&&W.push(G)}),W},file:function(A,W,j){if(1!==arguments.length)return f.call(this,A=this.root+A,W,j),this;if(E(A)){var G=A;return this.filter(function(K,st){return!st.dir&&G.test(K)})}var I=this.files[this.root+A];return I&&!I.dir?I:null},folder:function(A){if(!A)return this;if(E(A))return this.filter(function(I,K){return K.dir&&A.test(I)});var j=_.call(this,this.root+A),G=this.clone();return G.root=j.name,G},remove:function(A){var W=this.files[A=this.root+A];if(W||("/"!==A.slice(-1)&&(A+="/"),W=this.files[A]),W&&!W.dir)delete this.files[A];else for(var j=this.filter(function(I,K){return K.name.slice(0,A.length)===A}),G=0;G<j.length;G++)delete this.files[j[G].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var W,j={};try{if((j=o.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:p.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),"binarystring"===j.type&&(j.type="string"),!j.type)throw new Error("No output type specified.");o.checkSupport(j.type),"darwin"!==j.platform&&"freebsd"!==j.platform&&"linux"!==j.platform&&"sunos"!==j.platform||(j.platform="UNIX"),"win32"===j.platform&&(j.platform="DOS"),W=u.generateWorker(this,j,j.comment||this.comment||"")}catch(I){(W=new m("error")).error(I)}return new S(W,j.type||"string",j.mimeType)},generateAsync:function(A,W){return this.generateInternalStream(A).accumulate(W)},generateNodeStream:function(A,W){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(W)}};U.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(k,U,N){"use strict";U.exports=k("stream")},{stream:void 0}],17:[function(k,U,N){"use strict";var f=k("./DataReader");function p(o){f.call(this,o);for(var m=0;m<this.data.length;m++)o[m]=255&o[m]}k("../utils").inherits(p,f),p.prototype.byteAt=function(o){return this.data[this.zero+o]},p.prototype.lastIndexOfSignature=function(o){for(var m=o.charCodeAt(0),S=o.charCodeAt(1),P=o.charCodeAt(2),y=o.charCodeAt(3),C=this.length-4;0<=C;--C)if(this.data[C]===m&&this.data[C+1]===S&&this.data[C+2]===P&&this.data[C+3]===y)return C-this.zero;return-1},p.prototype.readAndCheckSignature=function(o){var m=o.charCodeAt(0),S=o.charCodeAt(1),P=o.charCodeAt(2),y=o.charCodeAt(3),C=this.readData(4);return m===C[0]&&S===C[1]&&P===C[2]&&y===C[3]},p.prototype.readData=function(o){if(this.checkOffset(o),0===o)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,m},U.exports=p},{"../utils":32,"./DataReader":18}],18:[function(k,U,N){"use strict";var f=k("../utils");function p(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}p.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var m,S=0;for(this.checkOffset(o),m=this.index+o-1;m>=this.index;m--)S=(S<<8)+this.byteAt(m);return this.index+=o,S},readString:function(o){return f.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},U.exports=p},{"../utils":32}],19:[function(k,U,N){"use strict";var f=k("./Uint8ArrayReader");function p(o){f.call(this,o)}k("../utils").inherits(p,f),p.prototype.readData=function(o){this.checkOffset(o);var m=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,m},U.exports=p},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(k,U,N){"use strict";var f=k("./DataReader");function p(o){f.call(this,o)}k("../utils").inherits(p,f),p.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},p.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},p.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},p.prototype.readData=function(o){this.checkOffset(o);var m=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,m},U.exports=p},{"../utils":32,"./DataReader":18}],21:[function(k,U,N){"use strict";var f=k("./ArrayReader");function p(o){f.call(this,o)}k("../utils").inherits(p,f),p.prototype.readData=function(o){if(this.checkOffset(o),0===o)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,m},U.exports=p},{"../utils":32,"./ArrayReader":17}],22:[function(k,U,N){"use strict";var f=k("../utils"),p=k("../support"),o=k("./ArrayReader"),m=k("./StringReader"),S=k("./NodeBufferReader"),P=k("./Uint8ArrayReader");U.exports=function(y){var C=f.getTypeOf(y);return f.checkSupport(C),"string"!==C||p.uint8array?"nodebuffer"===C?new S(y):p.uint8array?new P(f.transformTo("uint8array",y)):new o(f.transformTo("array",y)):new m(y)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(k,U,N){"use strict";N.LOCAL_FILE_HEADER="PK\x03\x04",N.CENTRAL_FILE_HEADER="PK\x01\x02",N.CENTRAL_DIRECTORY_END="PK\x05\x06",N.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",N.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",N.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(k,U,N){"use strict";var f=k("./GenericWorker"),p=k("../utils");function o(m){f.call(this,"ConvertWorker to "+m),this.destType=m}p.inherits(o,f),o.prototype.processChunk=function(m){this.push({data:p.transformTo(this.destType,m.data),meta:m.meta})},U.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(k,U,N){"use strict";var f=k("./GenericWorker"),p=k("../crc32");function o(){f.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}k("../utils").inherits(o,f),o.prototype.processChunk=function(m){this.streamInfo.crc32=p(m.data,this.streamInfo.crc32||0),this.push(m)},U.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(k,U,N){"use strict";var f=k("../utils"),p=k("./GenericWorker");function o(m){p.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}f.inherits(o,p),o.prototype.processChunk=function(m){m&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+m.data.length),p.prototype.processChunk.call(this,m)},U.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(k,U,N){"use strict";var f=k("../utils"),p=k("./GenericWorker");function o(m){p.call(this,"DataWorker");var S=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function(P){S.dataIsReady=!0,S.data=P,S.max=P&&P.length||0,S.type=f.getTypeOf(P),S.isPaused||S._tickAndRepeat()},function(P){S.error(P)})}f.inherits(o,p),o.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,f.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(f.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,S=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,S);break;case"uint8array":m=this.data.subarray(this.index,S);break;case"array":case"nodebuffer":m=this.data.slice(this.index,S)}return this.index=S,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},U.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(k,U,N){"use strict";function f(p){this.name=p||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}f.prototype={push:function(p){this.emit("data",p)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(p){this.emit("error",p)}return!0},error:function(p){return!this.isFinished&&(this.isPaused?this.generatedError=p:(this.isFinished=!0,this.emit("error",p),this.previous&&this.previous.error(p),this.cleanUp()),!0)},on:function(p,o){return this._listeners[p].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(p,o){if(this._listeners[p])for(var m=0;m<this._listeners[p].length;m++)this._listeners[p][m].call(this,o)},pipe:function(p){return p.registerPrevious(this)},registerPrevious:function(p){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=p.streamInfo,this.mergeStreamInfo(),this.previous=p;var o=this;return p.on("data",function(m){o.processChunk(m)}),p.on("end",function(){o.end()}),p.on("error",function(m){o.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var p=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),p=!0),this.previous&&this.previous.resume(),!p},flush:function(){},processChunk:function(p){this.push(p)},withStreamInfo:function(p,o){return this.extraStreamInfo[p]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var p in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,p)&&(this.streamInfo[p]=this.extraStreamInfo[p])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var p="Worker "+this.name;return this.previous?this.previous+" -> "+p:p}},U.exports=f},{}],29:[function(k,U,N){"use strict";var f=k("../utils"),p=k("./ConvertWorker"),o=k("./GenericWorker"),m=k("../base64"),S=k("../support"),P=k("../external"),y=null;if(S.nodestream)try{y=k("../nodejs/NodejsStreamOutputAdapter")}catch(v){}function u(v,c,g){var h=c;switch(c){case"blob":case"arraybuffer":h="uint8array";break;case"base64":h="string"}try{this._internalType=h,this._outputType=c,this._mimeType=g,f.checkSupport(h),this._worker=v.pipe(new p(h)),v.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}u.prototype={accumulate:function(v){return function(v,c){return new P.Promise(function(g,h){var _=[],E=v._internalType,z=v._outputType,A=v._mimeType;v.on("data",function(W,j){_.push(W),c&&c(j)}).on("error",function(W){_=[],h(W)}).on("end",function(){try{var W=function(j,G,I){switch(j){case"blob":return f.newBlob(f.transformTo("arraybuffer",G),I);case"base64":return m.encode(G);default:return f.transformTo(j,G)}}(z,function(j,G){var I,K=0,st=null,w=0;for(I=0;I<G.length;I++)w+=G[I].length;switch(j){case"string":return G.join("");case"array":return Array.prototype.concat.apply([],G);case"uint8array":for(st=new Uint8Array(w),I=0;I<G.length;I++)st.set(G[I],K),K+=G[I].length;return st;case"nodebuffer":return Buffer.concat(G);default:throw new Error("concat : unsupported type '"+j+"'")}}(E,_),A);g(W)}catch(j){h(j)}_=[]}).resume()})}(this,v)},on:function(v,c){var g=this;return this._worker.on(v,"data"===v?function(h){c.call(g,h.data,h.meta)}:function(){f.delay(c,arguments,g)}),this},resume:function(){return f.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(f.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new y(this,{objectMode:"nodebuffer"!==this._outputType},v)}},U.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(k,U,N){"use strict";if(N.base64=!0,N.array=!0,N.string=!0,N.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,N.nodebuffer="undefined"!=typeof Buffer,N.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)N.blob=!1;else{var f=new ArrayBuffer(0);try{N.blob=0===new Blob([f],{type:"application/zip"}).size}catch(o){try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);p.append(f),N.blob=0===p.getBlob("application/zip").size}catch(m){N.blob=!1}}}try{N.nodestream=!!k("readable-stream").Readable}catch(o){N.nodestream=!1}},{"readable-stream":16}],31:[function(k,U,N){"use strict";for(var f=k("./utils"),p=k("./support"),o=k("./nodejsUtils"),m=k("./stream/GenericWorker"),S=new Array(256),P=0;P<256;P++)S[P]=252<=P?6:248<=P?5:240<=P?4:224<=P?3:192<=P?2:1;function y(){m.call(this,"utf-8 decode"),this.leftOver=null}function C(){m.call(this,"utf-8 encode")}S[254]=S[254]=1,N.utf8encode=function(u){return p.nodebuffer?o.newBufferFrom(u,"utf-8"):function(v){var c,g,h,_,E,z=v.length,A=0;for(_=0;_<z;_++)55296==(64512&(g=v.charCodeAt(_)))&&_+1<z&&56320==(64512&(h=v.charCodeAt(_+1)))&&(g=65536+(g-55296<<10)+(h-56320),_++),A+=g<128?1:g<2048?2:g<65536?3:4;for(c=p.uint8array?new Uint8Array(A):new Array(A),_=E=0;E<A;_++)55296==(64512&(g=v.charCodeAt(_)))&&_+1<z&&56320==(64512&(h=v.charCodeAt(_+1)))&&(g=65536+(g-55296<<10)+(h-56320),_++),g<128?c[E++]=g:(g<2048?c[E++]=192|g>>>6:(g<65536?c[E++]=224|g>>>12:(c[E++]=240|g>>>18,c[E++]=128|g>>>12&63),c[E++]=128|g>>>6&63),c[E++]=128|63&g);return c}(u)},N.utf8decode=function(u){return p.nodebuffer?f.transformTo("nodebuffer",u).toString("utf-8"):function(v){var c,g,h,_,E=v.length,z=new Array(2*E);for(c=g=0;c<E;)if((h=v[c++])<128)z[g++]=h;else if(4<(_=S[h]))z[g++]=65533,c+=_-1;else{for(h&=2===_?31:3===_?15:7;1<_&&c<E;)h=h<<6|63&v[c++],_--;1<_?z[g++]=65533:h<65536?z[g++]=h:(z[g++]=55296|(h-=65536)>>10&1023,z[g++]=56320|1023&h)}return z.length!==g&&(z.subarray?z=z.subarray(0,g):z.length=g),f.applyFromCharCode(z)}(u=f.transformTo(p.uint8array?"uint8array":"array",u))},f.inherits(y,m),y.prototype.processChunk=function(u){var v=f.transformTo(p.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(p.uint8array){var c=v;(v=new Uint8Array(c.length+this.leftOver.length)).set(this.leftOver,0),v.set(c,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var g=function(_,E){var z;for((E=E||_.length)>_.length&&(E=_.length),z=E-1;0<=z&&128==(192&_[z]);)z--;return z<0||0===z?E:z+S[_[z]]>E?z:E}(v),h=v;g!==v.length&&(p.uint8array?(h=v.subarray(0,g),this.leftOver=v.subarray(g,v.length)):(h=v.slice(0,g),this.leftOver=v.slice(g,v.length))),this.push({data:N.utf8decode(h),meta:u.meta})},y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:N.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},N.Utf8DecodeWorker=y,f.inherits(C,m),C.prototype.processChunk=function(u){this.push({data:N.utf8encode(u.data),meta:u.meta})},N.Utf8EncodeWorker=C},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(k,U,N){"use strict";var f=k("./support"),p=k("./base64"),o=k("./nodejsUtils"),m=k("./external");function S(c){return c}function P(c,g){for(var h=0;h<c.length;++h)g[h]=255&c.charCodeAt(h);return g}k("setimmediate"),N.newBlob=function(c,g){N.checkSupport("blob");try{return new Blob([c],{type:g})}catch(_){try{var h=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return h.append(c),h.getBlob(g)}catch(E){throw new Error("Bug : can't construct the Blob.")}}};var y={stringifyByChunk:function(c,g,h){var _=[],E=0,z=c.length;if(z<=h)return String.fromCharCode.apply(null,c);for(;E<z;)_.push(String.fromCharCode.apply(null,"array"===g||"nodebuffer"===g?c.slice(E,Math.min(E+h,z)):c.subarray(E,Math.min(E+h,z)))),E+=h;return _.join("")},stringifyByChar:function(c){for(var g="",h=0;h<c.length;h++)g+=String.fromCharCode(c[h]);return g},applyCanBeUsed:{uint8array:function(){try{return f.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(c){return!1}}(),nodebuffer:function(){try{return f.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(c){return!1}}()}};function C(c){var g=65536,h=N.getTypeOf(c),_=!0;if("uint8array"===h?_=y.applyCanBeUsed.uint8array:"nodebuffer"===h&&(_=y.applyCanBeUsed.nodebuffer),_)for(;1<g;)try{return y.stringifyByChunk(c,h,g)}catch(E){g=Math.floor(g/2)}return y.stringifyByChar(c)}function u(c,g){for(var h=0;h<c.length;h++)g[h]=c[h];return g}N.applyFromCharCode=C;var v={};v.string={string:S,array:function(c){return P(c,new Array(c.length))},arraybuffer:function(c){return v.string.uint8array(c).buffer},uint8array:function(c){return P(c,new Uint8Array(c.length))},nodebuffer:function(c){return P(c,o.allocBuffer(c.length))}},v.array={string:C,array:S,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(c)}},v.arraybuffer={string:function(c){return C(new Uint8Array(c))},array:function(c){return u(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:S,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(new Uint8Array(c))}},v.uint8array={string:C,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:S,nodebuffer:function(c){return o.newBufferFrom(c)}},v.nodebuffer={string:C,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return v.nodebuffer.uint8array(c).buffer},uint8array:function(c){return u(c,new Uint8Array(c.length))},nodebuffer:S},N.transformTo=function(c,g){if(g=g||"",!c)return g;N.checkSupport(c);var h=N.getTypeOf(g);return v[h][c](g)},N.resolve=function(c){for(var g=c.split("/"),h=[],_=0;_<g.length;_++){var E=g[_];"."===E||""===E&&0!==_&&_!==g.length-1||(".."===E?h.pop():h.push(E))}return h.join("/")},N.getTypeOf=function(c){return"string"==typeof c?"string":"[object Array]"===Object.prototype.toString.call(c)?"array":f.nodebuffer&&o.isBuffer(c)?"nodebuffer":f.uint8array&&c instanceof Uint8Array?"uint8array":f.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},N.checkSupport=function(c){if(!f[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},N.MAX_VALUE_16BITS=65535,N.MAX_VALUE_32BITS=-1,N.pretty=function(c){var g,h,_="";for(h=0;h<(c||"").length;h++)_+="\\x"+((g=c.charCodeAt(h))<16?"0":"")+g.toString(16).toUpperCase();return _},N.delay=function(c,g,h){setImmediate(function(){c.apply(h||null,g||[])})},N.inherits=function(c,g){function h(){}h.prototype=g.prototype,c.prototype=new h},N.extend=function(){var c,g,h={};for(c=0;c<arguments.length;c++)for(g in arguments[c])Object.prototype.hasOwnProperty.call(arguments[c],g)&&void 0===h[g]&&(h[g]=arguments[c][g]);return h},N.prepareContent=function(c,g,h,_,E){return m.Promise.resolve(g).then(function(z){return f.blob&&(z instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z)))&&"undefined"!=typeof FileReader?new m.Promise(function(A,W){var j=new FileReader;j.onload=function(G){A(G.target.result)},j.onerror=function(G){W(G.target.error)},j.readAsArrayBuffer(z)}):z}).then(function(z){var W,A=N.getTypeOf(z);return A?("arraybuffer"===A?z=N.transformTo("uint8array",z):"string"===A&&(E?z=p.decode(z):h&&!0!==_&&(z=P(W=z,f.uint8array?new Uint8Array(W.length):new Array(W.length)))),z):m.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(k,U,N){"use strict";var f=k("./reader/readerFor"),p=k("./utils"),o=k("./signature"),m=k("./zipEntry"),S=k("./support");function P(y){this.files=[],this.loadOptions=y}P.prototype={checkSignature:function(y){if(!this.reader.readAndCheckSignature(y)){this.reader.index-=4;var C=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+p.pretty(C)+", expected "+p.pretty(y)+")")}},isSignature:function(y,C){var u=this.reader.index;this.reader.setIndex(y);var v=this.reader.readString(4)===C;return this.reader.setIndex(u),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var y=this.reader.readData(this.zipCommentLength),u=p.transformTo(S.uint8array?"uint8array":"array",y);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var y,C,u,v=this.zip64EndOfCentralSize-44;0<v;)y=this.reader.readInt(2),C=this.reader.readInt(4),u=this.reader.readData(C),this.zip64ExtensibleData[y]={id:y,length:C,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var y,C;for(y=0;y<this.files.length;y++)this.reader.setIndex((C=this.files[y]).localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),C.readLocalPart(this.reader),C.handleUTF8(),C.processAttributes()},readCentralDir:function(){var y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(y=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(y);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var y=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(y<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(y);var C=y;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===p.MAX_VALUE_16BITS||this.diskWithCentralDirStart===p.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===p.MAX_VALUE_16BITS||this.centralDirRecords===p.MAX_VALUE_16BITS||this.centralDirSize===p.MAX_VALUE_32BITS||this.centralDirOffset===p.MAX_VALUE_32BITS){if(this.zip64=!0,(y=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(y),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var v=C-u;if(0<v)this.isSignature(C,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(y){this.reader=f(y)},load:function(y){this.prepareReader(y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},U.exports=P},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(k,U,N){"use strict";var f=k("./reader/readerFor"),p=k("./utils"),o=k("./compressedObject"),m=k("./crc32"),S=k("./utf8"),P=k("./compressions"),y=k("./support");function C(u,v){this.options=u,this.loadOptions=v}C.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(u){var v,c;if(u.skip(22),this.fileNameLength=u.readInt(2),c=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(c),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(v=function(g){for(var h in P)if(Object.prototype.hasOwnProperty.call(P,h)&&P[h].magic===g)return P[h];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+p.pretty(this.compressionMethod)+" unknown (inner file : "+p.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var v=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(v),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==u&&(this.dosPermissions=63&this.externalFileAttributes),3==u&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=f(this.extraFields[1].value);this.uncompressedSize===p.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===p.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===p.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===p.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var v,c,g,h=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<h;)v=u.readInt(2),c=u.readInt(2),g=u.readData(c),this.extraFields[v]={id:v,length:c,value:g};u.setIndex(h)},handleUTF8:function(){var u=y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=S.utf8decode(this.fileName),this.fileCommentStr=S.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(null!==v)this.fileNameStr=v;else{var c=p.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var g=this.findExtraFieldUnicodeComment();if(null!==g)this.fileCommentStr=g;else{var h=p.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(h)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var v=f(u.value);return 1!==v.readInt(1)||m(this.fileName)!==v.readInt(4)?null:S.utf8decode(v.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var v=f(u.value);return 1!==v.readInt(1)||m(this.fileComment)!==v.readInt(4)?null:S.utf8decode(v.readData(u.length-5))}return null}},U.exports=C},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(k,U,N){"use strict";function f(v,c,g){this.name=v,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=c,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var p=k("./stream/StreamHelper"),o=k("./stream/DataWorker"),m=k("./utf8"),S=k("./compressedObject"),P=k("./stream/GenericWorker");f.prototype={internalStream:function(v){var c=null,g="string";try{if(!v)throw new Error("No output type specified.");var h="string"===(g=v.toLowerCase())||"text"===g;"binarystring"!==g&&"text"!==g||(g="string"),c=this._decompressWorker();var _=!this._dataBinary;_&&!h&&(c=c.pipe(new m.Utf8EncodeWorker)),!_&&h&&(c=c.pipe(new m.Utf8DecodeWorker))}catch(E){(c=new P("error")).error(E)}return new p(c,g,"")},async:function(v,c){return this.internalStream(v).accumulate(c)},nodeStream:function(v,c){return this.internalStream(v||"nodebuffer").toNodejsStream(c)},_compressWorker:function(v,c){if(this._data instanceof S&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new m.Utf8EncodeWorker)),S.createWorkerFrom(g,v,c)},_decompressWorker:function(){return this._data instanceof S?this._data.getContentWorker():this._data instanceof P?this._data:new o(this._data)}};for(var y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],C=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<y.length;u++)f.prototype[y[u]]=C;U.exports=f},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(k,U,N){(function(f){"use strict";var p,o,m=f.MutationObserver||f.WebKitMutationObserver;if(m){var S=0,P=new m(v),y=f.document.createTextNode("");P.observe(y,{characterData:!0}),p=function(){y.data=S=++S%2}}else if(f.setImmediate||void 0===f.MessageChannel)p="document"in f&&"onreadystatechange"in f.document.createElement("script")?function(){var c=f.document.createElement("script");c.onreadystatechange=function(){v(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},f.document.documentElement.appendChild(c)}:function(){setTimeout(v,0)};else{var C=new f.MessageChannel;C.port1.onmessage=v,p=function(){C.port2.postMessage(0)}}var u=[];function v(){var c,g;o=!0;for(var h=u.length;h;){for(g=u,u=[],c=-1;++c<h;)g[c]();h=u.length}o=!1}U.exports=function(c){1!==u.push(c)||o||p()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(k,U,N){"use strict";var f=k("immediate");function p(){}var o={},m=["REJECTED"],S=["FULFILLED"],P=["PENDING"];function y(h){if("function"!=typeof h)throw new TypeError("resolver must be a function");this.state=P,this.queue=[],this.outcome=void 0,h!==p&&c(this,h)}function C(h,_,E){this.promise=h,"function"==typeof _&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),"function"==typeof E&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function u(h,_,E){f(function(){var z;try{z=_(E)}catch(A){return o.reject(h,A)}z===h?o.reject(h,new TypeError("Cannot resolve promise with itself")):o.resolve(h,z)})}function v(h){var _=h&&h.then;if(h&&("object"==typeof h||"function"==typeof h)&&"function"==typeof _)return function(){_.apply(h,arguments)}}function c(h,_){var E=!1;function z(j){E||(E=!0,o.reject(h,j))}function A(j){E||(E=!0,o.resolve(h,j))}var W=g(function(){_(A,z)});"error"===W.status&&z(W.value)}function g(h,_){var E={};try{E.value=h(_),E.status="success"}catch(z){E.status="error",E.value=z}return E}(U.exports=y).prototype.finally=function(h){if("function"!=typeof h)return this;var _=this.constructor;return this.then(function(E){return _.resolve(h()).then(function(){return E})},function(E){return _.resolve(h()).then(function(){throw E})})},y.prototype.catch=function(h){return this.then(null,h)},y.prototype.then=function(h,_){if("function"!=typeof h&&this.state===S||"function"!=typeof _&&this.state===m)return this;var E=new this.constructor(p);return this.state!==P?u(E,this.state===S?h:_,this.outcome):this.queue.push(new C(E,h,_)),E},C.prototype.callFulfilled=function(h){o.resolve(this.promise,h)},C.prototype.otherCallFulfilled=function(h){u(this.promise,this.onFulfilled,h)},C.prototype.callRejected=function(h){o.reject(this.promise,h)},C.prototype.otherCallRejected=function(h){u(this.promise,this.onRejected,h)},o.resolve=function(h,_){var E=g(v,_);if("error"===E.status)return o.reject(h,E.value);var z=E.value;if(z)c(h,z);else{h.state=S,h.outcome=_;for(var A=-1,W=h.queue.length;++A<W;)h.queue[A].callFulfilled(_)}return h},o.reject=function(h,_){h.state=m,h.outcome=_;for(var E=-1,z=h.queue.length;++E<z;)h.queue[E].callRejected(_);return h},y.resolve=function(h){return h instanceof this?h:o.resolve(new this(p),h)},y.reject=function(h){var _=new this(p);return o.reject(_,h)},y.all=function(h){var _=this;if("[object Array]"!==Object.prototype.toString.call(h))return this.reject(new TypeError("must be an array"));var E=h.length,z=!1;if(!E)return this.resolve([]);for(var A=new Array(E),W=0,j=-1,G=new this(p);++j<E;)I(h[j],j);return G;function I(K,st){_.resolve(K).then(function(w){A[st]=w,++W!==E||z||(z=!0,o.resolve(G,A))},function(w){z||(z=!0,o.reject(G,w))})}},y.race=function(h){if("[object Array]"!==Object.prototype.toString.call(h))return this.reject(new TypeError("must be an array"));var E=h.length,z=!1;if(!E)return this.resolve([]);for(var A=-1,W=new this(p);++A<E;)this.resolve(h[A]).then(function(G){z||(z=!0,o.resolve(W,G))},function(G){z||(z=!0,o.reject(W,G))});return W}},{immediate:36}],38:[function(k,U,N){"use strict";var f={};(0,k("./lib/utils/common").assign)(f,k("./lib/deflate"),k("./lib/inflate"),k("./lib/zlib/constants")),U.exports=f},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(k,U,N){"use strict";var f=k("./zlib/deflate"),p=k("./utils/common"),o=k("./utils/strings"),m=k("./zlib/messages"),S=k("./zlib/zstream"),P=Object.prototype.toString;function c(h){if(!(this instanceof c))return new c(h);this.options=p.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new S,this.strm.avail_out=0;var E=f.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(0!==E)throw new Error(m[E]);if(_.header&&f.deflateSetHeader(this.strm,_.header),_.dictionary){var z;if(z="string"==typeof _.dictionary?o.string2buf(_.dictionary):"[object ArrayBuffer]"===P.call(_.dictionary)?new Uint8Array(_.dictionary):_.dictionary,0!==(E=f.deflateSetDictionary(this.strm,z)))throw new Error(m[E]);this._dict_set=!0}}function g(h,_){var E=new c(_);if(E.push(h,!0),E.err)throw E.msg||m[E.err];return E.result}c.prototype.push=function(h,_){var E,z,A=this.strm,W=this.options.chunkSize;if(this.ended)return!1;z=_===~~_?_:!0===_?4:0,A.input="string"==typeof h?o.string2buf(h):"[object ArrayBuffer]"===P.call(h)?new Uint8Array(h):h,A.next_in=0,A.avail_in=A.input.length;do{if(0===A.avail_out&&(A.output=new p.Buf8(W),A.next_out=0,A.avail_out=W),1!==(E=f.deflate(A,z))&&0!==E)return this.onEnd(E),!(this.ended=!0);0!==A.avail_out&&(0!==A.avail_in||4!==z&&2!==z)||this.onData("string"===this.options.to?o.buf2binstring(p.shrinkBuf(A.output,A.next_out)):p.shrinkBuf(A.output,A.next_out))}while((0<A.avail_in||0===A.avail_out)&&1!==E);return 4===z?(E=f.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,0===E):2!==z||(this.onEnd(0),!(A.avail_out=0))},c.prototype.onData=function(h){this.chunks.push(h)},c.prototype.onEnd=function(h){0===h&&(this.result="string"===this.options.to?this.chunks.join(""):p.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},N.Deflate=c,N.deflate=g,N.deflateRaw=function(h,_){return(_=_||{}).raw=!0,g(h,_)},N.gzip=function(h,_){return(_=_||{}).gzip=!0,g(h,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(k,U,N){"use strict";var f=k("./zlib/inflate"),p=k("./utils/common"),o=k("./utils/strings"),m=k("./zlib/constants"),S=k("./zlib/messages"),P=k("./zlib/zstream"),y=k("./zlib/gzheader"),C=Object.prototype.toString;function u(c){if(!(this instanceof u))return new u(c);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},c||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,0===g.windowBits&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||c&&c.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&0==(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var h=f.inflateInit2(this.strm,g.windowBits);if(h!==m.Z_OK)throw new Error(S[h]);this.header=new y,f.inflateGetHeader(this.strm,this.header)}function v(c,g){var h=new u(g);if(h.push(c,!0),h.err)throw h.msg||S[h.err];return h.result}u.prototype.push=function(c,g){var h,_,E,z,A,W,j=this.strm,G=this.options.chunkSize,I=this.options.dictionary,K=!1;if(this.ended)return!1;_=g===~~g?g:!0===g?m.Z_FINISH:m.Z_NO_FLUSH,j.input="string"==typeof c?o.binstring2buf(c):"[object ArrayBuffer]"===C.call(c)?new Uint8Array(c):c,j.next_in=0,j.avail_in=j.input.length;do{if(0===j.avail_out&&(j.output=new p.Buf8(G),j.next_out=0,j.avail_out=G),(h=f.inflate(j,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&I&&(W="string"==typeof I?o.string2buf(I):"[object ArrayBuffer]"===C.call(I)?new Uint8Array(I):I,h=f.inflateSetDictionary(this.strm,W)),h===m.Z_BUF_ERROR&&!0===K&&(h=m.Z_OK,K=!1),h!==m.Z_STREAM_END&&h!==m.Z_OK)return this.onEnd(h),!(this.ended=!0);j.next_out&&(0!==j.avail_out&&h!==m.Z_STREAM_END&&(0!==j.avail_in||_!==m.Z_FINISH&&_!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(E=o.utf8border(j.output,j.next_out),z=j.next_out-E,A=o.buf2string(j.output,E),j.next_out=z,j.avail_out=G-z,z&&p.arraySet(j.output,j.output,E,z,0),this.onData(A)):this.onData(p.shrinkBuf(j.output,j.next_out)))),0===j.avail_in&&0===j.avail_out&&(K=!0)}while((0<j.avail_in||0===j.avail_out)&&h!==m.Z_STREAM_END);return h===m.Z_STREAM_END&&(_=m.Z_FINISH),_===m.Z_FINISH?(h=f.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,h===m.Z_OK):_!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(j.avail_out=0))},u.prototype.onData=function(c){this.chunks.push(c)},u.prototype.onEnd=function(c){c===m.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):p.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},N.Inflate=u,N.inflate=v,N.inflateRaw=function(c,g){return(g=g||{}).raw=!0,v(c,g)},N.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(k,U,N){"use strict";var f="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;N.assign=function(m){for(var S=Array.prototype.slice.call(arguments,1);S.length;){var P=S.shift();if(P){if("object"!=typeof P)throw new TypeError(P+"must be non-object");for(var y in P)P.hasOwnProperty(y)&&(m[y]=P[y])}}return m},N.shrinkBuf=function(m,S){return m.length===S?m:m.subarray?m.subarray(0,S):(m.length=S,m)};var p={arraySet:function(m,S,P,y,C){if(S.subarray&&m.subarray)m.set(S.subarray(P,P+y),C);else for(var u=0;u<y;u++)m[C+u]=S[P+u]},flattenChunks:function(m){var S,P,y,C,u,v;for(S=y=0,P=m.length;S<P;S++)y+=m[S].length;for(v=new Uint8Array(y),S=C=0,P=m.length;S<P;S++)v.set(u=m[S],C),C+=u.length;return v}},o={arraySet:function(m,S,P,y,C){for(var u=0;u<y;u++)m[C+u]=S[P+u]},flattenChunks:function(m){return[].concat.apply([],m)}};N.setTyped=function(m){m?(N.Buf8=Uint8Array,N.Buf16=Uint16Array,N.Buf32=Int32Array,N.assign(N,p)):(N.Buf8=Array,N.Buf16=Array,N.Buf32=Array,N.assign(N,o))},N.setTyped(f)},{}],42:[function(k,U,N){"use strict";var f=k("./common"),p=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(y){p=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(y){o=!1}for(var m=new f.Buf8(256),S=0;S<256;S++)m[S]=252<=S?6:248<=S?5:240<=S?4:224<=S?3:192<=S?2:1;function P(y,C){if(C<65537&&(y.subarray&&o||!y.subarray&&p))return String.fromCharCode.apply(null,f.shrinkBuf(y,C));for(var u="",v=0;v<C;v++)u+=String.fromCharCode(y[v]);return u}m[254]=m[254]=1,N.string2buf=function(y){var C,u,v,c,g,h=y.length,_=0;for(c=0;c<h;c++)55296==(64512&(u=y.charCodeAt(c)))&&c+1<h&&56320==(64512&(v=y.charCodeAt(c+1)))&&(u=65536+(u-55296<<10)+(v-56320),c++),_+=u<128?1:u<2048?2:u<65536?3:4;for(C=new f.Buf8(_),c=g=0;g<_;c++)55296==(64512&(u=y.charCodeAt(c)))&&c+1<h&&56320==(64512&(v=y.charCodeAt(c+1)))&&(u=65536+(u-55296<<10)+(v-56320),c++),u<128?C[g++]=u:(u<2048?C[g++]=192|u>>>6:(u<65536?C[g++]=224|u>>>12:(C[g++]=240|u>>>18,C[g++]=128|u>>>12&63),C[g++]=128|u>>>6&63),C[g++]=128|63&u);return C},N.buf2binstring=function(y){return P(y,y.length)},N.binstring2buf=function(y){for(var C=new f.Buf8(y.length),u=0,v=C.length;u<v;u++)C[u]=y.charCodeAt(u);return C},N.buf2string=function(y,C){var u,v,c,g,h=C||y.length,_=new Array(2*h);for(u=v=0;u<h;)if((c=y[u++])<128)_[v++]=c;else if(4<(g=m[c]))_[v++]=65533,u+=g-1;else{for(c&=2===g?31:3===g?15:7;1<g&&u<h;)c=c<<6|63&y[u++],g--;1<g?_[v++]=65533:c<65536?_[v++]=c:(_[v++]=55296|(c-=65536)>>10&1023,_[v++]=56320|1023&c)}return P(_,v)},N.utf8border=function(y,C){var u;for((C=C||y.length)>y.length&&(C=y.length),u=C-1;0<=u&&128==(192&y[u]);)u--;return u<0||0===u?C:u+m[y[u]]>C?u:C}},{"./common":41}],43:[function(k,U,N){"use strict";U.exports=function(f,p,o,m){for(var S=65535&f|0,P=f>>>16&65535|0,y=0;0!==o;){for(o-=y=2e3<o?2e3:o;P=P+(S=S+p[m++]|0)|0,--y;);S%=65521,P%=65521}return S|P<<16|0}},{}],44:[function(k,U,N){"use strict";U.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(k,U,N){"use strict";var f=function(){for(var p,o=[],m=0;m<256;m++){p=m;for(var S=0;S<8;S++)p=1&p?3988292384^p>>>1:p>>>1;o[m]=p}return o}();U.exports=function(p,o,m,S){var P=f,y=S+m;p^=-1;for(var C=S;C<y;C++)p=p>>>8^P[255&(p^o[C])];return-1^p}},{}],46:[function(k,U,N){"use strict";var f,p=k("../utils/common"),o=k("./trees"),m=k("./adler32"),S=k("./crc32"),P=k("./messages"),v=-2,K=258,st=262,L=113;function ct(a,Z){return a.msg=P[Z],Z}function X(a){return(a<<1)-(4<a?9:0)}function it(a){for(var Z=a.length;0<=--Z;)a[Z]=0}function T(a){var Z=a.state,R=Z.pending;R>a.avail_out&&(R=a.avail_out),0!==R&&(p.arraySet(a.output,Z.pending_buf,Z.pending_out,R,a.next_out),a.next_out+=R,Z.pending_out+=R,a.total_out+=R,a.avail_out-=R,Z.pending-=R,0===Z.pending&&(Z.pending_out=0))}function B(a,Z){o._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,Z),a.block_start=a.strstart,T(a.strm)}function at(a,Z){a.pending_buf[a.pending++]=Z}function tt(a,Z){a.pending_buf[a.pending++]=Z>>>8&255,a.pending_buf[a.pending++]=255&Z}function Q(a,Z){var R,b,d=a.max_chain_length,M=a.strstart,$=a.prev_length,H=a.nice_match,O=a.strstart>a.w_size-st?a.strstart-(a.w_size-st):0,q=a.window,et=a.w_mask,J=a.prev,x=a.strstart+K,pt=q[M+$-1],ft=q[M+$];a.prev_length>=a.good_match&&(d>>=2),H>a.lookahead&&(H=a.lookahead);do{if(q[(R=Z)+$]===ft&&q[R+$-1]===pt&&q[R]===q[M]&&q[++R]===q[M+1]){M+=2,R++;do{}while(q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&q[++M]===q[++R]&&M<x);if(b=K-(x-M),M=x-K,$<b){if(a.match_start=Z,H<=($=b))break;pt=q[M+$-1],ft=q[M+$]}}}while((Z=J[Z&et])>O&&0!=--d);return $<=a.lookahead?$:a.lookahead}function kt(a){var Z,R,b,d,M,$,H,O,q,et,J=a.w_size;do{if(d=a.window_size-a.lookahead-a.strstart,a.strstart>=J+(J-st)){for(p.arraySet(a.window,a.window,J,J,0),a.match_start-=J,a.strstart-=J,a.block_start-=J,Z=R=a.hash_size;b=a.head[--Z],a.head[Z]=J<=b?b-J:0,--R;);for(Z=R=J;b=a.prev[--Z],a.prev[Z]=J<=b?b-J:0,--R;);d+=J}if(0===a.strm.avail_in)break;if(H=a.window,O=a.strstart+a.lookahead,et=void 0,(q=d)<(et=($=a.strm).avail_in)&&(et=q),R=0===et?0:($.avail_in-=et,p.arraySet(H,$.input,$.next_in,et,O),1===$.state.wrap?$.adler=m($.adler,H,et,O):2===$.state.wrap&&($.adler=S($.adler,H,et,O)),$.next_in+=et,$.total_in+=et,et),a.lookahead+=R,a.lookahead+a.insert>=3)for(a.ins_h=a.window[M=a.strstart-a.insert],a.ins_h=(a.ins_h<<a.hash_shift^a.window[M+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[M+3-1])&a.hash_mask,a.prev[M&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=M,M++,a.insert--,!(a.lookahead+a.insert<3)););}while(a.lookahead<st&&0!==a.strm.avail_in)}function Ct(a,Z){for(var R,b;;){if(a.lookahead<st){if(kt(a),a.lookahead<st&&0===Z)return 1;if(0===a.lookahead)break}if(R=0,a.lookahead>=3&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,R=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==R&&a.strstart-R<=a.w_size-st&&(a.match_length=Q(a,R)),a.match_length>=3)if(b=o._tr_tally(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=3){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,R=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,0!=--a.match_length;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else b=o._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(b&&(B(a,!1),0===a.strm.avail_out))return 1}return a.insert=a.strstart<2?a.strstart:2,4===Z?(B(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(B(a,!1),0===a.strm.avail_out)?1:2}function dt(a,Z){for(var R,b,d;;){if(a.lookahead<st){if(kt(a),a.lookahead<st&&0===Z)return 1;if(0===a.lookahead)break}if(R=0,a.lookahead>=3&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,R=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,0!==R&&a.prev_length<a.max_lazy_match&&a.strstart-R<=a.w_size-st&&(a.match_length=Q(a,R),a.match_length<=5&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2)),a.prev_length>=3&&a.match_length<=a.prev_length){for(d=a.strstart+a.lookahead-3,b=o._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-3),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=d&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,R=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!=--a.prev_length;);if(a.match_available=0,a.match_length=2,a.strstart++,b&&(B(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((b=o._tr_tally(a,0,a.window[a.strstart-1]))&&B(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(b=o._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<2?a.strstart:2,4===Z?(B(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(B(a,!1),0===a.strm.avail_out)?1:2}function mt(a,Z,R,b,d){this.good_length=a,this.max_lazy=Z,this.nice_length=R,this.max_chain=b,this.func=d}function wt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new p.Buf16(1146),this.dyn_dtree=new p.Buf16(122),this.bl_tree=new p.Buf16(78),it(this.dyn_ltree),it(this.dyn_dtree),it(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new p.Buf16(16),this.heap=new p.Buf16(573),it(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new p.Buf16(573),it(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _t(a){var Z;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=2,(Z=a.state).pending=0,Z.pending_out=0,Z.wrap<0&&(Z.wrap=-Z.wrap),Z.status=Z.wrap?42:L,a.adler=2===Z.wrap?0:1,Z.last_flush=0,o._tr_init(Z),0):ct(a,v)}function Pt(a){var R,Z=_t(a);return 0===Z&&((R=a.state).window_size=2*R.w_size,it(R.head),R.max_lazy_match=f[R.level].max_lazy,R.good_match=f[R.level].good_length,R.nice_match=f[R.level].nice_length,R.max_chain_length=f[R.level].max_chain,R.strstart=0,R.block_start=0,R.lookahead=0,R.insert=0,R.match_length=R.prev_length=2,R.match_available=0,R.ins_h=0),Z}function Nt(a,Z,R,b,d,M){if(!a)return v;var $=1;if(-1===Z&&(Z=6),b<0?($=0,b=-b):15<b&&($=2,b-=16),d<1||9<d||8!==R||b<8||15<b||Z<0||9<Z||M<0||4<M)return ct(a,v);8===b&&(b=9);var H=new wt;return(a.state=H).strm=a,H.wrap=$,H.gzhead=null,H.w_bits=b,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=d+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+3-1)/3),H.window=new p.Buf8(2*H.w_size),H.head=new p.Buf16(H.hash_size),H.prev=new p.Buf16(H.w_size),H.lit_bufsize=1<<d+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new p.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=Z,H.strategy=M,H.method=R,Pt(a)}f=[new mt(0,0,0,0,function(a,Z){var R=65535;for(R>a.pending_buf_size-5&&(R=a.pending_buf_size-5);;){if(a.lookahead<=1){if(kt(a),0===a.lookahead&&0===Z)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var b=a.block_start+R;if((0===a.strstart||a.strstart>=b)&&(a.lookahead=a.strstart-b,a.strstart=b,B(a,!1),0===a.strm.avail_out)||a.strstart-a.block_start>=a.w_size-st&&(B(a,!1),0===a.strm.avail_out))return 1}return a.insert=0,4===Z?(B(a,!0),0===a.strm.avail_out?3:4):(a.strstart>a.block_start&&B(a,!1),1)}),new mt(4,4,8,4,Ct),new mt(4,5,16,8,Ct),new mt(4,6,32,32,Ct),new mt(4,4,16,16,dt),new mt(8,16,32,32,dt),new mt(8,16,128,128,dt),new mt(8,32,128,256,dt),new mt(32,128,258,1024,dt),new mt(32,258,258,4096,dt)],N.deflateInit=function(a,Z){return Nt(a,Z,8,15,8,0)},N.deflateInit2=Nt,N.deflateReset=Pt,N.deflateResetKeep=_t,N.deflateSetHeader=function(a,Z){return a&&a.state?2!==a.state.wrap?v:(a.state.gzhead=Z,0):v},N.deflate=function(a,Z){var R,b,d,M;if(!a||!a.state||5<Z||Z<0)return a?ct(a,v):v;if(b=a.state,!a.output||!a.input&&0!==a.avail_in||666===b.status&&4!==Z)return ct(a,0===a.avail_out?-5:v);if(b.strm=a,R=b.last_flush,b.last_flush=Z,42===b.status)if(2===b.wrap)a.adler=0,at(b,31),at(b,139),at(b,8),b.gzhead?(at(b,(b.gzhead.text?1:0)+(b.gzhead.hcrc?2:0)+(b.gzhead.extra?4:0)+(b.gzhead.name?8:0)+(b.gzhead.comment?16:0)),at(b,255&b.gzhead.time),at(b,b.gzhead.time>>8&255),at(b,b.gzhead.time>>16&255),at(b,b.gzhead.time>>24&255),at(b,9===b.level?2:2<=b.strategy||b.level<2?4:0),at(b,255&b.gzhead.os),b.gzhead.extra&&b.gzhead.extra.length&&(at(b,255&b.gzhead.extra.length),at(b,b.gzhead.extra.length>>8&255)),b.gzhead.hcrc&&(a.adler=S(a.adler,b.pending_buf,b.pending,0)),b.gzindex=0,b.status=69):(at(b,0),at(b,0),at(b,0),at(b,0),at(b,0),at(b,9===b.level?2:2<=b.strategy||b.level<2?4:0),at(b,3),b.status=L);else{var $=8+(b.w_bits-8<<4)<<8;$|=(2<=b.strategy||b.level<2?0:b.level<6?1:6===b.level?2:3)<<6,0!==b.strstart&&($|=32),$+=31-$%31,b.status=L,tt(b,$),0!==b.strstart&&(tt(b,a.adler>>>16),tt(b,65535&a.adler)),a.adler=1}if(69===b.status)if(b.gzhead.extra){for(d=b.pending;b.gzindex<(65535&b.gzhead.extra.length)&&(b.pending!==b.pending_buf_size||(b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),T(a),d=b.pending,b.pending!==b.pending_buf_size));)at(b,255&b.gzhead.extra[b.gzindex]),b.gzindex++;b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),b.gzindex===b.gzhead.extra.length&&(b.gzindex=0,b.status=73)}else b.status=73;if(73===b.status)if(b.gzhead.name){d=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),T(a),d=b.pending,b.pending===b.pending_buf_size)){M=1;break}M=b.gzindex<b.gzhead.name.length?255&b.gzhead.name.charCodeAt(b.gzindex++):0,at(b,M)}while(0!==M);b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),0===M&&(b.gzindex=0,b.status=91)}else b.status=91;if(91===b.status)if(b.gzhead.comment){d=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),T(a),d=b.pending,b.pending===b.pending_buf_size)){M=1;break}M=b.gzindex<b.gzhead.comment.length?255&b.gzhead.comment.charCodeAt(b.gzindex++):0,at(b,M)}while(0!==M);b.gzhead.hcrc&&b.pending>d&&(a.adler=S(a.adler,b.pending_buf,b.pending-d,d)),0===M&&(b.status=103)}else b.status=103;if(103===b.status&&(b.gzhead.hcrc?(b.pending+2>b.pending_buf_size&&T(a),b.pending+2<=b.pending_buf_size&&(at(b,255&a.adler),at(b,a.adler>>8&255),a.adler=0,b.status=L)):b.status=L),0!==b.pending){if(T(a),0===a.avail_out)return b.last_flush=-1,0}else if(0===a.avail_in&&X(Z)<=X(R)&&4!==Z)return ct(a,-5);if(666===b.status&&0!==a.avail_in)return ct(a,-5);if(0!==a.avail_in||0!==b.lookahead||0!==Z&&666!==b.status){var H=2===b.strategy?function(O,q){for(var et;;){if(0===O.lookahead&&(kt(O),0===O.lookahead)){if(0===q)return 1;break}if(O.match_length=0,et=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++,et&&(B(O,!1),0===O.strm.avail_out))return 1}return O.insert=0,4===q?(B(O,!0),0===O.strm.avail_out?3:4):O.last_lit&&(B(O,!1),0===O.strm.avail_out)?1:2}(b,Z):3===b.strategy?function(O,q){for(var et,J,x,pt,ft=O.window;;){if(O.lookahead<=K){if(kt(O),O.lookahead<=K&&0===q)return 1;if(0===O.lookahead)break}if(O.match_length=0,O.lookahead>=3&&0<O.strstart&&(J=ft[x=O.strstart-1])===ft[++x]&&J===ft[++x]&&J===ft[++x]){pt=O.strstart+K;do{}while(J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&J===ft[++x]&&x<pt);O.match_length=K-(pt-x),O.match_length>O.lookahead&&(O.match_length=O.lookahead)}if(O.match_length>=3?(et=o._tr_tally(O,1,O.match_length-3),O.lookahead-=O.match_length,O.strstart+=O.match_length,O.match_length=0):(et=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++),et&&(B(O,!1),0===O.strm.avail_out))return 1}return O.insert=0,4===q?(B(O,!0),0===O.strm.avail_out?3:4):O.last_lit&&(B(O,!1),0===O.strm.avail_out)?1:2}(b,Z):f[b.level].func(b,Z);if(3!==H&&4!==H||(b.status=666),1===H||3===H)return 0===a.avail_out&&(b.last_flush=-1),0;if(2===H&&(1===Z?o._tr_align(b):5!==Z&&(o._tr_stored_block(b,0,0,!1),3===Z&&(it(b.head),0===b.lookahead&&(b.strstart=0,b.block_start=0,b.insert=0))),T(a),0===a.avail_out))return b.last_flush=-1,0}return 4!==Z?0:b.wrap<=0?1:(2===b.wrap?(at(b,255&a.adler),at(b,a.adler>>8&255),at(b,a.adler>>16&255),at(b,a.adler>>24&255),at(b,255&a.total_in),at(b,a.total_in>>8&255),at(b,a.total_in>>16&255),at(b,a.total_in>>24&255)):(tt(b,a.adler>>>16),tt(b,65535&a.adler)),T(a),0<b.wrap&&(b.wrap=-b.wrap),0!==b.pending?0:1)},N.deflateEnd=function(a){var Z;return a&&a.state?42!==(Z=a.state.status)&&69!==Z&&73!==Z&&91!==Z&&103!==Z&&Z!==L&&666!==Z?ct(a,v):(a.state=null,Z===L?ct(a,-3):0):v},N.deflateSetDictionary=function(a,Z){var R,b,d,M,$,H,O,q,et=Z.length;if(!a||!a.state||2===(M=(R=a.state).wrap)||1===M&&42!==R.status||R.lookahead)return v;for(1===M&&(a.adler=m(a.adler,Z,et,0)),R.wrap=0,et>=R.w_size&&(0===M&&(it(R.head),R.strstart=0,R.block_start=0,R.insert=0),q=new p.Buf8(R.w_size),p.arraySet(q,Z,et-R.w_size,R.w_size,0),Z=q,et=R.w_size),$=a.avail_in,H=a.next_in,O=a.input,a.avail_in=et,a.next_in=0,a.input=Z,kt(R);R.lookahead>=3;){for(b=R.strstart,d=R.lookahead-2;R.ins_h=(R.ins_h<<R.hash_shift^R.window[b+3-1])&R.hash_mask,R.prev[b&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=b,b++,--d;);R.strstart=b,R.lookahead=2,kt(R)}return R.strstart+=R.lookahead,R.block_start=R.strstart,R.insert=R.lookahead,R.lookahead=0,R.match_length=R.prev_length=2,R.match_available=0,a.next_in=H,a.input=O,a.avail_in=$,R.wrap=M,0},N.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(k,U,N){"use strict";U.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(k,U,N){"use strict";U.exports=function(f,p){var o,m,S,P,y,C,u,v,c,g,h,_,E,z,A,W,j,G,I,K,st,w,L,n,D;n=f.input,S=(m=f.next_in)+(f.avail_in-5),D=f.output,y=(P=f.next_out)-(p-f.avail_out),C=P+(f.avail_out-257),u=(o=f.state).dmax,v=o.wsize,c=o.whave,g=o.wnext,h=o.window,_=o.hold,E=o.bits,z=o.lencode,A=o.distcode,W=(1<<o.lenbits)-1,j=(1<<o.distbits)-1;t:do{E<15&&(_+=n[m++]<<E,_+=n[m++]<<(E+=8),E+=8),G=z[_&W];e:for(;;){if(_>>>=I=G>>>24,E-=I,0==(I=G>>>16&255))D[P++]=65535&G;else{if(!(16&I)){if(0==(64&I)){G=z[(65535&G)+(_&(1<<I)-1)];continue e}if(32&I){o.mode=12;break t}f.msg="invalid literal/length code",o.mode=30;break t}K=65535&G,(I&=15)&&(E<I&&(_+=n[m++]<<E,E+=8),K+=_&(1<<I)-1,_>>>=I,E-=I),E<15&&(_+=n[m++]<<E,_+=n[m++]<<(E+=8),E+=8),G=A[_&j];r:for(;;){if(_>>>=I=G>>>24,E-=I,!(16&(I=G>>>16&255))){if(0==(64&I)){G=A[(65535&G)+(_&(1<<I)-1)];continue r}f.msg="invalid distance code",o.mode=30;break t}if(st=65535&G,E<(I&=15)&&(_+=n[m++]<<E,(E+=8)<I&&(_+=n[m++]<<E,E+=8)),u<(st+=_&(1<<I)-1)){f.msg="invalid distance too far back",o.mode=30;break t}if(_>>>=I,E-=I,(I=P-y)<st){if(c<(I=st-I)&&o.sane){f.msg="invalid distance too far back",o.mode=30;break t}if(L=h,(w=0)===g){if(w+=v-I,I<K){for(K-=I;D[P++]=h[w++],--I;);w=P-st,L=D}}else if(g<I){if(w+=v+g-I,(I-=g)<K){for(K-=I;D[P++]=h[w++],--I;);if(w=0,g<K){for(K-=I=g;D[P++]=h[w++],--I;);w=P-st,L=D}}}else if(w+=g-I,I<K){for(K-=I;D[P++]=h[w++],--I;);w=P-st,L=D}for(;2<K;)D[P++]=L[w++],D[P++]=L[w++],D[P++]=L[w++],K-=3;K&&(D[P++]=L[w++],1<K&&(D[P++]=L[w++]))}else{for(w=P-st;D[P++]=D[w++],D[P++]=D[w++],D[P++]=D[w++],2<(K-=3););K&&(D[P++]=D[w++],1<K&&(D[P++]=D[w++]))}break}}break}}while(m<S&&P<C);m-=K=E>>3,_&=(1<<(E-=K<<3))-1,f.next_in=m,f.next_out=P,f.avail_in=m<S?S-m+5:5-(m-S),f.avail_out=P<C?C-P+257:257-(P-C),o.hold=_,o.bits=E}},{}],49:[function(k,U,N){"use strict";var f=k("../utils/common"),p=k("./adler32"),o=k("./crc32"),m=k("./inffast"),S=k("./inftrees"),u=-2;function h(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(w){var L;return w&&w.state?(w.total_in=w.total_out=(L=w.state).total=0,w.msg="",L.wrap&&(w.adler=1&L.wrap),L.mode=1,L.last=0,L.havedict=0,L.dmax=32768,L.head=null,L.hold=0,L.bits=0,L.lencode=L.lendyn=new f.Buf32(852),L.distcode=L.distdyn=new f.Buf32(592),L.sane=1,L.back=-1,0):u}function z(w){var L;return w&&w.state?((L=w.state).wsize=0,L.whave=0,L.wnext=0,E(w)):u}function A(w,L){var n,D;return w&&w.state?(D=w.state,L<0?(n=0,L=-L):(n=1+(L>>4),L<48&&(L&=15)),L&&(L<8||15<L)?u:(null!==D.window&&D.wbits!==L&&(D.window=null),D.wrap=n,D.wbits=L,z(w))):u}function W(w,L){var n,D;return w?(D=new _,(w.state=D).window=null,0!==(n=A(w,L))&&(w.state=null),n):u}var j,G,I=!0;function K(w){if(I){var L;for(j=new f.Buf32(512),G=new f.Buf32(32),L=0;L<144;)w.lens[L++]=8;for(;L<256;)w.lens[L++]=9;for(;L<280;)w.lens[L++]=7;for(;L<288;)w.lens[L++]=8;for(S(1,w.lens,0,288,j,0,w.work,{bits:9}),L=0;L<32;)w.lens[L++]=5;S(2,w.lens,0,32,G,0,w.work,{bits:5}),I=!1}w.lencode=j,w.lenbits=9,w.distcode=G,w.distbits=5}function st(w,L,n,D){var ot,V=w.state;return null===V.window&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new f.Buf8(V.wsize)),D>=V.wsize?(f.arraySet(V.window,L,n-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(D<(ot=V.wsize-V.wnext)&&(ot=D),f.arraySet(V.window,L,n-D,ot,V.wnext),(D-=ot)?(f.arraySet(V.window,L,n-D,D,0),V.wnext=D,V.whave=V.wsize):(V.wnext+=ot,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=ot))),0}N.inflateReset=z,N.inflateReset2=A,N.inflateResetKeep=E,N.inflateInit=function(w){return W(w,15)},N.inflateInit2=W,N.inflate=function(w,L){var n,D,ot,V,ct,X,it,T,B,at,tt,Q,kt,Ct,dt,mt,wt,_t,Pt,Nt,a,Z,R,b,d=0,M=new f.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&0!==w.avail_in)return u;12===(n=w.state).mode&&(n.mode=13),ct=w.next_out,ot=w.output,V=w.next_in,D=w.input,T=n.hold,B=n.bits,at=X=w.avail_in,tt=it=w.avail_out,Z=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;B<16;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(2&n.wrap&&35615===T){M[n.check=0]=255&T,M[1]=T>>>8&255,n.check=o(n.check,M,2,0),B=T=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&T)<<8)+(T>>8))%31){w.msg="incorrect header check",n.mode=30;break}if(8!=(15&T)){w.msg="unknown compression method",n.mode=30;break}if(B-=4,a=8+(15&(T>>>=4)),0===n.wbits)n.wbits=a;else if(a>n.wbits){w.msg="invalid window size",n.mode=30;break}n.dmax=1<<a,w.adler=n.check=1,n.mode=512&T?10:12,B=T=0;break;case 2:for(;B<16;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(n.flags=T,8!=(255&n.flags)){w.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){w.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=T>>8&1),512&n.flags&&(M[0]=255&T,M[1]=T>>>8&255,n.check=o(n.check,M,2,0)),B=T=0,n.mode=3;case 3:for(;B<32;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.head&&(n.head.time=T),512&n.flags&&(M[0]=255&T,M[1]=T>>>8&255,M[2]=T>>>16&255,M[3]=T>>>24&255,n.check=o(n.check,M,4,0)),B=T=0,n.mode=4;case 4:for(;B<16;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.head&&(n.head.xflags=255&T,n.head.os=T>>8),512&n.flags&&(M[0]=255&T,M[1]=T>>>8&255,n.check=o(n.check,M,2,0)),B=T=0,n.mode=5;case 5:if(1024&n.flags){for(;B<16;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.length=T,n.head&&(n.head.extra_len=T),512&n.flags&&(M[0]=255&T,M[1]=T>>>8&255,n.check=o(n.check,M,2,0)),B=T=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(X<(Q=n.length)&&(Q=X),Q&&(n.head&&(a=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),f.arraySet(n.head.extra,D,V,Q,a)),512&n.flags&&(n.check=o(n.check,D,Q,V)),X-=Q,V+=Q,n.length-=Q),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===X)break t;for(Q=0;a=D[V+Q++],n.head&&a&&n.length<65536&&(n.head.name+=String.fromCharCode(a)),a&&Q<X;);if(512&n.flags&&(n.check=o(n.check,D,Q,V)),X-=Q,V+=Q,a)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===X)break t;for(Q=0;a=D[V+Q++],n.head&&a&&n.length<65536&&(n.head.comment+=String.fromCharCode(a)),a&&Q<X;);if(512&n.flags&&(n.check=o(n.check,D,Q,V)),X-=Q,V+=Q,a)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;B<16;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(T!==(65535&n.check)){w.msg="header crc mismatch",n.mode=30;break}B=T=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),w.adler=n.check=0,n.mode=12;break;case 10:for(;B<32;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}w.adler=n.check=h(T),B=T=0,n.mode=11;case 11:if(0===n.havedict)return w.next_out=ct,w.avail_out=it,w.next_in=V,w.avail_in=X,n.hold=T,n.bits=B,2;w.adler=n.check=1,n.mode=12;case 12:if(5===L||6===L)break t;case 13:if(n.last){T>>>=7&B,B-=7&B,n.mode=27;break}for(;B<3;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}switch(n.last=1&T,B-=1,3&(T>>>=1)){case 0:n.mode=14;break;case 1:if(K(n),n.mode=20,6!==L)break;T>>>=2,B-=2;break t;case 2:n.mode=17;break;case 3:w.msg="invalid block type",n.mode=30}T>>>=2,B-=2;break;case 14:for(T>>>=7&B,B-=7&B;B<32;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if((65535&T)!=(T>>>16^65535)){w.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&T,B=T=0,n.mode=15,6===L)break t;case 15:n.mode=16;case 16:if(Q=n.length){if(X<Q&&(Q=X),it<Q&&(Q=it),0===Q)break t;f.arraySet(ot,D,V,Q,ct),X-=Q,V+=Q,it-=Q,ct+=Q,n.length-=Q;break}n.mode=12;break;case 17:for(;B<14;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(n.nlen=257+(31&T),B-=5,n.ndist=1+(31&(T>>>=5)),B-=5,n.ncode=4+(15&(T>>>=5)),T>>>=4,B-=4,286<n.nlen||30<n.ndist){w.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;B<3;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.lens[$[n.have++]]=7&T,T>>>=3,B-=3}for(;n.have<19;)n.lens[$[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Z=S(0,n.lens,0,19,n.lencode,0,n.work,R={bits:n.lenbits}),n.lenbits=R.bits,Z){w.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;mt=(d=n.lencode[T&(1<<n.lenbits)-1])>>>16&255,wt=65535&d,!((dt=d>>>24)<=B);){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(wt<16)T>>>=dt,B-=dt,n.lens[n.have++]=wt;else{if(16===wt){for(b=dt+2;B<b;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(T>>>=dt,B-=dt,0===n.have){w.msg="invalid bit length repeat",n.mode=30;break}a=n.lens[n.have-1],Q=3+(3&T),T>>>=2,B-=2}else if(17===wt){for(b=dt+3;B<b;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}B-=dt,a=0,Q=3+(7&(T>>>=dt)),T>>>=3,B-=3}else{for(b=dt+7;B<b;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}B-=dt,a=0,Q=11+(127&(T>>>=dt)),T>>>=7,B-=7}if(n.have+Q>n.nlen+n.ndist){w.msg="invalid bit length repeat",n.mode=30;break}for(;Q--;)n.lens[n.have++]=a}}if(30===n.mode)break;if(0===n.lens[256]){w.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,Z=S(1,n.lens,0,n.nlen,n.lencode,0,n.work,R={bits:n.lenbits}),n.lenbits=R.bits,Z){w.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,Z=S(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R={bits:n.distbits}),n.distbits=R.bits,Z){w.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===L)break t;case 20:n.mode=21;case 21:if(6<=X&&258<=it){w.next_out=ct,w.avail_out=it,w.next_in=V,w.avail_in=X,n.hold=T,n.bits=B,m(w,tt),ct=w.next_out,ot=w.output,it=w.avail_out,V=w.next_in,D=w.input,X=w.avail_in,T=n.hold,B=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;mt=(d=n.lencode[T&(1<<n.lenbits)-1])>>>16&255,wt=65535&d,!((dt=d>>>24)<=B);){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(mt&&0==(240&mt)){for(_t=dt,Pt=mt,Nt=wt;mt=(d=n.lencode[Nt+((T&(1<<_t+Pt)-1)>>_t)])>>>16&255,wt=65535&d,!(_t+(dt=d>>>24)<=B);){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}T>>>=_t,B-=_t,n.back+=_t}if(T>>>=dt,B-=dt,n.back+=dt,n.length=wt,0===mt){n.mode=26;break}if(32&mt){n.back=-1,n.mode=12;break}if(64&mt){w.msg="invalid literal/length code",n.mode=30;break}n.extra=15&mt,n.mode=22;case 22:if(n.extra){for(b=n.extra;B<b;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.length+=T&(1<<n.extra)-1,T>>>=n.extra,B-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;mt=(d=n.distcode[T&(1<<n.distbits)-1])>>>16&255,wt=65535&d,!((dt=d>>>24)<=B);){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(0==(240&mt)){for(_t=dt,Pt=mt,Nt=wt;mt=(d=n.distcode[Nt+((T&(1<<_t+Pt)-1)>>_t)])>>>16&255,wt=65535&d,!(_t+(dt=d>>>24)<=B);){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}T>>>=_t,B-=_t,n.back+=_t}if(T>>>=dt,B-=dt,n.back+=dt,64&mt){w.msg="invalid distance code",n.mode=30;break}n.offset=wt,n.extra=15&mt,n.mode=24;case 24:if(n.extra){for(b=n.extra;B<b;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}n.offset+=T&(1<<n.extra)-1,T>>>=n.extra,B-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){w.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===it)break t;if(n.offset>(Q=tt-it)){if((Q=n.offset-Q)>n.whave&&n.sane){w.msg="invalid distance too far back",n.mode=30;break}kt=Q>n.wnext?n.wsize-(Q-=n.wnext):n.wnext-Q,Q>n.length&&(Q=n.length),Ct=n.window}else Ct=ot,kt=ct-n.offset,Q=n.length;for(it<Q&&(Q=it),it-=Q,n.length-=Q;ot[ct++]=Ct[kt++],--Q;);0===n.length&&(n.mode=21);break;case 26:if(0===it)break t;ot[ct++]=n.length,it--,n.mode=21;break;case 27:if(n.wrap){for(;B<32;){if(0===X)break t;X--,T|=D[V++]<<B,B+=8}if(w.total_out+=tt-=it,n.total+=tt,tt&&(w.adler=n.check=n.flags?o(n.check,ot,tt,ct-tt):p(n.check,ot,tt,ct-tt)),tt=it,(n.flags?T:h(T))!==n.check){w.msg="incorrect data check",n.mode=30;break}B=T=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;B<32;){if(0===X)break t;X--,T+=D[V++]<<B,B+=8}if(T!==(4294967295&n.total)){w.msg="incorrect length check",n.mode=30;break}B=T=0}n.mode=29;case 29:Z=1;break t;case 30:Z=-3;break t;case 31:return-4;default:return u}return w.next_out=ct,w.avail_out=it,w.next_in=V,w.avail_in=X,n.hold=T,n.bits=B,(n.wsize||tt!==w.avail_out&&n.mode<30&&(n.mode<27||4!==L))&&st(w,w.output,w.next_out,tt-w.avail_out)?(n.mode=31,-4):(tt-=w.avail_out,w.total_in+=at-=w.avail_in,w.total_out+=tt,n.total+=tt,n.wrap&&tt&&(w.adler=n.check=n.flags?o(n.check,ot,tt,w.next_out-tt):p(n.check,ot,tt,w.next_out-tt)),w.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==at&&0===tt||4===L)&&0===Z&&(Z=-5),Z)},N.inflateEnd=function(w){if(!w||!w.state)return u;var L=w.state;return L.window&&(L.window=null),w.state=null,0},N.inflateGetHeader=function(w,L){var n;return w&&w.state?0==(2&(n=w.state).wrap)?u:((n.head=L).done=!1,0):u},N.inflateSetDictionary=function(w,L){var n,D=L.length;return w&&w.state?0!==(n=w.state).wrap&&11!==n.mode?u:11===n.mode&&p(1,L,D,0)!==n.check?-3:st(w,L,D,D)?(n.mode=31,-4):(n.havedict=1,0):u},N.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(k,U,N){"use strict";var f=k("../utils/common"),p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],S=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];U.exports=function(P,y,C,u,v,c,g,h){var _,E,z,A,W,j,G,I,K,st=h.bits,w=0,L=0,n=0,D=0,ot=0,V=0,ct=0,X=0,it=0,T=0,B=null,at=0,tt=new f.Buf16(16),Q=new f.Buf16(16),kt=null,Ct=0;for(w=0;w<=15;w++)tt[w]=0;for(L=0;L<u;L++)tt[y[C+L]]++;for(ot=st,D=15;1<=D&&0===tt[D];D--);if(D<ot&&(ot=D),0===D)return v[c++]=20971520,v[c++]=20971520,h.bits=1,0;for(n=1;n<D&&0===tt[n];n++);for(ot<n&&(ot=n),w=X=1;w<=15;w++)if(X<<=1,(X-=tt[w])<0)return-1;if(0<X&&(0===P||1!==D))return-1;for(Q[1]=0,w=1;w<15;w++)Q[w+1]=Q[w]+tt[w];for(L=0;L<u;L++)0!==y[C+L]&&(g[Q[y[C+L]]++]=L);if(j=0===P?(B=kt=g,19):1===P?(B=p,at-=257,kt=o,Ct-=257,256):(B=m,kt=S,-1),w=n,W=c,ct=L=T=0,z=-1,A=(it=1<<(V=ot))-1,1===P&&852<it||2===P&&592<it)return 1;for(;;){for(G=w-ct,K=g[L]<j?(I=0,g[L]):g[L]>j?(I=kt[Ct+g[L]],B[at+g[L]]):(I=96,0),_=1<<w-ct,n=E=1<<V;v[W+(T>>ct)+(E-=_)]=G<<24|I<<16|K|0,0!==E;);for(_=1<<w-1;T&_;)_>>=1;if(0!==_?(T&=_-1,T+=_):T=0,L++,0==--tt[w]){if(w===D)break;w=y[C+g[L]]}if(ot<w&&(T&A)!==z){for(0===ct&&(ct=ot),W+=n,X=1<<(V=w-ct);V+ct<D&&!((X-=tt[V+ct])<=0);)V++,X<<=1;if(it+=1<<V,1===P&&852<it||2===P&&592<it)return 1;v[z=T&A]=ot<<24|V<<16|W-c|0}}return 0!==T&&(v[W+T]=w-ct<<24|64<<16|0),h.bits=ot,0}},{"../utils/common":41}],51:[function(k,U,N){"use strict";U.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(k,U,N){"use strict";var f=k("../utils/common");function m(d){for(var M=d.length;0<=--M;)d[M]=0}var y=256,C=286,u=30,g=15,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],st=new Array(576);m(st);var w=new Array(60);m(w);var L=new Array(512);m(L);var n=new Array(256);m(n);var D=new Array(29);m(D);var ot,V,ct,X=new Array(u);function it(d,M,$,H,O){this.static_tree=d,this.extra_bits=M,this.extra_base=$,this.elems=H,this.max_length=O,this.has_stree=d&&d.length}function T(d,M){this.dyn_tree=d,this.max_code=0,this.stat_desc=M}function B(d){return d<256?L[d]:L[256+(d>>>7)]}function at(d,M){d.pending_buf[d.pending++]=255&M,d.pending_buf[d.pending++]=M>>>8&255}function tt(d,M,$){d.bi_valid>16-$?(d.bi_buf|=M<<d.bi_valid&65535,at(d,d.bi_buf),d.bi_buf=M>>16-d.bi_valid,d.bi_valid+=$-16):(d.bi_buf|=M<<d.bi_valid&65535,d.bi_valid+=$)}function Q(d,M,$){tt(d,$[2*M],$[2*M+1])}function kt(d,M){for(var $=0;$|=1&d,d>>>=1,$<<=1,0<--M;);return $>>>1}function Ct(d,M,$){var H,O,q=new Array(16),et=0;for(H=1;H<=g;H++)q[H]=et=et+$[H-1]<<1;for(O=0;O<=M;O++){var J=d[2*O+1];0!==J&&(d[2*O]=kt(q[J]++,J))}}function dt(d){var M;for(M=0;M<C;M++)d.dyn_ltree[2*M]=0;for(M=0;M<u;M++)d.dyn_dtree[2*M]=0;for(M=0;M<19;M++)d.bl_tree[2*M]=0;d.dyn_ltree[512]=1,d.opt_len=d.static_len=0,d.last_lit=d.matches=0}function mt(d){8<d.bi_valid?at(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf),d.bi_buf=0,d.bi_valid=0}function wt(d,M,$,H){var O=2*M,q=2*$;return d[O]<d[q]||d[O]===d[q]&&H[M]<=H[$]}function _t(d,M,$){for(var H=d.heap[$],O=$<<1;O<=d.heap_len&&(O<d.heap_len&&wt(M,d.heap[O+1],d.heap[O],d.depth)&&O++,!wt(M,H,d.heap[O],d.depth));)d.heap[$]=d.heap[O],$=O,O<<=1;d.heap[$]=H}function Pt(d,M,$){var H,O,q,et,J=0;if(0!==d.last_lit)for(;H=d.pending_buf[d.d_buf+2*J]<<8|d.pending_buf[d.d_buf+2*J+1],O=d.pending_buf[d.l_buf+J],J++,0===H?Q(d,O,M):(Q(d,(q=n[O])+y+1,M),0!==(et=j[q])&&tt(d,O-=D[q],et),Q(d,q=B(--H),$),0!==(et=G[q])&&tt(d,H-=X[q],et)),J<d.last_lit;);Q(d,256,M)}function Nt(d,M){var $,H,O,q=M.dyn_tree,et=M.stat_desc.static_tree,J=M.stat_desc.has_stree,x=M.stat_desc.elems,pt=-1;for(d.heap_len=0,d.heap_max=573,$=0;$<x;$++)0!==q[2*$]?(d.heap[++d.heap_len]=pt=$,d.depth[$]=0):q[2*$+1]=0;for(;d.heap_len<2;)q[2*(O=d.heap[++d.heap_len]=pt<2?++pt:0)]=1,d.depth[O]=0,d.opt_len--,J&&(d.static_len-=et[2*O+1]);for(M.max_code=pt,$=d.heap_len>>1;1<=$;$--)_t(d,q,$);for(O=x;$=d.heap[1],d.heap[1]=d.heap[d.heap_len--],_t(d,q,1),H=d.heap[1],d.heap[--d.heap_max]=$,d.heap[--d.heap_max]=H,q[2*O]=q[2*$]+q[2*H],d.depth[O]=(d.depth[$]>=d.depth[H]?d.depth[$]:d.depth[H])+1,q[2*$+1]=q[2*H+1]=O,d.heap[1]=O++,_t(d,q,1),2<=d.heap_len;);d.heap[--d.heap_max]=d.heap[1],function(ft,Et){var Ft,Ot,Ut,yt,Rt,Zt,Tt=Et.dyn_tree,Ht=Et.max_code,Yt=Et.stat_desc.static_tree,Jt=Et.stat_desc.has_stree,Kt=Et.stat_desc.extra_bits,Vt=Et.stat_desc.extra_base,It=Et.stat_desc.max_length,jt=0;for(yt=0;yt<=g;yt++)ft.bl_count[yt]=0;for(Tt[2*ft.heap[ft.heap_max]+1]=0,Ft=ft.heap_max+1;Ft<573;Ft++)It<(yt=Tt[2*Tt[2*(Ot=ft.heap[Ft])+1]+1]+1)&&(yt=It,jt++),Tt[2*Ot+1]=yt,Ht<Ot||(ft.bl_count[yt]++,Rt=0,Vt<=Ot&&(Rt=Kt[Ot-Vt]),ft.opt_len+=(Zt=Tt[2*Ot])*(yt+Rt),Jt&&(ft.static_len+=Zt*(Yt[2*Ot+1]+Rt)));if(0!==jt){do{for(yt=It-1;0===ft.bl_count[yt];)yt--;ft.bl_count[yt]--,ft.bl_count[yt+1]+=2,ft.bl_count[It]--,jt-=2}while(0<jt);for(yt=It;0!==yt;yt--)for(Ot=ft.bl_count[yt];0!==Ot;)Ht<(Ut=ft.heap[--Ft])||(Tt[2*Ut+1]!==yt&&(ft.opt_len+=(yt-Tt[2*Ut+1])*Tt[2*Ut],Tt[2*Ut+1]=yt),Ot--)}}(d,M),Ct(q,pt,d.bl_count)}function a(d,M,$){var H,O,q=-1,et=M[1],J=0,x=7,pt=4;for(0===et&&(x=138,pt=3),M[2*($+1)+1]=65535,H=0;H<=$;H++)O=et,et=M[2*(H+1)+1],++J<x&&O===et||(J<pt?d.bl_tree[2*O]+=J:0!==O?(O!==q&&d.bl_tree[2*O]++,d.bl_tree[32]++):J<=10?d.bl_tree[34]++:d.bl_tree[36]++,q=O,pt=(J=0)===et?(x=138,3):O===et?(x=6,3):(x=7,4))}function Z(d,M,$){var H,O,q=-1,et=M[1],J=0,x=7,pt=4;for(0===et&&(x=138,pt=3),H=0;H<=$;H++)if(O=et,et=M[2*(H+1)+1],!(++J<x&&O===et)){if(J<pt)for(;Q(d,O,d.bl_tree),0!=--J;);else 0!==O?(O!==q&&(Q(d,O,d.bl_tree),J--),Q(d,16,d.bl_tree),tt(d,J-3,2)):J<=10?(Q(d,17,d.bl_tree),tt(d,J-3,3)):(Q(d,18,d.bl_tree),tt(d,J-11,7));q=O,pt=(J=0)===et?(x=138,3):O===et?(x=6,3):(x=7,4)}}m(X);var R=!1;function b(d,M,$,H){var O,q,et;tt(d,0+(H?1:0),3),q=M,et=$,mt(O=d),at(O,et),at(O,~et),f.arraySet(O.pending_buf,O.window,q,et,O.pending),O.pending+=et}N._tr_init=function(d){R||(function(){var M,$,H,O,q,et=new Array(16);for(O=H=0;O<28;O++)for(D[O]=H,M=0;M<1<<j[O];M++)n[H++]=O;for(n[H-1]=O,O=q=0;O<16;O++)for(X[O]=q,M=0;M<1<<G[O];M++)L[q++]=O;for(q>>=7;O<u;O++)for(X[O]=q<<7,M=0;M<1<<G[O]-7;M++)L[256+q++]=O;for($=0;$<=g;$++)et[$]=0;for(M=0;M<=143;)st[2*M+1]=8,M++,et[8]++;for(;M<=255;)st[2*M+1]=9,M++,et[9]++;for(;M<=279;)st[2*M+1]=7,M++,et[7]++;for(;M<=287;)st[2*M+1]=8,M++,et[8]++;for(Ct(st,287,et),M=0;M<u;M++)w[2*M+1]=5,w[2*M]=kt(M,5);ot=new it(st,j,257,C,g),V=new it(w,G,0,u,g),ct=new it(new Array(0),I,0,19,7)}(),R=!0),d.l_desc=new T(d.dyn_ltree,ot),d.d_desc=new T(d.dyn_dtree,V),d.bl_desc=new T(d.bl_tree,ct),d.bi_buf=0,d.bi_valid=0,dt(d)},N._tr_stored_block=b,N._tr_flush_block=function(d,M,$,H){var O,q,et=0;0<d.level?(2===d.strm.data_type&&(d.strm.data_type=function(J){var x,pt=4093624447;for(x=0;x<=31;x++,pt>>>=1)if(1&pt&&0!==J.dyn_ltree[2*x])return 0;if(0!==J.dyn_ltree[18]||0!==J.dyn_ltree[20]||0!==J.dyn_ltree[26])return 1;for(x=32;x<y;x++)if(0!==J.dyn_ltree[2*x])return 1;return 0}(d)),Nt(d,d.l_desc),Nt(d,d.d_desc),et=function(J){var x;for(a(J,J.dyn_ltree,J.l_desc.max_code),a(J,J.dyn_dtree,J.d_desc.max_code),Nt(J,J.bl_desc),x=18;3<=x&&0===J.bl_tree[2*K[x]+1];x--);return J.opt_len+=3*(x+1)+5+5+4,x}(d),(q=d.static_len+3+7>>>3)<=(O=d.opt_len+3+7>>>3)&&(O=q)):O=q=$+5,$+4<=O&&-1!==M?b(d,M,$,H):4===d.strategy||q===O?(tt(d,2+(H?1:0),3),Pt(d,st,w)):(tt(d,4+(H?1:0),3),function(J,x,pt,ft){var Et;for(tt(J,x-257,5),tt(J,pt-1,5),tt(J,ft-4,4),Et=0;Et<ft;Et++)tt(J,J.bl_tree[2*K[Et]+1],3);Z(J,J.dyn_ltree,x-1),Z(J,J.dyn_dtree,pt-1)}(d,d.l_desc.max_code+1,d.d_desc.max_code+1,et+1),Pt(d,d.dyn_ltree,d.dyn_dtree)),dt(d),H&&mt(d)},N._tr_tally=function(d,M,$){return d.pending_buf[d.d_buf+2*d.last_lit]=M>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&M,d.pending_buf[d.l_buf+d.last_lit]=255&$,d.last_lit++,0===M?d.dyn_ltree[2*$]++:(d.matches++,M--,d.dyn_ltree[2*(n[$]+y+1)]++,d.dyn_dtree[2*B(M)]++),d.last_lit===d.lit_bufsize-1},N._tr_align=function(d){var M;tt(d,2,3),Q(d,256,st),16===(M=d).bi_valid?(at(M,M.bi_buf),M.bi_buf=0,M.bi_valid=0):8<=M.bi_valid&&(M.pending_buf[M.pending++]=255&M.bi_buf,M.bi_buf>>=8,M.bi_valid-=8)}},{"../utils/common":41}],53:[function(k,U,N){"use strict";U.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(k,U,N){(function(f){!function(p,o){"use strict";if(!p.setImmediate){var m,S,P,y,C=1,u={},v=!1,c=p.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(p);g=g&&g.setTimeout?g:p,m="[object process]"==={}.toString.call(p.process)?function(z){process.nextTick(function(){_(z)})}:function(){if(p.postMessage&&!p.importScripts){var z=!0,A=p.onmessage;return p.onmessage=function(){z=!1},p.postMessage("","*"),p.onmessage=A,z}}()?(y="setImmediate$"+Math.random()+"$",p.addEventListener?p.addEventListener("message",E,!1):p.attachEvent("onmessage",E),function(z){p.postMessage(y+z,"*")}):p.MessageChannel?((P=new MessageChannel).port1.onmessage=function(z){_(z.data)},function(z){P.port2.postMessage(z)}):c&&"onreadystatechange"in c.createElement("script")?(S=c.documentElement,function(z){var A=c.createElement("script");A.onreadystatechange=function(){_(z),A.onreadystatechange=null,S.removeChild(A),A=null},S.appendChild(A)}):function(z){setTimeout(_,0,z)},g.setImmediate=function(z){"function"!=typeof z&&(z=new Function(""+z));for(var A=new Array(arguments.length-1),W=0;W<A.length;W++)A[W]=arguments[W+1];return u[C]={callback:z,args:A},m(C),C++},g.clearImmediate=h}function h(z){delete u[z]}function _(z){if(v)setTimeout(_,0,z);else{var A=u[z];if(A){v=!0;try{!function(W){var j=W.callback,G=W.args;switch(G.length){case 0:j();break;case 1:j(G[0]);break;case 2:j(G[0],G[1]);break;case 3:j(G[0],G[1],G[2]);break;default:j.apply(undefined,G)}}(A)}finally{h(z),v=!1}}}}function E(z){z.source===p&&"string"==typeof z.data&&0===z.data.indexOf(y)&&_(+z.data.slice(y.length))}}("undefined"==typeof self?void 0===f?this:f:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9840:(At,k,U)=>{"use strict";U.r(k),U.d(k,{CameraModule:()=>sr});var N=U(8583),f=U(8239),p=U(7586),o=(()=>{return(i=o||(o={})).OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",i.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",i.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",i.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",i.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",i.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",i.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",i.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",i.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",i.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",i.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",i.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",i.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",i.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",i.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",i.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",i.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",i.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",i.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",i.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",o;var i})();function P(i){return/^[^"'].*\s.*[^"']$/.test(i)?`'${i}'`:i}function y(i){let t=i.lastIndexOf("/")+1;return[0==t?"":i.substring(0,t),0==t?i:i.substring(t)]}function C(i,t){try{const e="http://docx/";return new URL(i,e+t).toString().substring(e.length)}catch(e){return`${t}${i}`}}function u(i,t){return i.reduce((e,r)=>(e[t(r)]=r,e),{})}function c(i){return i&&"object"==typeof i&&!Array.isArray(i)}function h(i,...t){var r;if(!t.length)return i;const e=t.shift();if(c(i)&&c(e))for(const s in e)c(e[s])?h(null!=(r=i[s])?r:i[s]={},e[s]):i[s]=e[s];return h(i,...t)}function _(i){return Array.isArray(i)?i:[i]}const z_wordml="http://schemas.openxmlformats.org/wordprocessingml/2006/main",A_Dxa={mul:.05,unit:"pt"},A_Emu={mul:1/12700,unit:"pt"},A_FontSize={mul:.5,unit:"pt"},A_Border={mul:.125,unit:"pt",min:.25,max:12},A_Point={mul:1,unit:"pt"},A_Percent={mul:.02,unit:"%"};function W(i,t=A_Dxa){if(null==i||/.+(p[xt]|[%])$/.test(i))return i;var e=parseInt(i)*t.mul;return t.min&&t.max&&(e=function(i,t,e){return t>i?t:e<i?e:i}(e,t.min,t.max)),`${e.toFixed(2)}${t.unit}`}function G(i,t,e){if(i.namespaceURI!=z_wordml)return!1;switch(i.localName){case"color":t.color=e.attr(i,"val");break;case"sz":t.fontSize=e.lengthAttr(i,"val",A_FontSize);break;default:return!1}return!0}class L{elements(t,e=null){const r=[];for(let s=0,l=t.childNodes.length;s<l;s++){let F=t.childNodes.item(s);1==F.nodeType&&(null==e||F.localName==e)&&r.push(F)}return r}element(t,e){for(let r=0,s=t.childNodes.length;r<s;r++){let l=t.childNodes.item(r);if(1==l.nodeType&&l.localName==e)return l}return null}elementAttr(t,e,r){var s=this.element(t,e);return s?this.attr(s,r):void 0}attrs(t){return Array.from(t.attributes)}attr(t,e){for(let r=0,s=t.attributes.length;r<s;r++){let l=t.attributes.item(r);if(l.localName==e)return l.value}return null}intAttr(t,e,r=null){var s=this.attr(t,e);return s?parseInt(s):r}hexAttr(t,e,r=null){var s=this.attr(t,e);return s?parseInt(s,16):r}floatAttr(t,e,r=null){var s=this.attr(t,e);return s?parseFloat(s):r}boolAttr(t,e,r=null){return function(i,t=!1){switch(i){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}(this.attr(t,e),r)}lengthAttr(t,e,r=A_Dxa){return W(this.attr(t,e),r)}}const n=new L;class D{constructor(t,e){this._package=t,this.path=e}load(){var t=this;return(0,f.Z)(function*(){t.rels=yield t._package.loadRelationships(t.path);const e=yield t._package.load(t.path),r=t._package.parseXmlDocument(e);t._package.options.keepOrigin&&(t._xmlDocument=r),t.parseXml(r.firstElementChild)})()}save(){var i;this._package.update(this.path,(i=this._xmlDocument,(new XMLSerializer).serializeToString(i)))}parseXml(t){}}const ot={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function X(i,t){return{id:t.attr(i,"id"),key:t.attr(i,"fontKey"),type:ot[i.localName]}}class it extends D{parseXml(t){this.fonts=function(i,t){return t.elements(i).map(e=>function(i,t){let e={name:t.attr(i,"name"),embedFontRefs:[]};for(let r of t.elements(i))switch(r.localName){case"family":e.family=t.attr(r,"val");break;case"altName":e.altName=t.attr(r,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":e.embedFontRefs.push(X(r,t))}return e}(e,t))}(t,this._package.xmlParser)}}class T{constructor(t,e){this._zip=t,this.options=e,this.xmlParser=new L}get(t){var r;const e=(i=t).startsWith("/")?i.substr(1):i;var i;return null!=(r=this._zip.files[e])?r:this._zip.files[e.replace(/\//g,"\\")]}update(t,e){this._zip.file(t,e)}static load(t,e){return(0,f.Z)(function*(){const r=yield p.loadAsync(t);return new T(r,e)})()}save(t="blob"){return this._zip.generateAsync({type:t})}load(t,e="string"){var r,s;return null!=(s=null==(r=this.get(t))?void 0:r.async(e))?s:Promise.resolve(null)}loadRelationships(t=null){var e=this;return(0,f.Z)(function*(){let r="_rels/.rels";if(null!=t){const[l,F]=y(t);r=`${l}_rels/${F}.rels`}const s=yield e.load(r);return s?function(i,t){return t.elements(i).map(e=>({id:t.attr(e,"Id"),type:t.attr(e,"Type"),target:t.attr(e,"Target"),targetMode:t.attr(e,"TargetMode")}))}(e.parseXmlDocument(s).firstElementChild,e.xmlParser):null})()}parseXmlDocument(t){return function(i,t=!1){t&&(i=i.replace(/<[?].*[?]>/,"")),i=function(i){return 65279===i.charCodeAt(0)?i.substring(1):i}(i);const e=(new DOMParser).parseFromString(i,"application/xml"),r=function(i){var t;return null==(t=i.getElementsByTagName("parsererror")[0])?void 0:t.textContent}(e);if(r)throw new Error(r);return e}(t,this.options.trimXmlDeclaration)}}class at extends D{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.body=this._documentParser.parseDocumentFile(t)}}function tt(i,t){return{type:t.attr(i,"val"),color:t.attr(i,"color"),size:t.lengthAttr(i,"sz",A_Border),offset:t.lengthAttr(i,"space",A_Point),frame:t.boolAttr(i,"frame"),shadow:t.boolAttr(i,"shadow")}}function Q(i,t){var e={};for(let r of t.elements(i))switch(r.localName){case"left":e.left=tt(r,t);break;case"top":e.top=tt(r,t);break;case"right":e.right=tt(r,t);break;case"bottom":e.bottom=tt(r,t)}return e}function Ct(i,t=n){var r,s,e={};for(let l of t.elements(i))switch(l.localName){case"pgSz":e.pageSize={width:t.lengthAttr(l,"w"),height:t.lengthAttr(l,"h"),orientation:t.attr(l,"orient")};break;case"type":e.type=t.attr(l,"val");break;case"pgMar":e.pageMargins={left:t.lengthAttr(l,"left"),right:t.lengthAttr(l,"right"),top:t.lengthAttr(l,"top"),bottom:t.lengthAttr(l,"bottom"),header:t.lengthAttr(l,"header"),footer:t.lengthAttr(l,"footer"),gutter:t.lengthAttr(l,"gutter")};break;case"cols":e.columns=dt(l,t);break;case"headerReference":(null!=(r=e.headerRefs)?r:e.headerRefs=[]).push(wt(l,t));break;case"footerReference":(null!=(s=e.footerRefs)?s:e.footerRefs=[]).push(wt(l,t));break;case"titlePg":e.titlePage=t.boolAttr(l,"val",!0);break;case"pgBorders":e.pageBorders=Q(l,t);break;case"pgNumType":e.pageNumber=mt(l,t)}return e}function dt(i,t){return{numberOfColumns:t.intAttr(i,"num"),space:t.lengthAttr(i,"space"),separator:t.boolAttr(i,"sep"),equalWidth:t.boolAttr(i,"equalWidth",!0),columns:t.elements(i,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function mt(i,t){return{chapSep:t.attr(i,"chapSep"),chapStyle:t.attr(i,"chapStyle"),format:t.attr(i,"fmt"),start:t.intAttr(i,"start")}}function wt(i,t){return{id:t.attr(i,"id"),type:t.attr(i,"type")}}function Pt(i,t){let e={};for(let r of t.elements(i))Nt(r,e,t);return e}function Nt(i,t,e){return!!G(i,t,e)}function a(i,t){let e={};for(let r of t.elements(i))Z(r,e,t);return e}function Z(i,t,e){if(i.namespaceURI!=z_wordml)return!1;if(G(i,t,e))return!0;switch(i.localName){case"tabs":t.tabs=function(i,t){return t.elements(i,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}(i,e);break;case"sectPr":t.sectionProps=Ct(i,e);break;case"numPr":t.numbering=function(i,t){var e={};for(let r of t.elements(i))switch(r.localName){case"numId":e.id=t.attr(r,"val");break;case"ilvl":e.level=t.intAttr(r,"val")}return e}(i,e);break;case"spacing":return t.lineSpacing=function(i,t){return{before:t.lengthAttr(i,"before"),after:t.lengthAttr(i,"after"),line:t.intAttr(i,"line"),lineRule:t.attr(i,"lineRule")}}(i,e),!1;case"textAlignment":return t.textAlignment=e.attr(i,"val"),!1;case"keepLines":t.keepLines=e.boolAttr(i,"val",!0);break;case"keepNext":t.keepNext=e.boolAttr(i,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=e.boolAttr(i,"val",!0);break;case"outlineLvl":t.outlineLevel=e.intAttr(i,"val");break;case"pStyle":t.styleName=e.attr(i,"val");break;case"rPr":t.runProps=Pt(i,e);break;default:return!1}return!0}function M(i,t){let e={id:t.attr(i,"numId"),overrides:[]};for(let r of t.elements(i))switch(r.localName){case"abstractNumId":e.abstractId=t.attr(r,"val");break;case"lvlOverride":e.overrides.push(O(r,t))}return e}function $(i,t){let e={id:t.attr(i,"abstractNumId"),levels:[]};for(let r of t.elements(i))switch(r.localName){case"name":e.name=t.attr(r,"val");break;case"multiLevelType":e.multiLevelType=t.attr(r,"val");break;case"numStyleLink":e.numberingStyleLink=t.attr(r,"val");break;case"styleLink":e.styleLink=t.attr(r,"val");break;case"lvl":e.levels.push(H(r,t))}return e}function H(i,t){let e={level:t.intAttr(i,"ilvl")};for(let r of t.elements(i))switch(r.localName){case"start":e.start=t.attr(r,"val");break;case"lvlRestart":e.restart=t.intAttr(r,"val");break;case"numFmt":e.format=t.attr(r,"val");break;case"lvlText":e.text=t.attr(r,"val");break;case"lvlJc":e.justification=t.attr(r,"val");break;case"lvlPicBulletId":e.bulletPictureId=t.attr(r,"val");break;case"pStyle":e.paragraphStyle=t.attr(r,"val");break;case"pPr":e.paragraphProps=a(r,t);break;case"rPr":e.runProps=Pt(r,t)}return e}function O(i,t){let e={level:t.intAttr(i,"ilvl")};for(let r of t.elements(i))switch(r.localName){case"startOverride":e.start=t.intAttr(r,"val");break;case"lvl":e.numberingLevel=H(r,t)}return e}function q(i,t){var e=t.element(i,"pict"),r=e&&t.element(e,"shape"),s=r&&t.element(r,"imagedata");return s?{id:t.attr(i,"numPicBulletId"),referenceId:t.attr(s,"id"),style:t.attr(r,"style")}:null}class et extends D{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){Object.assign(this,function(i,t){let e={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let r of t.elements(i))switch(r.localName){case"num":e.numberings.push(M(r,t));break;case"abstractNum":e.abstractNumberings.push($(r,t));break;case"numPicBullet":e.bulletPictures.push(q(r,t))}return e}(t,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(t)}}class J extends D{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.styles=this._documentParser.parseStylesFile(t)}}var x=(()=>{return(i=x||(x={})).Document="document",i.Paragraph="paragraph",i.Run="run",i.Break="break",i.NoBreakHyphen="noBreakHyphen",i.Table="table",i.Row="row",i.Cell="cell",i.Hyperlink="hyperlink",i.SmartTag="smartTag",i.Drawing="drawing",i.Image="image",i.Text="text",i.Tab="tab",i.Symbol="symbol",i.BookmarkStart="bookmarkStart",i.BookmarkEnd="bookmarkEnd",i.Footer="footer",i.Header="header",i.FootnoteReference="footnoteReference",i.EndnoteReference="endnoteReference",i.Footnote="footnote",i.Endnote="endnote",i.SimpleField="simpleField",i.ComplexField="complexField",i.Instruction="instruction",i.VmlPicture="vmlPicture",i.MmlMath="mmlMath",i.MmlMathParagraph="mmlMathParagraph",i.MmlFraction="mmlFraction",i.MmlFunction="mmlFunction",i.MmlFunctionName="mmlFunctionName",i.MmlNumerator="mmlNumerator",i.MmlDenominator="mmlDenominator",i.MmlRadical="mmlRadical",i.MmlBase="mmlBase",i.MmlDegree="mmlDegree",i.MmlSuperscript="mmlSuperscript",i.MmlSubscript="mmlSubscript",i.MmlPreSubSuper="mmlPreSubSuper",i.MmlSubArgument="mmlSubArgument",i.MmlSuperArgument="mmlSuperArgument",i.MmlNary="mmlNary",i.MmlDelimiter="mmlDelimiter",i.MmlRun="mmlRun",i.MmlEquationArray="mmlEquationArray",i.MmlLimit="mmlLimit",i.MmlLimitLower="mmlLimitLower",i.MmlMatrix="mmlMatrix",i.MmlMatrixRow="mmlMatrixRow",i.MmlBox="mmlBox",i.MmlBar="mmlBar",i.MmlGroupChar="mmlGroupChar",i.VmlElement="vmlElement",i.Inserted="inserted",i.Deleted="deleted",i.DeletedText="deletedText",i.Comment="comment",i.CommentReference="commentReference",i.CommentRangeStart="commentRangeStart",i.CommentRangeEnd="commentRangeEnd",i.AltChunk="altChunk",x;var i})();class pt{constructor(){this.children=[],this.cssStyle={}}}class ft extends pt{constructor(){super(...arguments),this.type=x.Header}}class Et extends pt{constructor(){super(...arguments),this.type=x.Footer}}class Ft extends D{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(t)}}class Ot extends Ft{createRootElement(){return new ft}}class Ut extends Ft{createRootElement(){return new Et}}function Rt(i){if(void 0!==i)return parseInt(i)}class Zt extends D{parseXml(t){this.props=function(i,t){const e={};for(let r of t.elements(i))switch(r.localName){case"Template":e.template=r.textContent;break;case"Pages":e.pages=Rt(r.textContent);break;case"Words":e.words=Rt(r.textContent);break;case"Characters":e.characters=Rt(r.textContent);break;case"Application":e.application=r.textContent;break;case"Lines":e.lines=Rt(r.textContent);break;case"Paragraphs":e.paragraphs=Rt(r.textContent);break;case"Company":e.company=r.textContent;break;case"AppVersion":e.appVersion=r.textContent}return e}(t,this._package.xmlParser)}}class Ht extends D{parseXml(t){this.props=function(i,t){const e={};for(let r of t.elements(i))switch(r.localName){case"title":e.title=r.textContent;break;case"description":e.description=r.textContent;break;case"subject":e.subject=r.textContent;break;case"creator":e.creator=r.textContent;break;case"keywords":e.keywords=r.textContent;break;case"language":e.language=r.textContent;break;case"lastModifiedBy":e.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(e.revision=parseInt(r.textContent))}return e}(t,this._package.xmlParser)}}class Yt{}function Kt(i,t){var e={name:t.attr(i,"name"),colors:{}};for(let l of t.elements(i)){var r=t.element(l,"srgbClr"),s=t.element(l,"sysClr");r?e.colors[l.localName]=t.attr(r,"val"):s&&(e.colors[l.localName]=t.attr(s,"lastClr"))}return e}function Vt(i,t){var e={name:t.attr(i,"name")};for(let r of t.elements(i))switch(r.localName){case"majorFont":e.majorFont=It(r,t);break;case"minorFont":e.minorFont=It(r,t)}return e}function It(i,t){return{latinTypeface:t.elementAttr(i,"latin","typeface"),eaTypeface:t.elementAttr(i,"ea","typeface"),csTypeface:t.elementAttr(i,"cs","typeface")}}class jt extends D{constructor(t,e){super(t,e)}parseXml(t){this.theme=function(i,t){var e=new Yt,r=t.element(i,"themeElements");for(let s of t.elements(r))switch(s.localName){case"clrScheme":e.colorScheme=Kt(s,t);break;case"fontScheme":e.fontScheme=Vt(s,t)}return e}(t,this._package.xmlParser)}}class ne{}class be extends ne{constructor(){super(...arguments),this.type=x.Footnote}}class ve extends ne{constructor(){super(...arguments),this.type=x.Endnote}}class ae extends D{constructor(t,e,r){super(t,e),this._documentParser=r}}class _e extends ae{constructor(t,e,r){super(t,e,r)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"footnote",be)}}class ye extends ae{constructor(t,e,r){super(t,e,r)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"endnote",ve)}}function se(i,t){var e={defaultNoteIds:[]};for(let r of t.elements(i))switch(r.localName){case"numFmt":e.nummeringFormat=t.attr(r,"val");break;case"footnote":case"endnote":e.defaultNoteIds.push(t.attr(r,"id"))}return e}class we extends D{constructor(t,e){super(t,e)}parseXml(t){this.settings=function(i,t){var e={};for(let r of t.elements(i))switch(r.localName){case"defaultTabStop":e.defaultTabStop=t.lengthAttr(r,"val");break;case"footnotePr":e.footnoteProps=se(r,t);break;case"endnotePr":e.endnoteProps=se(r,t);break;case"autoHyphenation":e.autoHyphenation=t.boolAttr(r,"val")}return e}(t,this._package.xmlParser)}}class Se extends D{parseXml(t){this.props=function(i,t){return t.elements(i,"property").map(e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}})}(t,this._package.xmlParser)}}class xe extends D{constructor(t,e,r){super(t,e),this._documentParser=r}parseXml(t){this.comments=this._documentParser.parseComments(t),this.commentMap=u(this.comments,e=>e.id)}}class Pe extends D{constructor(t,e){super(t,e),this.comments=[]}parseXml(t){const e=this._package.xmlParser;for(let r of e.elements(t,"commentEx"))this.comments.push({paraId:e.attr(r,"paraId"),paraIdParent:e.attr(r,"paraIdParent"),done:e.boolAttr(r,"done")});this.commentMap=u(this.comments,r=>r.paraId)}}const Ee=[{type:o.OfficeDocument,target:"word/document.xml"},{type:o.ExtendedProperties,target:"docProps/app.xml"},{type:o.CoreProperties,target:"docProps/core.xml"},{type:o.CustomProperties,target:"docProps/custom.xml"}];class Qt{constructor(){this.parts=[],this.partsMap={}}static load(t,e,r){return(0,f.Z)(function*(){var s=new Qt;return s._options=r,s._parser=e,s._package=yield T.load(t,r),s.rels=yield s._package.loadRelationships(),yield Promise.all(Ee.map(l=>{var Y;const F=null!=(Y=s.rels.find(nt=>nt.type===l.type))?Y:l;return s.loadRelationshipPart(F.target,F.type)})),s})()}save(t="blob"){return this._package.save(t)}loadRelationshipPart(t,e){var r=this;return(0,f.Z)(function*(){var l;if(r.partsMap[t])return r.partsMap[t];if(!r._package.get(t))return null;let s=null;switch(e){case o.OfficeDocument:r.documentPart=s=new at(r._package,t,r._parser);break;case o.FontTable:r.fontTablePart=s=new it(r._package,t);break;case o.Numbering:r.numberingPart=s=new et(r._package,t,r._parser);break;case o.Styles:r.stylesPart=s=new J(r._package,t,r._parser);break;case o.Theme:r.themePart=s=new jt(r._package,t);break;case o.Footnotes:r.footnotesPart=s=new _e(r._package,t,r._parser);break;case o.Endnotes:r.endnotesPart=s=new ye(r._package,t,r._parser);break;case o.Footer:s=new Ut(r._package,t,r._parser);break;case o.Header:s=new Ot(r._package,t,r._parser);break;case o.CoreProperties:r.corePropsPart=s=new Ht(r._package,t);break;case o.ExtendedProperties:r.extendedPropsPart=s=new Zt(r._package,t);break;case o.CustomProperties:s=new Se(r._package,t);break;case o.Settings:r.settingsPart=s=new we(r._package,t);break;case o.Comments:r.commentsPart=s=new xe(r._package,t,r._parser);break;case o.CommentsExtended:r.commentsExtendedPart=s=new Pe(r._package,t)}if(null==s)return Promise.resolve(null);if(r.partsMap[t]=s,r.parts.push(s),yield s.load(),(null==(l=s.rels)?void 0:l.length)>0){const[F]=y(s.path);yield Promise.all(s.rels.map(Y=>r.loadRelationshipPart(C(Y.target,F),Y.type)))}return s})()}loadDocumentImage(t,e){var r=this;return(0,f.Z)(function*(){const s=yield r.loadResource(null!=e?e:r.documentPart,t,"blob");return r.blobToURL(s)})()}loadNumberingImage(t){var e=this;return(0,f.Z)(function*(){const r=yield e.loadResource(e.numberingPart,t,"blob");return e.blobToURL(r)})()}loadFont(t,e){var r=this;return(0,f.Z)(function*(){const s=yield r.loadResource(r.fontTablePart,t,"uint8array");return s&&r.blobToURL(new Blob([Ae(s,e)]))})()}loadAltChunk(t,e){var r=this;return(0,f.Z)(function*(){return yield r.loadResource(null!=e?e:r.documentPart,t,"string")})()}blobToURL(t){return t?this._options.useBase64URL?(i=t,new Promise((t,e)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=()=>e(),r.readAsDataURL(i)})):URL.createObjectURL(t):null;var i}findPartByRelId(t,e=null){var l,r=(null!=(l=e.rels)?l:this.rels).find(F=>F.id==t);const s=e?y(e.path)[0]:"";return r?this.partsMap[C(r.target,s)]:null}getPathById(t,e){const r=t.rels.find(l=>l.id==e),[s]=y(t.path);return r?C(r.target,s):null}loadResource(t,e,r){const s=this.getPathById(t,e);return s?this._package.load(s,r):Promise.resolve(null)}}function Ae(i,t){const r=t.replace(/{|}|-/g,""),s=new Array(16);for(let l=0;l<16;l++)s[16-l-1]=parseInt(r.substr(2*l,2),16);for(let l=0;l<32;l++)i[l]=i[l]^s[l%16];return i}function Ne(i,t){return{type:x.BookmarkStart,id:t.attr(i,"id"),name:t.attr(i,"name"),colFirst:t.intAttr(i,"colFirst"),colLast:t.intAttr(i,"colLast")}}function Me(i,t){return{type:x.BookmarkEnd,id:t.attr(i,"id")}}class ze extends pt{constructor(){super(...arguments),this.type=x.VmlElement,this.attrs={}}}function ie(i,t){var e=new ze;switch(i.localName){case"rect":e.tagName="rect",Object.assign(e.attrs,{width:"100%",height:"100%"});break;case"oval":e.tagName="ellipse",Object.assign(e.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":e.tagName="line";break;case"shape":e.tagName="g";break;case"textbox":e.tagName="foreignObject",Object.assign(e.attrs,{width:"100%",height:"100%"});break;default:return null}for(const r of n.attrs(i))switch(r.localName){case"style":e.cssStyleText=r.value;break;case"fillcolor":e.attrs.fill=r.value;break;case"from":const[s,l]=oe(r.value);Object.assign(e.attrs,{x1:s,y1:l});break;case"to":const[F,Y]=oe(r.value);Object.assign(e.attrs,{x2:F,y2:Y})}for(const r of n.elements(i))switch(r.localName){case"stroke":Object.assign(e.attrs,Oe(r));break;case"fill":Object.assign(e.attrs,{});break;case"imagedata":e.tagName="image",Object.assign(e.attrs,{width:"100%",height:"100%"}),e.imageHref={id:n.attr(r,"id"),title:n.attr(r,"title")};break;case"txbxContent":e.children.push(...t.parseBodyElements(r));break;default:const s=ie(r,t);s&&e.children.push(s)}return e}function Oe(i){var t;return{stroke:n.attr(i,"color"),"stroke-width":null!=(t=n.lengthAttr(i,"weight",A_Emu))?t:"1px"}}function oe(i){return i.split(",")}class Te extends pt{constructor(){super(...arguments),this.type=x.Comment}}class Re extends pt{constructor(t){super(),this.id=t,this.type=x.CommentReference}}class Fe extends pt{constructor(t){super(),this.id=t,this.type=x.CommentRangeStart}}class Ie extends pt{constructor(t){super(),this.id=t,this.type=x.CommentRangeEnd}}const De=[],le={oMath:x.MmlMath,oMathPara:x.MmlMathParagraph,f:x.MmlFraction,func:x.MmlFunction,fName:x.MmlFunctionName,num:x.MmlNumerator,den:x.MmlDenominator,rad:x.MmlRadical,deg:x.MmlDegree,e:x.MmlBase,sSup:x.MmlSuperscript,sSub:x.MmlSubscript,sPre:x.MmlPreSubSuper,sup:x.MmlSuperArgument,sub:x.MmlSubArgument,d:x.MmlDelimiter,nary:x.MmlNary,eqArr:x.MmlEquationArray,lim:x.MmlLimit,limLow:x.MmlLimitLower,m:x.MmlMatrix,mr:x.MmlMatrixRow,box:x.MmlBox,bar:x.MmlBar,groupChr:x.MmlGroupChar};class Le{constructor(t){this.options=zt({ignoreWidth:!1,debug:!1},t)}parseNotes(t,e,r){var s=[];for(let l of n.elements(t,e)){const F=new r;F.id=n.attr(l,"id"),F.noteType=n.attr(l,"type"),F.children=this.parseBodyElements(l),s.push(F)}return s}parseComments(t){var e=[];for(let r of n.elements(t,"comment")){const s=new Te;s.id=n.attr(r,"id"),s.author=n.attr(r,"author"),s.initials=n.attr(r,"initials"),s.date=n.attr(r,"date"),s.children=this.parseBodyElements(r),e.push(s)}return e}parseDocumentFile(t){var e=n.element(t,"body"),r=n.element(t,"background"),s=n.element(e,"sectPr");return{type:x.Document,children:this.parseBodyElements(e),props:s?Ct(s,n):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(t){var e={},r=bt.colorAttr(t,"color");return r&&(e["background-color"]=r),e}parseBodyElements(t){var e=[];for(let r of n.elements(t))switch(r.localName){case"p":e.push(this.parseParagraph(r));break;case"altChunk":e.push(this.parseAltChunk(r));break;case"tbl":e.push(this.parseTable(r));break;case"sdt":e.push(...this.parseSdt(r,s=>this.parseBodyElements(s)))}return e}parseStylesFile(t){var e=[];return bt.foreach(t,r=>{switch(r.localName){case"style":e.push(this.parseStyle(r));break;case"docDefaults":e.push(this.parseDefaultStyles(r))}}),e}parseDefaultStyles(t){var e={id:null,name:null,target:null,basedOn:null,styles:[]};return bt.foreach(t,r=>{switch(r.localName){case"rPrDefault":var s=n.element(r,"rPr");s&&e.styles.push({target:"span",values:this.parseDefaultProperties(s,{})});break;case"pPrDefault":var l=n.element(r,"pPr");l&&e.styles.push({target:"p",values:this.parseDefaultProperties(l,{})})}}),e}parseStyle(t){var e={id:n.attr(t,"styleId"),isDefault:n.boolAttr(t,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(n.attr(t,"type")){case"paragraph":e.target="p";break;case"table":e.target="table";break;case"character":e.target="span"}return bt.foreach(t,r=>{switch(r.localName){case"basedOn":e.basedOn=n.attr(r,"val");break;case"name":e.name=n.attr(r,"val");break;case"link":e.linked=n.attr(r,"val");break;case"next":e.next=n.attr(r,"val");break;case"aliases":e.aliases=n.attr(r,"val").split(",");break;case"pPr":e.styles.push({target:"p",values:this.parseDefaultProperties(r,{})}),e.paragraphProps=a(r,n);break;case"rPr":e.styles.push({target:"span",values:this.parseDefaultProperties(r,{})}),e.runProps=Pt(r,n);break;case"tblPr":case"tcPr":e.styles.push({target:"td",values:this.parseDefaultProperties(r,{})});break;case"tblStylePr":for(let s of this.parseTableStyle(r))e.styles.push(s);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${r.localName}`)}}),e}parseTableStyle(t){var e=[],r=n.attr(t,"type"),s="",l="";switch(r){case"firstRow":l=".first-row",s="tr.first-row td";break;case"lastRow":l=".last-row",s="tr.last-row td";break;case"firstCol":l=".first-col",s="td.first-col";break;case"lastCol":l=".last-col",s="td.last-col";break;case"band1Vert":l=":not(.no-vband)",s="td.odd-col";break;case"band2Vert":l=":not(.no-vband)",s="td.even-col";break;case"band1Horz":l=":not(.no-hband)",s="tr.odd-row";break;case"band2Horz":l=":not(.no-hband)",s="tr.even-row";break;default:return[]}return bt.foreach(t,F=>{switch(F.localName){case"pPr":e.push({target:`${s} p`,mod:l,values:this.parseDefaultProperties(F,{})});break;case"rPr":e.push({target:`${s} span`,mod:l,values:this.parseDefaultProperties(F,{})});break;case"tblPr":case"tcPr":e.push({target:s,mod:l,values:this.parseDefaultProperties(F,{})})}}),e}parseNumberingFile(t){var e=[],r={},s=[];return bt.foreach(t,l=>{switch(l.localName){case"abstractNum":this.parseAbstractNumbering(l,s).forEach(nt=>e.push(nt));break;case"numPicBullet":s.push(this.parseNumberingPicBullet(l));break;case"num":var F=n.attr(l,"numId"),Y=n.elementAttr(l,"abstractNumId","val");r[Y]=F}}),e.forEach(l=>l.id=r[l.id]),e}parseNumberingPicBullet(t){var e=n.element(t,"pict"),r=e&&n.element(e,"shape"),s=r&&n.element(r,"imagedata");return s?{id:n.intAttr(t,"numPicBulletId"),src:n.attr(s,"id"),style:n.attr(r,"style")}:null}parseAbstractNumbering(t,e){var r=[],s=n.attr(t,"abstractNumId");return bt.foreach(t,l=>{"lvl"===l.localName&&r.push(this.parseNumberingLevel(s,l,e))}),r}parseNumberingLevel(t,e,r){var s={id:t,level:n.intAttr(e,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return bt.foreach(e,l=>{switch(l.localName){case"start":s.start=n.intAttr(l,"val");break;case"pPr":this.parseDefaultProperties(l,s.pStyle);break;case"rPr":this.parseDefaultProperties(l,s.rStyle);break;case"lvlPicBulletId":var F=n.intAttr(l,"val");s.bullet=r.find(Y=>(null==Y?void 0:Y.id)==F);break;case"lvlText":s.levelText=n.attr(l,"val");break;case"pStyle":s.pStyleName=n.attr(l,"val");break;case"numFmt":s.format=n.attr(l,"val");break;case"suff":s.suff=n.attr(l,"val")}}),s}parseSdt(t,e){const r=n.element(t,"sdtContent");return r?e(r):[]}parseInserted(t,e){var r,s;return{type:x.Inserted,children:null!=(s=null==(r=e(t))?void 0:r.children)?s:[]}}parseDeleted(t,e){var r,s;return{type:x.Deleted,children:null!=(s=null==(r=e(t))?void 0:r.children)?s:[]}}parseAltChunk(t){return{type:x.AltChunk,children:[],id:n.attr(t,"id")}}parseParagraph(t){var e={type:x.Paragraph,children:[]};for(let r of n.elements(t))switch(r.localName){case"pPr":this.parseParagraphProperties(r,e);break;case"r":e.children.push(this.parseRun(r,e));break;case"hyperlink":e.children.push(this.parseHyperlink(r,e));break;case"smartTag":e.children.push(this.parseSmartTag(r,e));break;case"bookmarkStart":e.children.push(Ne(r,n));break;case"bookmarkEnd":e.children.push(Me(r,n));break;case"commentRangeStart":e.children.push(new Fe(n.attr(r,"id")));break;case"commentRangeEnd":e.children.push(new Ie(n.attr(r,"id")));break;case"oMath":case"oMathPara":e.children.push(this.parseMathElement(r));break;case"sdt":e.children.push(...this.parseSdt(r,s=>this.parseParagraph(s).children));break;case"ins":e.children.push(this.parseInserted(r,s=>this.parseParagraph(s)));break;case"del":e.children.push(this.parseDeleted(r,s=>this.parseParagraph(s)))}return e}parseParagraphProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,r=>{if(Z(r,e,n))return!0;switch(r.localName){case"pStyle":e.styleName=n.attr(r,"val");break;case"cnfStyle":e.className=vt.classNameOfCnfStyle(r);break;case"framePr":this.parseFrame(r,e);break;case"rPr":break;default:return!1}return!0})}parseFrame(t,e){"drop"==n.attr(t,"dropCap")&&(e.cssStyle.float="left")}parseHyperlink(t,e){var r={type:x.Hyperlink,parent:e,children:[]};return r.anchor=n.attr(t,"anchor"),r.id=n.attr(t,"id"),bt.foreach(t,s=>{"r"===s.localName&&r.children.push(this.parseRun(s,r))}),r}parseSmartTag(t,e){var r={type:x.SmartTag,parent:e,children:[]},s=n.attr(t,"uri"),l=n.attr(t,"element");return s&&(r.uri=s),l&&(r.element=l),bt.foreach(t,F=>{"r"===F.localName&&r.children.push(this.parseRun(F,r))}),r}parseRun(t,e){var r={type:x.Run,parent:e,children:[]};return bt.foreach(t,s=>{switch((s=this.checkAlternateContent(s)).localName){case"t":r.children.push({type:x.Text,text:s.textContent});break;case"delText":r.children.push({type:x.DeletedText,text:s.textContent});break;case"commentReference":r.children.push(new Re(n.attr(s,"id")));break;case"fldSimple":r.children.push({type:x.SimpleField,instruction:n.attr(s,"instr"),lock:n.boolAttr(s,"lock",!1),dirty:n.boolAttr(s,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:x.Instruction,text:s.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:x.ComplexField,charType:n.attr(s,"fldCharType"),lock:n.boolAttr(s,"lock",!1),dirty:n.boolAttr(s,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:x.NoBreakHyphen});break;case"br":r.children.push({type:x.Break,break:n.attr(s,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:x.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:x.Symbol,font:P(n.attr(s,"font")),char:n.attr(s,"char")});break;case"tab":r.children.push({type:x.Tab});break;case"footnoteReference":r.children.push({type:x.FootnoteReference,id:n.attr(s,"id")});break;case"endnoteReference":r.children.push({type:x.EndnoteReference,id:n.attr(s,"id")});break;case"drawing":let l=this.parseDrawing(s);l&&(r.children=[l]);break;case"pict":r.children.push(this.parseVmlPicture(s));break;case"rPr":this.parseRunProperties(s,r)}}),r}parseMathElement(t){const e=`${t.localName}Pr`,r={type:le[t.localName],children:[]};for(const l of n.elements(t))if(le[l.localName])r.children.push(this.parseMathElement(l));else if("r"==l.localName){var s=this.parseRun(l);s.type=x.MmlRun,r.children.push(s)}else l.localName==e&&(r.props=this.parseMathProperies(l));return r}parseMathProperies(t){const e={};for(const r of n.elements(t))switch(r.localName){case"chr":e.char=n.attr(r,"val");break;case"vertJc":e.verticalJustification=n.attr(r,"val");break;case"pos":e.position=n.attr(r,"val");break;case"degHide":e.hideDegree=n.boolAttr(r,"val");break;case"begChr":e.beginChar=n.attr(r,"val");break;case"endChr":e.endChar=n.attr(r,"val")}return e}parseRunProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,r=>{switch(r.localName){case"rStyle":e.styleName=n.attr(r,"val");break;case"vertAlign":e.verticalAlign=vt.valueOfVertAlign(r,!0);break;default:return!1}return!0})}parseVmlPicture(t){const e={type:x.VmlPicture,children:[]};for(const r of n.elements(t)){const s=ie(r,this);s&&e.children.push(s)}return e}checkAlternateContent(t){var l;if("AlternateContent"!=t.localName)return t;var e=n.element(t,"Choice");if(e){var r=n.attr(e,"Requires"),s=t.lookupNamespaceURI(r);if(De.includes(s))return e.firstElementChild}return null==(l=n.element(t,"Fallback"))?void 0:l.firstElementChild}parseDrawing(t){for(var e of n.elements(t))switch(e.localName){case"inline":case"anchor":return this.parseDrawingWrapper(e)}}parseDrawingWrapper(t){var gt,e={type:x.Drawing,children:[],cssStyle:{}},r="anchor"==t.localName;let s=null,l=n.boolAttr(t,"simplePos");n.boolAttr(t,"behindDoc");let F={relative:"page",align:"left",offset:"0"},Y={relative:"page",align:"top",offset:"0"};for(var nt of n.elements(t))switch(nt.localName){case"simplePos":l&&(F.offset=n.lengthAttr(nt,"x",A_Emu),Y.offset=n.lengthAttr(nt,"y",A_Emu));break;case"extent":e.cssStyle.width=n.lengthAttr(nt,"cx",A_Emu),e.cssStyle.height=n.lengthAttr(nt,"cy",A_Emu);break;case"positionH":case"positionV":if(!l){let xt="positionH"==nt.localName?F:Y;var ut=n.element(nt,"align"),lt=n.element(nt,"posOffset");xt.relative=null!=(gt=n.attr(nt,"relativeFrom"))?gt:xt.relative,ut&&(xt.align=ut.textContent),lt&&(xt.offset=bt.sizeValue(lt,A_Emu))}break;case"wrapTopAndBottom":s="wrapTopAndBottom";break;case"wrapNone":s="wrapNone";break;case"graphic":var St=this.parseGraphic(nt);St&&e.children.push(St)}return"wrapTopAndBottom"==s?(e.cssStyle.display="block",F.align&&(e.cssStyle["text-align"]=F.align,e.cssStyle.width="100%")):"wrapNone"==s?(e.cssStyle.display="block",e.cssStyle.position="relative",e.cssStyle.width="0px",e.cssStyle.height="0px",F.offset&&(e.cssStyle.left=F.offset),Y.offset&&(e.cssStyle.top=Y.offset)):r&&("left"==F.align||"right"==F.align)&&(e.cssStyle.float=F.align),e}parseGraphic(t){var e=n.element(t,"graphicData");for(let r of n.elements(e))if("pic"===r.localName)return this.parsePicture(r);return null}parsePicture(t){var e={type:x.Image,src:"",cssStyle:{}},r=n.element(t,"blipFill"),s=n.element(r,"blip");e.src=n.attr(s,"embed");var l=n.element(t,"spPr"),F=n.element(l,"xfrm");for(var Y of(e.cssStyle.position="relative",n.elements(F)))switch(Y.localName){case"ext":e.cssStyle.width=n.lengthAttr(Y,"cx",A_Emu),e.cssStyle.height=n.lengthAttr(Y,"cy",A_Emu);break;case"off":e.cssStyle.left=n.lengthAttr(Y,"x",A_Emu),e.cssStyle.top=n.lengthAttr(Y,"y",A_Emu)}return e}parseTable(t){var e={type:x.Table,children:[]};return bt.foreach(t,r=>{switch(r.localName){case"tr":e.children.push(this.parseTableRow(r));break;case"tblGrid":e.columns=this.parseTableColumns(r);break;case"tblPr":this.parseTableProperties(r,e)}}),e}parseTableColumns(t){var e=[];return bt.foreach(t,r=>{"gridCol"===r.localName&&e.push({width:n.lengthAttr(r,"w")})}),e}parseTableProperties(t,e){switch(e.cssStyle={},e.cellStyle={},this.parseDefaultProperties(t,e.cssStyle,e.cellStyle,r=>{switch(r.localName){case"tblStyle":e.styleName=n.attr(r,"val");break;case"tblLook":e.className=vt.classNameOftblLook(r);break;case"tblpPr":this.parseTablePosition(r,e);break;case"tblStyleColBandSize":e.colBandSize=n.intAttr(r,"val");break;case"tblStyleRowBandSize":e.rowBandSize=n.intAttr(r,"val");break;default:return!1}return!0}),e.cssStyle["text-align"]){case"center":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto",e.cssStyle["margin-right"]="auto";break;case"right":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto"}}parseTablePosition(t,e){var r=n.lengthAttr(t,"topFromText"),s=n.lengthAttr(t,"bottomFromText"),l=n.lengthAttr(t,"rightFromText"),F=n.lengthAttr(t,"leftFromText");e.cssStyle.float="left",e.cssStyle["margin-bottom"]=vt.addSize(e.cssStyle["margin-bottom"],s),e.cssStyle["margin-left"]=vt.addSize(e.cssStyle["margin-left"],F),e.cssStyle["margin-right"]=vt.addSize(e.cssStyle["margin-right"],l),e.cssStyle["margin-top"]=vt.addSize(e.cssStyle["margin-top"],r)}parseTableRow(t){var e={type:x.Row,children:[]};return bt.foreach(t,r=>{switch(r.localName){case"tc":e.children.push(this.parseTableCell(r));break;case"trPr":this.parseTableRowProperties(r,e)}}),e}parseTableRowProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,r=>{switch(r.localName){case"cnfStyle":e.className=vt.classNameOfCnfStyle(r);break;case"tblHeader":e.isHeader=n.boolAttr(r,"val");break;default:return!1}return!0})}parseTableCell(t){var e={type:x.Cell,children:[]};return bt.foreach(t,r=>{switch(r.localName){case"tbl":e.children.push(this.parseTable(r));break;case"p":e.children.push(this.parseParagraph(r));break;case"tcPr":this.parseTableCellProperties(r,e)}}),e}parseTableCellProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,r=>{var s;switch(r.localName){case"gridSpan":e.span=n.intAttr(r,"val",null);break;case"vMerge":e.verticalMerge=null!=(s=n.attr(r,"val"))?s:"continue";break;case"cnfStyle":e.className=vt.classNameOfCnfStyle(r);break;default:return!1}return!0}),this.parseTableCellVerticalText(t,e)}parseTableCellVerticalText(t,e){const r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};bt.foreach(t,s=>{if("textDirection"===s.localName){const l=n.attr(s,"val"),F=r[l]||{writingMode:"horizontal-tb"};e.cssStyle["writing-mode"]=F.writingMode,e.cssStyle.transform=F.transform}})}parseDefaultProperties(t,e=null,r=null,s=null){return e=e||{},bt.foreach(t,l=>{if(!(null==s?void 0:s(l)))switch(l.localName){case"jc":e["text-align"]=vt.valueOfJc(l);break;case"textAlignment":e["vertical-align"]=vt.valueOfTextAlignment(l);break;case"color":e.color=bt.colorAttr(l,"val",null,"black");break;case"sz":e["font-size"]=e["min-height"]=n.lengthAttr(l,"val",A_FontSize);break;case"shd":e["background-color"]=bt.colorAttr(l,"fill",null,"inherit");break;case"highlight":e["background-color"]=bt.colorAttr(l,"val",null,"transparent");break;case"vertAlign":break;case"position":e.verticalAlign=n.lengthAttr(l,"val",A_FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":e.width=vt.valueOfSize(l,"w");break;case"trHeight":this.parseTrHeight(l,e);break;case"strike":e["text-decoration"]=n.boolAttr(l,"val",!0)?"line-through":"none";break;case"b":e["font-weight"]=n.boolAttr(l,"val",!0)?"bold":"normal";break;case"i":e["font-style"]=n.boolAttr(l,"val",!0)?"italic":"normal";break;case"caps":e["text-transform"]=n.boolAttr(l,"val",!0)?"uppercase":"none";break;case"smallCaps":e["font-variant"]=n.boolAttr(l,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(l,e);break;case"ind":case"tblInd":this.parseIndentation(l,e);break;case"rFonts":this.parseFont(l,e);break;case"tblBorders":this.parseBorderProperties(l,r||e);break;case"tblCellSpacing":e["border-spacing"]=vt.valueOfMargin(l),e["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(l,e);break;case"bdr":e.border=vt.valueOfBorder(l);break;case"tcBorders":this.parseBorderProperties(l,e);break;case"vanish":n.boolAttr(l,"val",!0)&&(e.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(l,r||e);break;case"tblLayout":e["table-layout"]=vt.valueOfTblLayout(l);break;case"vAlign":e["vertical-align"]=vt.valueOfTextAlignment(l);break;case"spacing":"pPr"==t.localName&&this.parseSpacing(l,e);break;case"wordWrap":n.boolAttr(l,"val")&&(e["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":e.hyphens=n.boolAttr(l,"val",!0)?"none":"auto";break;case"lang":e.$lang=n.attr(l,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${t.localName}.${l.localName}`)}}),e}parseUnderline(t,e){var r=n.attr(t,"val");if(null!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":e["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":e["text-decoration"]="underline dotted";break;case"double":e["text-decoration"]="underline double";break;case"single":case"thick":case"words":e["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":e["text-decoration"]="underline wavy";break;case"none":e["text-decoration"]="none"}var s=bt.colorAttr(t,"color");s&&(e["text-decoration-color"]=s)}}parseFont(t,e){var F=[n.attr(t,"ascii"),vt.themeValue(t,"asciiTheme"),n.attr(t,"eastAsia")].filter(Y=>Y).map(Y=>P(Y));F.length>0&&(e["font-family"]=[...new Set(F)].join(", "))}parseIndentation(t,e){var r=n.lengthAttr(t,"firstLine"),s=n.lengthAttr(t,"hanging"),l=n.lengthAttr(t,"left"),F=n.lengthAttr(t,"start"),Y=n.lengthAttr(t,"right"),nt=n.lengthAttr(t,"end");r&&(e["text-indent"]=r),s&&(e["text-indent"]=`-${s}`),(l||F)&&(e["margin-left"]=l||F),(Y||nt)&&(e["margin-right"]=Y||nt)}parseSpacing(t,e){var r=n.lengthAttr(t,"before"),s=n.lengthAttr(t,"after"),l=n.intAttr(t,"line",null),F=n.attr(t,"lineRule");if(r&&(e["margin-top"]=r),s&&(e["margin-bottom"]=s),null!==l)switch(F){case"auto":e["line-height"]=`${(l/240).toFixed(2)}`;break;case"atLeast":e["line-height"]=`calc(100% + ${l/20}pt)`;break;default:e["line-height"]=e["min-height"]=l/20+"pt"}}parseMarginProperties(t,e){bt.foreach(t,r=>{switch(r.localName){case"left":e["padding-left"]=vt.valueOfMargin(r);break;case"right":e["padding-right"]=vt.valueOfMargin(r);break;case"top":e["padding-top"]=vt.valueOfMargin(r);break;case"bottom":e["padding-bottom"]=vt.valueOfMargin(r)}})}parseTrHeight(t,e){n.attr(t,"hRule"),e.height=n.lengthAttr(t,"val")}parseBorderProperties(t,e){bt.foreach(t,r=>{switch(r.localName){case"start":case"left":e["border-left"]=vt.valueOfBorder(r);break;case"end":case"right":e["border-right"]=vt.valueOfBorder(r);break;case"top":e["border-top"]=vt.valueOfBorder(r);break;case"bottom":e["border-bottom"]=vt.valueOfBorder(r)}})}}const Ue=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class bt{static foreach(t,e){for(var r=0;r<t.childNodes.length;r++){let s=t.childNodes[r];s.nodeType==Node.ELEMENT_NODE&&e(s)}}static colorAttr(t,e,r=null,s="black"){var l=n.attr(t,e);if(l)return"auto"==l?s:Ue.includes(l)?l:`#${l}`;var F=n.attr(t,"themeColor");return F?`var(--docx-${F}-color)`:r}static sizeValue(t,e=A_Dxa){return W(t.textContent,e)}}class vt{static themeValue(t,e){var r=n.attr(t,e);return r?`var(--docx-${r}-font)`:null}static valueOfSize(t,e){var r=A_Dxa;switch(n.attr(t,"type")){case"dxa":break;case"pct":r=A_Percent;break;case"auto":return"auto"}return n.lengthAttr(t,e,r)}static valueOfMargin(t){return n.lengthAttr(t,"w")}static valueOfBorder(t){if("nil"==n.attr(t,"val"))return"none";var r=bt.colorAttr(t,"color");return`${n.lengthAttr(t,"sz",A_Border)} solid ${"auto"==r?"black":r}`}static valueOfTblLayout(t){return"fixed"==n.attr(t,"val")?"fixed":"auto"}static classNameOfCnfStyle(t){const e=n.attr(t,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((s,l)=>"1"==e[l]).join(" ")}static valueOfJc(t){var e=n.attr(t,"val");switch(e){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return e}static valueOfVertAlign(t,e=!1){var r=n.attr(t,"val");switch(r){case"subscript":return"sub";case"superscript":return e?"sup":"super"}return e?null:r}static valueOfTextAlignment(t){var e=n.attr(t,"val");switch(e){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return e}static addSize(t,e){return null==t?e:null==e?t:`calc(${t} + ${e})`}static classNameOftblLook(t){const e=n.hexAttr(t,"val",0);let r="";return(n.boolAttr(t,"firstRow")||32&e)&&(r+=" first-row"),(n.boolAttr(t,"lastRow")||64&e)&&(r+=" last-row"),(n.boolAttr(t,"firstColumn")||128&e)&&(r+=" first-col"),(n.boolAttr(t,"lastColumn")||256&e)&&(r+=" last-col"),(n.boolAttr(t,"noHBand")||512&e)&&(r+=" no-hband"),(n.boolAttr(t,"noVBand")||1024&e)&&(r+=" no-vband"),r.trim()}}const ce={pos:0,leader:"none",style:"left"};function We(i,t,e,r=.75){const s=i.closest("p"),l=i.getBoundingClientRect(),F=s.getBoundingClientRect(),Y=getComputedStyle(s),nt=(null==t?void 0:t.length)>0?t.map(Bt=>({pos:ue(Bt.position),leader:Bt.leader,style:Bt.style})).sort((Bt,Xt)=>Bt.pos-Xt.pos):[ce],ut=nt[nt.length-1],lt=F.width*r,St=ue(e);let gt=ut.pos+St;if(gt<lt)for(;gt<lt&&nt.length<50;gt+=St)nt.push($t(zt({},ce),{pos:gt}));const xt=parseFloat(Y.marginLeft),Lt=(l.left-(F.left+xt))*r,Mt=nt.find(Bt=>"clear"!=Bt.style&&Bt.pos>Lt);if(null==Mt)return;let Wt=1;if("right"==Mt.style||"center"==Mt.style){const Bt=Array.from(s.querySelectorAll(`.${i.className}`)),Xt=Bt.indexOf(i)+1,qt=document.createRange();qt.setStart(i,1),Xt<Bt.length?qt.setEndBefore(Bt[Xt]):qt.setEndAfter(s);const ir="center"==Mt.style?.5:1,pe=qt.getBoundingClientRect();Wt=Mt.pos-(pe.left+ir*pe.width-(F.left-xt))*r}else Wt=Mt.pos-Lt;switch(i.innerHTML="&nbsp;",i.style.textDecoration="inherit",i.style.wordSpacing=`${Wt.toFixed(0)}pt`,Mt.leader){case"dot":case"middleDot":i.style.textDecoration="underline",i.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":i.style.textDecoration="underline"}}function ue(i){return parseFloat(i)}const ht_mathML="http://www.w3.org/1998/Math/MathML";class $e{constructor(t){this.htmlDocument=t,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}render(t,e,r=null,s){var l=this;return(0,f.Z)(function*(){var Y;l.document=t,l.options=s,l.className=s.className,l.rootSelector=s.inWrapper?`.${l.className}-wrapper`:":root",l.styleMap=null,l.tasks=[],l.options.renderComments&&globalThis.Highlight&&(l.commentHighlight=new Highlight),he(r=r||e),he(e),r.appendChild(l.createComment("docxjs library predefined styles")),r.appendChild(l.renderDefaultStyle()),t.themePart&&(r.appendChild(l.createComment("docxjs document theme values")),l.renderTheme(t.themePart,r)),null!=t.stylesPart&&(l.styleMap=l.processStyles(t.stylesPart.styles),r.appendChild(l.createComment("docxjs document styles")),r.appendChild(l.renderStyles(t.stylesPart.styles))),t.numberingPart&&(l.prodessNumberings(t.numberingPart.domNumberings),r.appendChild(l.createComment("docxjs document numbering styles")),r.appendChild(l.renderNumbering(t.numberingPart.domNumberings,r))),t.footnotesPart&&(l.footnoteMap=u(t.footnotesPart.notes,nt=>nt.id)),t.endnotesPart&&(l.endnoteMap=u(t.endnotesPart.notes,nt=>nt.id)),t.settingsPart&&(l.defaultTabSize=null==(Y=t.settingsPart.settings)?void 0:Y.defaultTabStop),!s.ignoreFonts&&t.fontTablePart&&l.renderFontTable(t.fontTablePart,r);var F=l.renderSections(t.documentPart.body);l.options.inWrapper?e.appendChild(l.renderWrapper(F)):te(e,F),l.commentHighlight&&s.renderComments&&CSS.highlights.set(`${l.className}-comments`,l.commentHighlight),l.postRenderTasks.forEach(nt=>nt()),yield Promise.allSettled(l.tasks),l.refreshTabStops()})()}renderTheme(t,e){var Y,nt;const r={},s=null==(Y=t.theme)?void 0:Y.fontScheme;s&&(s.majorFont&&(r["--docx-majorHAnsi-font"]=s.majorFont.latinTypeface),s.minorFont&&(r["--docx-minorHAnsi-font"]=s.minorFont.latinTypeface));const l=null==(nt=t.theme)?void 0:nt.colorScheme;if(l)for(let[ut,lt]of Object.entries(l.colors))r[`--docx-${ut}-color`]=`#${lt}`;const F=this.styleToString(`.${this.className}`,r);e.appendChild(this.createStyleElement(F))}renderFontTable(t,e){for(let r of t.fonts)for(let s of r.embedFontRefs)this.tasks.push(this.document.loadFont(s.id,s.key).then(l=>{const F={"font-family":P(r.name),src:`url(${l})`};("bold"==s.type||"boldItalic"==s.type)&&(F["font-weight"]="bold"),("italic"==s.type||"boldItalic"==s.type)&&(F["font-style"]="italic");const Y=this.styleToString("@font-face",F);e.appendChild(this.createComment(`docxjs ${r.name} font`)),e.appendChild(this.createStyleElement(Y))}))}processStyleName(t){return t?`${this.className}_${i=t,null==i?void 0:i.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}`:this.className;var i}processStyles(t){const e=u(t.filter(s=>null!=s.id),s=>s.id);for(const s of t.filter(l=>l.basedOn)){var r=e[s.basedOn];if(r){s.paragraphProps=h(s.paragraphProps,r.paragraphProps),s.runProps=h(s.runProps,r.runProps);for(const l of r.styles){const F=s.styles.find(Y=>Y.target==l.target);F?this.copyStyleProperties(l.values,F.values):s.styles.push($t(zt({},l),{values:zt({},l.values)}))}}else this.options.debug&&console.warn(`Can't find base style ${s.basedOn}`)}for(let s of t)s.cssName=this.processStyleName(s.id);return e}prodessNumberings(t){var e;for(let r of t.filter(s=>s.pStyleName)){const s=this.findStyle(r.pStyleName);(null==(e=null==s?void 0:s.paragraphProps)?void 0:e.numbering)&&(s.paragraphProps.numbering.level=r.level)}}processElement(t){if(t.children)for(var e of t.children)e.parent=t,e.type==x.Table?this.processTable(e):this.processElement(e)}processTable(t){for(var e of t.children)for(var r of e.children)r.cssStyle=this.copyStyleProperties(t.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(t,e,r=null){if(!t)return e;for(var s of(null==e&&(e={}),null==r&&(r=Object.getOwnPropertyNames(t)),r))t.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(e[s]=t[s]);return e}createPageElement(t,e){var r=this.createElement("section",{className:t});return e&&(e.pageMargins&&(r.style.paddingLeft=e.pageMargins.left,r.style.paddingRight=e.pageMargins.right,r.style.paddingTop=e.pageMargins.top,r.style.paddingBottom=e.pageMargins.bottom),e.pageSize&&(this.options.ignoreWidth||(r.style.width=e.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=e.pageSize.height))),r}createSectionContent(t){var e=this.createElement("article");return t.columns&&t.columns.numberOfColumns&&(e.style.columnCount=`${t.columns.numberOfColumns}`,e.style.columnGap=t.columns.space,t.columns.separator&&(e.style.columnRule="1px solid black")),e}renderSections(t){const e=[];this.processElement(t);const r=this.splitBySection(t.children,t.props),s=this.groupByPageBreaks(r);let l=null;for(let Y=0,nt=s.length;Y<nt;Y++){this.currentFootnoteIds=[];let lt=s[Y][0].sectProps;const St=this.createPageElement(this.className,lt);this.renderStyleValues(t.cssStyle,St),this.options.renderHeaders&&this.renderHeaderFooter(lt.headerRefs,lt,e.length,l!=lt,St);for(const gt of s[Y]){var F=this.createSectionContent(gt.sectProps);this.renderElements(gt.elements,F),St.appendChild(F),lt=gt.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,St),this.options.renderEndnotes&&Y==nt-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,St),this.options.renderFooters&&this.renderHeaderFooter(lt.footerRefs,lt,e.length,l!=lt,St),e.push(St),l=lt}return e}renderHeaderFooter(t,e,r,s,l){var nt,ut;if(t){var F=null!=(ut=null!=(nt=e.titlePage&&s?t.find(lt=>"first"==lt.type):null)?nt:r%2==1?t.find(lt=>"even"==lt.type):null)?ut:t.find(lt=>"default"==lt.type),Y=F&&this.document.findPartByRelId(F.id,this.document.documentPart);if(Y){this.currentPart=Y,this.usedHederFooterParts.includes(Y.path)||(this.processElement(Y.rootElement),this.usedHederFooterParts.push(Y.path));const[lt]=this.renderElements([Y.rootElement],l);(null==e?void 0:e.pageMargins)&&(Y.rootElement.type===x.Header?(lt.style.marginTop=`calc(${e.pageMargins.header} - ${e.pageMargins.top})`,lt.style.minHeight=`calc(${e.pageMargins.top} - ${e.pageMargins.header})`):Y.rootElement.type===x.Footer&&(lt.style.marginBottom=`calc(${e.pageMargins.footer} - ${e.pageMargins.bottom})`,lt.style.minHeight=`calc(${e.pageMargins.bottom} - ${e.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(t){return t.type==x.Break&&("lastRenderedPageBreak"==t.break?!this.options.ignoreLastRenderedPageBreak:"page"==t.break)}isPageBreakSection(t,e){var r,s,l,F,Y,nt;return!(!t||!e||(null==(r=t.pageSize)?void 0:r.orientation)==(null==(s=e.pageSize)?void 0:s.orientation)&&(null==(l=t.pageSize)?void 0:l.width)==(null==(F=e.pageSize)?void 0:F.width)&&(null==(Y=t.pageSize)?void 0:Y.height)==(null==(nt=e.pageSize)?void 0:nt.height))}splitBySection(t,e){var St,r={sectProps:null,elements:[],pageBreak:!1},s=[r];for(let gt of t){if(gt.type==x.Paragraph){const xt=this.findStyle(gt.styleName);(null==(St=null==xt?void 0:xt.paragraphProps)?void 0:St.pageBreakBefore)&&(r.sectProps=l,r.pageBreak=!0,s.push(r={sectProps:null,elements:[],pageBreak:!1}))}if(r.elements.push(gt),gt.type==x.Paragraph){const xt=gt;var l=xt.sectionProps,F=-1,Y=-1;if(this.options.breakPages&&xt.children&&(F=xt.children.findIndex(Dt=>{var Lt,Mt;return-1!=(Y=null!=(Mt=null==(Lt=Dt.children)?void 0:Lt.findIndex(this.isPageBreakElement.bind(this)))?Mt:-1)})),(l||-1!=F)&&(r.sectProps=l,r.pageBreak=-1!=F,s.push(r={sectProps:null,elements:[],pageBreak:!1})),-1!=F){let Dt=xt.children[F],Lt=Y<Dt.children.length-1;if(F<xt.children.length-1||Lt){var nt=gt.children,ut=$t(zt({},gt),{children:nt.slice(F)});if(gt.children=nt.slice(0,F),r.elements.push(ut),Lt){let Mt=Dt.children,Wt=$t(zt({},Dt),{children:Mt.slice(0,Y)});gt.children.push(Wt),Dt.children=Mt.slice(Y)}}}}}let lt=null;for(let gt=s.length-1;gt>=0;gt--)null==s[gt].sectProps?s[gt].sectProps=null!=lt?lt:e:lt=s[gt].sectProps;return s}groupByPageBreaks(t){let r,e=[];const s=[e];for(let l of t)e.push(l),(this.options.ignoreLastRenderedPageBreak||l.pageBreak||this.isPageBreakSection(r,l.sectProps))&&s.push(e=[]),r=l.sectProps;return s.filter(l=>l.length>0)}renderWrapper(t){return this.createElement("div",{className:`${this.className}-wrapper`},t)}renderDefaultStyle(){var t=this.className,e=`\n.${t}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n.${t}-wrapper>section.${t} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(e=`@media not print { ${e} }`);var r=`${e}\n.${t} { color: black; hyphens: auto; text-underline-position: from-font; }\nsection.${t} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\nsection.${t}>article { margin-bottom: auto; z-index: 1; }\nsection.${t}>footer { z-index: 1; }\n.${t} table { border-collapse: collapse; }\n.${t} table td, .${t} table th { vertical-align: top; }\n.${t} p { margin: 0pt; min-height: 1em; }\n.${t} span { white-space: pre-wrap; overflow-wrap: break-word; }\n.${t} a { color: inherit; text-decoration: inherit; }\n.${t} svg { fill: transparent; }\n`;return this.options.renderComments&&(r+=`\n.${t}-comment-ref { cursor: default; }\n.${t}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }\n.${t}-comment-ref:hover~.${t}-comment-popover { display: block; }\n.${t}-comment-author,.${t}-comment-date { font-size: 0.875rem; color: #888; }\n`),this.createStyleElement(r)}renderNumbering(t,e){var r="",s=[];for(var l of t){var F=`p.${this.numberingClass(l.id,l.level)}`,Y="none";if(l.bullet){let nt=`--${this.className}-${l.bullet.src}`.toLowerCase();r+=this.styleToString(`${F}:before`,{content:"' '",display:"inline-block",background:`var(${nt})`},l.bullet.style),this.tasks.push(this.document.loadNumberingImage(l.bullet.src).then(ut=>{e.appendChild(this.createStyleElement(`${this.rootSelector} { ${nt}: url(${ut}) }`))}))}else if(l.levelText){let nt=this.numberingCounter(l.id,l.level);const ut=nt+" "+(l.start-1);l.level>0&&(r+=this.styleToString(`p.${this.numberingClass(l.id,l.level-1)}`,{"counter-set":ut})),s.push(ut),r+=this.styleToString(`${F}:before`,zt({content:this.levelTextToContent(l.levelText,l.suff,l.id,this.numFormatToCssValue(l.format)),"counter-increment":nt},l.rStyle))}else Y=this.numFormatToCssValue(l.format);r+=this.styleToString(F,zt({display:"list-item","list-style-position":"inside","list-style-type":Y},l.pStyle))}return s.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":s.join(" ")})),this.createStyleElement(r)}renderStyles(t){var nt,e="";const r=this.styleMap,s=u(t.filter(ut=>ut.isDefault),ut=>ut.target);for(const ut of t){var l=ut.styles;if(ut.linked){var F=ut.linked&&r[ut.linked];F?l=l.concat(F.styles):this.options.debug&&console.warn(`Can't find linked style ${ut.linked}`)}for(const lt of l){var Y=`${null!=(nt=ut.target)?nt:""}.${ut.cssName}`;ut.target!=lt.target&&(Y+=` ${lt.target}`),s[ut.target]==ut&&(Y=`.${this.className} ${ut.target}, `+Y),e+=this.styleToString(Y,lt.values)}}return this.createStyleElement(e)}renderNotes(t,e,r){var s=t.map(F=>e[F]).filter(F=>F);if(s.length>0){var l=this.createElement("ol",null,this.renderElements(s));r.appendChild(l)}}renderElement(t){switch(t.type){case x.Paragraph:return this.renderParagraph(t);case x.BookmarkStart:return this.renderBookmarkStart(t);case x.BookmarkEnd:return null;case x.Run:return this.renderRun(t);case x.Table:return this.renderTable(t);case x.Row:return this.renderTableRow(t);case x.Cell:return this.renderTableCell(t);case x.Hyperlink:return this.renderHyperlink(t);case x.SmartTag:return this.renderSmartTag(t);case x.Drawing:return this.renderDrawing(t);case x.Image:return this.renderImage(t);case x.Text:case x.Text:return this.renderText(t);case x.DeletedText:return this.renderDeletedText(t);case x.Tab:return this.renderTab(t);case x.Symbol:return this.renderSymbol(t);case x.Break:return this.renderBreak(t);case x.Footer:return this.renderContainer(t,"footer");case x.Header:return this.renderContainer(t,"header");case x.Footnote:case x.Endnote:return this.renderContainer(t,"li");case x.FootnoteReference:return this.renderFootnoteReference(t);case x.EndnoteReference:return this.renderEndnoteReference(t);case x.NoBreakHyphen:return this.createElement("wbr");case x.VmlPicture:return this.renderVmlPicture(t);case x.VmlElement:return this.renderVmlElement(t);case x.MmlMath:return this.renderContainerNS(t,ht_mathML,"math",{xmlns:ht_mathML});case x.MmlMathParagraph:return this.renderContainer(t,"span");case x.MmlFraction:return this.renderContainerNS(t,ht_mathML,"mfrac");case x.MmlBase:return this.renderContainerNS(t,ht_mathML,t.parent.type==x.MmlMatrixRow?"mtd":"mrow");case x.MmlNumerator:case x.MmlDenominator:case x.MmlFunction:case x.MmlLimit:case x.MmlBox:return this.renderContainerNS(t,ht_mathML,"mrow");case x.MmlGroupChar:return this.renderMmlGroupChar(t);case x.MmlLimitLower:return this.renderContainerNS(t,ht_mathML,"munder");case x.MmlMatrix:return this.renderContainerNS(t,ht_mathML,"mtable");case x.MmlMatrixRow:return this.renderContainerNS(t,ht_mathML,"mtr");case x.MmlRadical:return this.renderMmlRadical(t);case x.MmlSuperscript:return this.renderContainerNS(t,ht_mathML,"msup");case x.MmlSubscript:return this.renderContainerNS(t,ht_mathML,"msub");case x.MmlDegree:case x.MmlSuperArgument:case x.MmlSubArgument:return this.renderContainerNS(t,ht_mathML,"mn");case x.MmlFunctionName:return this.renderContainerNS(t,ht_mathML,"ms");case x.MmlDelimiter:return this.renderMmlDelimiter(t);case x.MmlRun:return this.renderMmlRun(t);case x.MmlNary:return this.renderMmlNary(t);case x.MmlPreSubSuper:return this.renderMmlPreSubSuper(t);case x.MmlBar:return this.renderMmlBar(t);case x.MmlEquationArray:return this.renderMllList(t);case x.Inserted:return this.renderInserted(t);case x.Deleted:return this.renderDeleted(t);case x.CommentRangeStart:return this.renderCommentRangeStart(t);case x.CommentRangeEnd:return this.renderCommentRangeEnd(t);case x.CommentReference:return this.renderCommentReference(t);case x.AltChunk:return this.renderAltChunk(t)}return null}renderElements(t,e){if(null==t)return null;var r=t.flatMap(s=>this.renderElement(s)).filter(s=>null!=s);return e&&te(e,r),r}renderContainer(t,e,r){return this.createElement(e,r,this.renderElements(t.children))}renderContainerNS(t,e,r,s){return this.createElementNS(e,r,s,this.renderElements(t.children))}renderParagraph(t){var l,Y,nt,e=this.renderContainer(t,"p");const r=this.findStyle(t.styleName);null!=t.tabs||(t.tabs=null==(l=null==r?void 0:r.paragraphProps)?void 0:l.tabs),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),this.renderCommonProperties(e.style,t);const s=null!=(nt=t.numbering)?nt:null==(Y=null==r?void 0:r.paragraphProps)?void 0:Y.numbering;return s&&e.classList.add(this.numberingClass(s.id,s.level)),e}renderRunProperties(t,e){this.renderCommonProperties(t,e)}renderCommonProperties(t,e){null!=e&&(e.color&&(t.color=e.color),e.fontSize&&(t["font-size"]=e.fontSize))}renderHyperlink(t){var s,e=this.renderContainer(t,"a");this.renderStyleValues(t.cssStyle,e);let r="";if(t.id){const l=this.document.documentPart.rels.find(F=>F.id==t.id&&"External"===F.targetMode);r=null!=(s=null==l?void 0:l.target)?s:r}return t.anchor&&(r+=`#${t.anchor}`),e.href=r,e}renderSmartTag(t){return this.renderContainer(t,"span")}renderCommentRangeStart(t){var s;if(!this.options.renderComments)return null;const e=new Range;null==(s=this.commentHighlight)||s.add(e);const r=this.htmlDocument.createComment(`start of comment #${t.id}`);return this.later(()=>e.setStart(r,0)),this.commentMap[t.id]=e,r}renderCommentRangeEnd(t){if(!this.options.renderComments)return null;const e=this.commentMap[t.id],r=this.htmlDocument.createComment(`end of comment #${t.id}`);return this.later(()=>null==e?void 0:e.setEnd(r,0)),r}renderCommentReference(t){var F;if(!this.options.renderComments)return null;var e=null==(F=this.document.commentsPart)?void 0:F.commentMap[t.id];if(!e)return null;const r=new DocumentFragment,s=this.createElement("span",{className:`${this.className}-comment-ref`},["\u{1f4ac}"]),l=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(e,l),r.appendChild(this.htmlDocument.createComment(`comment #${e.id} by ${e.author} on ${e.date}`)),r.appendChild(s),r.appendChild(l),r}renderAltChunk(t){if(!this.options.renderAltChunks)return null;var e=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(t.id,this.currentPart).then(r=>{e.srcdoc=r})),e}renderCommentContent(t,e){e.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[t.author])),e.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(t.date).toLocaleString()])),this.renderElements(t.children,e)}renderDrawing(t){var e=this.renderContainer(t,"div");return e.style.display="inline-block",e.style.position="relative",e.style.textIndent="0px",this.renderStyleValues(t.cssStyle,e),e}renderImage(t){let e=this.createElement("img");return this.renderStyleValues(t.cssStyle,e),this.document&&this.tasks.push(this.document.loadDocumentImage(t.src,this.currentPart).then(r=>{e.src=r})),e}renderText(t){return this.htmlDocument.createTextNode(t.text)}renderDeletedText(t){return this.options.renderEndnotes?this.htmlDocument.createTextNode(t.text):null}renderBreak(t){return"textWrapping"==t.break?this.createElement("br"):null}renderInserted(t){return this.options.renderChanges?this.renderContainer(t,"ins"):this.renderElements(t.children)}renderDeleted(t){return this.options.renderChanges?this.renderContainer(t,"del"):null}renderSymbol(t){var e=this.createElement("span");return e.style.fontFamily=t.font,e.innerHTML=`&#x${t.char};`,e}renderFootnoteReference(t){var e=this.createElement("sup");return this.currentFootnoteIds.push(t.id),e.textContent=`${this.currentFootnoteIds.length}`,e}renderEndnoteReference(t){var e=this.createElement("sup");return this.currentEndnoteIds.push(t.id),e.textContent=`${this.currentEndnoteIds.length}`,e}renderTab(t){var s,e=this.createElement("span");if(e.innerHTML="&emsp;",this.options.experimental){e.className=this.tabStopClass();var r=null==(s=function(i,t){for(var e=i.parent;null!=e&&e.type!=t;)e=e.parent;return e}(t,x.Paragraph))?void 0:s.tabs;this.currentTabs.push({stops:r,span:e})}return e}renderBookmarkStart(t){return this.createElement("span",{id:t.name})}renderRun(t){if(t.fieldRun)return null;const e=this.createElement("span");if(t.id&&(e.id=t.id),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.verticalAlign){const r=this.createElement(t.verticalAlign);this.renderElements(t.children,r),e.appendChild(r)}else this.renderElements(t.children,e);return e}renderTable(t){let e=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},t.columns&&e.appendChild(this.renderTableColumns(t.columns)),this.renderClass(t,e),this.renderElements(t.children,e),this.renderStyleValues(t.cssStyle,e),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),e}renderTableColumns(t){let e=this.createElement("colgroup");for(let r of t){let s=this.createElement("col");r.width&&(s.style.width=r.width),e.appendChild(s)}return e}renderTableRow(t){let e=this.renderContainer(t,"tr");return this.currentCellPosition.col=0,this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),this.currentCellPosition.row++,e}renderTableCell(t){let e=this.renderContainer(t,"td");const r=this.currentCellPosition.col;return t.verticalMerge?"restart"==t.verticalMerge?(this.currentVerticalMerge[r]=e,e.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,e.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.span&&(e.colSpan=t.span),this.currentCellPosition.col+=e.colSpan,e}renderVmlPicture(t){return this.renderContainer(t,"div")}renderVmlElement(t){var s,l,e=this.createSvgElement("svg");e.setAttribute("style",t.cssStyleText);const r=this.renderVmlChildElement(t);return(null==(s=t.imageHref)?void 0:s.id)&&this.tasks.push(null==(l=this.document)?void 0:l.loadDocumentImage(t.imageHref.id,this.currentPart).then(F=>r.setAttribute("href",F))),e.appendChild(r),requestAnimationFrame(()=>{const F=e.firstElementChild.getBBox();e.setAttribute("width",`${Math.ceil(F.x+F.width)}`),e.setAttribute("height",`${Math.ceil(F.y+F.height)}`)}),e}renderVmlChildElement(t){const e=this.createSvgElement(t.tagName);Object.entries(t.attrs).forEach(([r,s])=>e.setAttribute(r,s));for(let r of t.children)r.type==x.VmlElement?e.appendChild(this.renderVmlChildElement(r)):e.appendChild(..._(this.renderElement(r)));return e}renderMmlRadical(t){var s;const e=t.children.find(l=>l.type==x.MmlBase);if(null==(s=t.props)?void 0:s.hideDegree)return this.createElementNS(ht_mathML,"msqrt",null,this.renderElements([e]));const r=t.children.find(l=>l.type==x.MmlDegree);return this.createElementNS(ht_mathML,"mroot",null,this.renderElements([e,r]))}renderMmlDelimiter(t){var r,s;const e=[];return e.push(this.createElementNS(ht_mathML,"mo",null,[null!=(r=t.props.beginChar)?r:"("])),e.push(...this.renderElements(t.children)),e.push(this.createElementNS(ht_mathML,"mo",null,[null!=(s=t.props.endChar)?s:")"])),this.createElementNS(ht_mathML,"mrow",null,e)}renderMmlNary(t){var ut,lt;const e=[],r=u(t.children,St=>St.type),s=r[x.MmlSuperArgument],l=r[x.MmlSubArgument],F=s?this.createElementNS(ht_mathML,"mo",null,_(this.renderElement(s))):null,Y=l?this.createElementNS(ht_mathML,"mo",null,_(this.renderElement(l))):null,nt=this.createElementNS(ht_mathML,"mo",null,[null!=(lt=null==(ut=t.props)?void 0:ut.char)?lt:"\u222b"]);return e.push(F||Y?this.createElementNS(ht_mathML,"munderover",null,[nt,Y,F]):F?this.createElementNS(ht_mathML,"mover",null,[nt,F]):Y?this.createElementNS(ht_mathML,"munder",null,[nt,Y]):nt),e.push(...this.renderElements(r[x.MmlBase].children)),this.createElementNS(ht_mathML,"mrow",null,e)}renderMmlPreSubSuper(t){const e=[],r=u(t.children,ut=>ut.type),s=r[x.MmlSuperArgument],l=r[x.MmlSubArgument],F=s?this.createElementNS(ht_mathML,"mo",null,_(this.renderElement(s))):null,Y=l?this.createElementNS(ht_mathML,"mo",null,_(this.renderElement(l))):null,nt=this.createElementNS(ht_mathML,"mo",null);return e.push(this.createElementNS(ht_mathML,"msubsup",null,[nt,Y,F])),e.push(...this.renderElements(r[x.MmlBase].children)),this.createElementNS(ht_mathML,"mrow",null,e)}renderMmlGroupChar(t){const r=this.renderContainerNS(t,ht_mathML,"bot"===t.props.verticalJustification?"mover":"munder");return t.props.char&&r.appendChild(this.createElementNS(ht_mathML,"mo",null,[t.props.char])),r}renderMmlBar(t){const e=this.renderContainerNS(t,ht_mathML,"mrow");switch(t.props.position){case"top":e.style.textDecoration="overline";break;case"bottom":e.style.textDecoration="underline"}return e}renderMmlRun(t){const e=this.createElementNS(ht_mathML,"ms",null,this.renderElements(t.children));return this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),e}renderMllList(t){const e=this.createElementNS(ht_mathML,"mtable");this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e);for(let r of this.renderElements(t.children))e.appendChild(this.createElementNS(ht_mathML,"mtr",null,[this.createElementNS(ht_mathML,"mtd",null,[r])]));return e}renderStyleValues(t,e){for(let r in t)r.startsWith("$")?e.setAttribute(r.slice(1),t[r]):e.style[r]=t[r]}renderClass(t,e){t.className&&(e.className=t.className),t.styleName&&e.classList.add(this.processStyleName(t.styleName))}findStyle(t){var e;return t&&(null==(e=this.styleMap)?void 0:e[t])}numberingClass(t,e){return`${this.className}-num-${t}-${e}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(t,e,r=null){let s=`${t} {\r\n`;for(const l in e)l.startsWith("$")||(s+=`  ${l}: ${e[l]};\r\n`);return r&&(s+=r),s+"}\r\n"}numberingCounter(t,e){return`${this.className}-num-${t}-${e}`}levelTextToContent(t,e,r,s){var Y;return`"${t.replace(/%\d*/g,nt=>{let ut=parseInt(nt.substring(1),10)-1;return`"counter(${this.numberingCounter(r,ut)}, ${s})"`})}${null!=(Y={tab:"\\9",space:"\\a0"}[e])?Y:""}"`}numFormatToCssValue(t){var r;return null!=(r={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[t])?r:t}refreshTabStops(){!this.options.experimental||setTimeout(()=>{const t=function(i=document.body){const t=document.createElement("div");t.style.width="100pt",i.appendChild(t);const e=100/t.offsetWidth;return i.removeChild(t),e}();for(let e of this.currentTabs)We(e.span,e.stops,this.defaultTabSize,t)},500)}createElementNS(t,e,r,s){var l=t?this.htmlDocument.createElementNS(t,e):this.htmlDocument.createElement(e);return Object.assign(l,r),s&&te(l,s),l}createElement(t,e,r){return this.createElementNS(void 0,t,e,r)}createSvgElement(t,e,r){return this.createElementNS("http://www.w3.org/2000/svg",t,e,r)}createStyleElement(t){return this.createElement("style",{innerHTML:t})}createComment(t){return this.htmlDocument.createComment(t)}later(t){this.postRenderTasks.push(t)}}function he(i){i.innerHTML=""}function te(i,t){t.forEach(e=>i.appendChild(function(i){return"string"==typeof i||i instanceof String}(e)?document.createTextNode(e):e))}const de={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function Ve(i,t){const e=zt(zt({},de),t);return Qt.load(i,new Le(e),e)}function Ge(i,t,e,r){return ee.apply(this,arguments)}function ee(){return(ee=(0,f.Z)(function*(i,t,e,r){const s=zt(zt({},de),r);return yield new $e(window.document).render(i,t,e,s)})).apply(this,arguments)}function re(){return(re=(0,f.Z)(function*(i,t,e,r){const s=yield Ve(i,r);return yield Ge(s,t,e,r),s})).apply(this,arguments)}var rt=U(7716),fe=U(4453),qe=U(9374),Ye=U(4514);const Je=["videoElement"],Ke=["canvasElement"],Qe=["previewContainer"];function tr(i,t){if(1&i&&(rt.TgZ(0,"div",16),rt._UZ(1,"img",17),rt.qZA()),2&i){const e=rt.oxw();rt.xp6(1),rt.Q6J("src",e.photoUrl,rt.LSH)}}function er(i,t){if(1&i&&(rt.TgZ(0,"div",18),rt.TgZ(1,"pre"),rt._uU(2),rt.qZA(),rt.qZA()),2&i){const e=rt.oxw();rt.xp6(2),rt.Oqu(e.wordContent)}}let rr=(()=>{class i{constructor(){this.photoUrl=null,this.wordContent=null,this.stream=null}previewWord(e){var r=this;return(0,f.Z)(function*(){const s=e.target.files[0];if(s)try{r.previewContainer.nativeElement.innerHTML="",r.previewContainer.nativeElement.className="docx-preview-container",setTimeout(()=>{r.previewContainer.nativeElement.querySelectorAll(".docx-wrapper, .docx").forEach(F=>{F.style.padding="20px",F.style.width="100%"})},100),yield function(i,t,e,r){return re.apply(this,arguments)}(s,r.previewContainer.nativeElement,void 0,{className:"docx",inWrapper:!1,ignoreWidth:!0,ignoreHeight:!0,breakPages:!0,experimental:!0}),r.wordContent=null}catch(l){console.error("Word\u9884\u89c8\u5931\u8d25:",l)}})()}startCamera(){var e=this;return(0,f.Z)(function*(){try{e.stream=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}),e.videoElement.nativeElement.srcObject=e.stream}catch(r){console.error("\u6444\u50cf\u5934\u8bbf\u95ee\u5931\u8d25:",r),alert("\u65e0\u6cd5\u8bbf\u95ee\u6444\u50cf\u5934\uff0c\u8bf7\u68c0\u67e5\u6743\u9650\u8bbe\u7f6e")}})()}stopCamera(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.videoElement.nativeElement.srcObject=null,this.stream=null)}capture(){if(!this.stream)return;const e=this.videoElement.nativeElement,r=this.canvasElement.nativeElement;r.width=e.videoWidth,r.height=e.videoHeight,r.getContext("2d").drawImage(e,0,0,r.width,r.height),this.photoUrl=r.toDataURL("image/png")}print(){window.print()}ngOnInit(){}ngOnDestroy(){this.stopCamera()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=rt.Xpm({type:i,selectors:[["xj-camera"]],viewQuery:function(e,r){if(1&e&&(rt.Gf(Je,5),rt.Gf(Ke,5),rt.Gf(Qe,5)),2&e){let s;rt.iGM(s=rt.CRH())&&(r.videoElement=s.first),rt.iGM(s=rt.CRH())&&(r.canvasElement=s.first),rt.iGM(s=rt.CRH())&&(r.previewContainer=s.first)}},decls:23,vars:2,consts:[[1,"main"],[1,"camera-container"],["nz-button","","nzType","primary",3,"click"],["autoplay","","playsinline",""],["videoElement",""],[2,"display","none"],["canvasElement",""],[1,"controls"],["nz-button","","nzType","default",3,"click"],["class","preview",4,"ngIf"],[1,"word-preview"],[1,"font-bold","text-lg"],["type","file","accept",".doc,.docx",3,"change"],[1,"docx-preview-container","mobile-optimized"],["previewContainer",""],["class","word-content",4,"ngIf"],[1,"preview"],["alt","\u62cd\u6444\u7684\u7167\u7247",3,"src"],[1,"word-content"]],template:function(e,r){1&e&&(rt.TgZ(0,"div",0),rt.TgZ(1,"div",1),rt.TgZ(2,"button",2),rt.NdJ("click",function(){return r.print()}),rt._uU(3,"\u6253\u5f00\u6d4f\u89c8\u5668\u7684\u6253\u5370\u6a21\u5f0f"),rt.qZA(),rt._UZ(4,"video",3,4),rt._UZ(6,"canvas",5,6),rt.TgZ(8,"div",7),rt.TgZ(9,"button",2),rt.NdJ("click",function(){return r.startCamera()}),rt._uU(10,"\u6253\u5f00\u6444\u50cf\u5934"),rt.qZA(),rt.TgZ(11,"button",8),rt.NdJ("click",function(){return r.stopCamera()}),rt._uU(12,"\u5173\u95ed\u6444\u50cf\u5934"),rt.qZA(),rt.TgZ(13,"button",2),rt.NdJ("click",function(){return r.capture()}),rt._uU(14,"\u62cd\u7167"),rt.qZA(),rt.qZA(),rt.YNc(15,tr,2,1,"div",9),rt.qZA(),rt.TgZ(16,"div",10),rt.TgZ(17,"h2",11),rt._uU(18,"word\u6587\u4ef6\u9884\u89c8"),rt.qZA(),rt.TgZ(19,"input",12),rt.NdJ("change",function(l){return r.previewWord(l)}),rt.qZA(),rt._UZ(20,"div",13,14),rt.YNc(22,er,3,1,"div",15),rt.qZA(),rt.qZA()),2&e&&(rt.xp6(15),rt.Q6J("ngIf",r.photoUrl),rt.xp6(7),rt.Q6J("ngIf",r.wordContent))},directives:[fe.ix,qe.dQ,Ye.w,N.O5],styles:["@media (min-width: 769px){.main[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr 1fr}.camera-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:20px;gap:20px;margin-top:20px}.camera-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;max-width:640px;background:#000;border-radius:8px}.camera-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px}.camera-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:20px}.camera-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:300px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.word-preview[_ngcontent-%COMP%]{margin-top:20px}.word-preview[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-bottom:15px}.word-preview[_ngcontent-%COMP%]   .word-content[_ngcontent-%COMP%]{border:1px solid #ddd;padding:15px;max-height:400px;background:white}.word-preview[_ngcontent-%COMP%]   .word-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-wrap;font-family:inherit;margin:0}.docx-preview-container[_ngcontent-%COMP%]{width:100%;height:600px;border:1px solid #ddd;overflow:auto;margin-top:15px;padding:15px}.docx-preview-container[_ngcontent-%COMP%]   .docx-wrapper[_ngcontent-%COMP%]{background:white;padding:20px}}@media (max-width: 768px){.main[_ngcontent-%COMP%]{width:100%;height:100%;overflow:auto;display:flex;flex-direction:column;align-items:center}.main[_ngcontent-%COMP%]   .camera-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:20px;gap:20px;margin-top:20px}.main[_ngcontent-%COMP%]   .camera-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;max-width:640px;background:#000;border-radius:8px}.main[_ngcontent-%COMP%]   .camera-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px}.main[_ngcontent-%COMP%]   .camera-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:20px}.main[_ngcontent-%COMP%]   .camera-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:300px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]{margin-top:20px;width:calc(100% - 40px)}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-bottom:15px}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]   .docx-preview-container[_ngcontent-%COMP%]{width:80vw;height:80vh;overflow:auto;border:1px solid #ddd;background:white}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]   .docx-preview-container[_ngcontent-%COMP%]   .docx[_ngcontent-%COMP%]{padding:20px!important}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]   .word-content[_ngcontent-%COMP%]{border:1px solid #ddd;padding:15px;background:white}.main[_ngcontent-%COMP%]   .word-preview[_ngcontent-%COMP%]   .word-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-wrap;font-family:inherit;margin:0}}"]}),i})();var nr=U(4655);const ar=[{path:"",component:rr}];let sr=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=rt.oAB({type:i}),i.\u0275inj=rt.cJS({imports:[[N.ez,nr.Bz.forChild(ar),fe.sL]]}),i})()},8239:(At,k,U)=>{"use strict";function N(p,o,m,S,P,y,C){try{var u=p[y](C),v=u.value}catch(c){return void m(c)}u.done?o(v):Promise.resolve(v).then(S,P)}function f(p){return function(){var o=this,m=arguments;return new Promise(function(S,P){var y=p.apply(o,m);function C(v){N(y,S,P,C,u,"next",v)}function u(v){N(y,S,P,C,u,"throw",v)}C(void 0)})}}U.d(k,{Z:()=>f})}}]);